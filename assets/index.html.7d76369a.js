import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c,d as n,e as s,b as t,f as e,r as i}from"./app.7c76e587.js";const l={},u={href:"https://juejin.cn/post/7146976516692410376",target:"_blank",rel:"noopener noreferrer"},r=e(`<h2 id="\u524D\u7AEF\u5DE5\u7A0B\u5316\u5BFC\u56FE" tabindex="-1"><a class="header-anchor" href="#\u524D\u7AEF\u5DE5\u7A0B\u5316\u5BFC\u56FE" aria-hidden="true">#</a> \u524D\u7AEF\u5DE5\u7A0B\u5316\u5BFC\u56FE</h2><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca0fcaed7ef445ae868656e9581dd348~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="\u524D\u7AEF\u5DE5\u7A0B\u5316.png"></p><h2 id="\u6784\u5EFA\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#\u6784\u5EFA\u5DE5\u5177" aria-hidden="true">#</a> \u6784\u5EFA\u5DE5\u5177</h2><h3 id="webpack" tabindex="-1"><a class="header-anchor" href="#webpack" aria-hidden="true">#</a> Webpack</h3><p><code>Webpack</code>\u662F\u524D\u7AEF\u6700\u5E38\u7528\u7684\u6784\u5EFA\u5DE5\u5177\uFF0C\u91CD\u8981\u7A0B\u5EA6\u65E0\u9700\u591A\u8A00</p><p>\u4E4B\u524D\u770B\u8FC7\u5F88\u591A\u5173\u4E8E Webpack \u7684\u6587\u7AE0\uFF0C\u603B\u662F\u611F\u89C9\u4E91\u91CC\u96FE\u91CC\uFF0C\u73B0\u5728\u6362\u4E00\u79CD\u65B9\u5F0F\uFF0C\u6211\u4EEC\u4E00\u8D77\u6765\u89E3\u5BC6\u5B83\uFF0C\u5C1D\u8BD5\u6253\u5F00\u8FD9\u4E2A<code>\u76F2\u76D2</code></p><h4 id="\u624B\u5199\u4E00\u4E2A-mini-\u7248\u7684-webpack" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199\u4E00\u4E2A-mini-\u7248\u7684-webpack" aria-hidden="true">#</a> \u624B\u5199\u4E00\u4E2A mini \u7248\u7684 Webpack</h4><p>\u522B\u62C5\u5FC3</p><p>\u6211\u4EEC\u4E0D\u9700\u8981\u53BB\u638C\u63E1\u5177\u4F53\u7684\u5B9E\u73B0\u7EC6\u8282\uFF0C\u800C\u662F\u901A\u8FC7\u8FD9\u4E2A\u6848\u4F8B\uFF0C\u4E86\u89E3 webpack \u7684\u6574\u4F53\u6253\u5305\u6D41\u7A0B\uFF0C\u660E\u767D\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\u505A\u4E86\u54EA\u4E9B\u4E8B\u60C5\uFF0C\u6700\u7EC8\u8F93\u51FA\u4E86\u4EC0\u4E48\u7ED3\u679C\u5373\u53EF</p><h5 id="\u521B\u5EFAminipack-js" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAminipack-js" aria-hidden="true">#</a> <strong>\u521B\u5EFA<code>minipack.js</code></strong></h5><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;fs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">path</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// babylon\u89E3\u6790js\u8BED\u6CD5\uFF0C\u751F\u4EA7AST \u8BED\u6CD5\u6811</span>
<span class="token comment">// ast\u5C06js\u4EE3\u7801\u8F6C\u5316\u4E3A\u4E00\u79CDJSON\u6570\u636E\u7ED3\u6784</span>
<span class="token keyword">const</span> <span class="token constant">babylon</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;babylon&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// babel-traverse\u662F\u4E00\u4E2A\u5BF9ast\u8FDB\u884C\u904D\u5386\u7684\u5DE5\u5177, \u5BF9ast\u8FDB\u884C\u66FF\u6362</span>
<span class="token keyword">const</span> <span class="token constant">traverse</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;babel-traverse&#39;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token comment">// \u5C06es6 es7 \u7B49\u9AD8\u7EA7\u7684\u8BED\u6CD5\u8F6C\u5316\u4E3Aes5\u7684\u8BED\u6CD5</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> transformFromAst <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;babel-core&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u6BCF\u4E00\u4E2Ajs\u6587\u4EF6\uFF0C\u5BF9\u5E94\u4E00\u4E2Aid</span>
let <span class="token constant">ID</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// filename\u53C2\u6570\u4E3A\u6587\u4EF6\u8DEF\u5F84, \u8BFB\u53D6\u5185\u5BB9\u5E76\u63D0\u53D6\u5B83\u7684\u4F9D\u8D56\u5173\u7CFB</span>
<span class="token keyword">function</span> <span class="token function-definition function">createAsset</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">content</span> <span class="token operator">=</span> fs<span class="token operator">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u83B7\u53D6\u8BE5\u6587\u4EF6\u5BF9\u5E94\u7684ast \u62BD\u8C61\u8BED\u6CD5\u6811</span>
  <span class="token keyword">const</span> <span class="token constant">ast</span> <span class="token operator">=</span> babylon<span class="token operator">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    sourceType<span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;module&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// dependencies\u4FDD\u5B58\u6240\u4F9D\u8D56\u7684\u6A21\u5757\u7684\u76F8\u5BF9\u8DEF\u5F84</span>
  <span class="token keyword">const</span> <span class="token constant">dependencies</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// \u901A\u8FC7\u67E5\u627Eimport\u8282\u70B9\uFF0C\u627E\u5230\u8BE5\u6587\u4EF6\u7684\u4F9D\u8D56\u5173\u7CFB</span>
  <span class="token comment">// \u56E0\u4E3A\u9879\u76EE\u4E2D\u6211\u4EEC\u90FD\u662F\u901A\u8FC7 import \u5F15\u5165\u5176\u4ED6\u6587\u4EF6\u7684\uFF0C\u627E\u5230\u4E86import\u8282\u70B9\uFF0C\u5C31\u627E\u5230\u8FD9\u4E2A\u6587\u4EF6\u5F15\u7528\u4E86\u54EA\u4E9B\u6587\u4EF6</span>
  <span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    ImportDeclaration<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> node <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u67E5\u627Eimport\u8282\u70B9</span>
      dependencies<span class="token operator">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token operator">.</span>source<span class="token operator">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u901A\u8FC7\u9012\u589E\u8BA1\u6570\u5668\uFF0C\u4E3A\u6B64\u6A21\u5757\u5206\u914D\u552F\u4E00\u6807\u8BC6\u7B26, \u7528\u4E8E\u7F13\u5B58\u5DF2\u89E3\u6790\u8FC7\u7684\u6587\u4EF6</span>
  <span class="token keyword">const</span> <span class="token constant">id</span> <span class="token operator">=</span> <span class="token constant">ID</span><span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token comment">// \u8BE5\`presets\`\u9009\u9879\u662F\u4E00\u7EC4\u89C4\u5219\uFF0C\u544A\u8BC9\`babel\`\u5982\u4F55\u4F20\u8F93\u6211\u4EEC\u7684\u4EE3\u7801.</span>
  <span class="token comment">// \u7528\`babel-preset-env\`\u5C06\u4EE3\u7801\u8F6C\u6362\u4E3A\u6D4F\u89C8\u5668\u53EF\u4EE5\u8FD0\u884C\u7684\u4E1C\u897F.</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;env&#39;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u8FD4\u56DE\u6B64\u6A21\u5757\u7684\u76F8\u5173\u4FE1\u606F</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span> <span class="token comment">// \u6587\u4EF6id\uFF08\u552F\u4E00\uFF09</span>
    filename<span class="token punctuation">,</span> <span class="token comment">// \u6587\u4EF6\u8DEF\u5F84</span>
    dependencies<span class="token punctuation">,</span> <span class="token comment">// \u6587\u4EF6\u7684\u4F9D\u8D56\u5173\u7CFB</span>
    code <span class="token comment">// \u6587\u4EF6\u7684\u4EE3\u7801</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u6211\u4EEC\u5C06\u63D0\u53D6\u5B83\u7684\u6BCF\u4E00\u4E2A\u4F9D\u8D56\u6587\u4EF6\u7684\u4F9D\u8D56\u5173\u7CFB\uFF0C\u5FAA\u73AF\u4E0B\u53BB\uFF1A\u627E\u5230\u5BF9\u5E94\u8FD9\u4E2A\u9879\u76EE\u7684\`\u4F9D\u8D56\u56FE\`</span>
<span class="token keyword">function</span> <span class="token function-definition function">createGraph</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5F97\u5230\u5165\u53E3\u6587\u4EF6\u7684\u4F9D\u8D56\u5173\u7CFB</span>
  <span class="token keyword">const</span> <span class="token constant">mainAsset</span> <span class="token operator">=</span> <span class="token function">createAsset</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token constant">queue</span> <span class="token operator">=</span> <span class="token punctuation">[</span>mainAsset<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> asset of queue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    asset<span class="token operator">.</span>mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// \u83B7\u53D6\u8FD9\u4E2A\u6A21\u5757\u6240\u5728\u7684\u76EE\u5F55</span>
    <span class="token keyword">const</span> <span class="token constant">dirname</span> <span class="token operator">=</span> path<span class="token operator">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>asset<span class="token operator">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    asset<span class="token operator">.</span>dependencies<span class="token operator">.</span><span class="token keyword">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>relativePath<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u901A\u8FC7\u5C06\u76F8\u5BF9\u8DEF\u5F84\u4E0E\u7236\u8D44\u6E90\u76EE\u5F55\u7684\u8DEF\u5F84\u8FDE\u63A5,\u5C06\u76F8\u5BF9\u8DEF\u5F84\u8F6C\u53D8\u4E3A\u7EDD\u5BF9\u8DEF\u5F84</span>
      <span class="token comment">// \u6BCF\u4E2A\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84\u662F\u56FA\u5B9A\u3001\u552F\u4E00\u7684</span>
      <span class="token keyword">const</span> <span class="token constant">absolutePath</span> <span class="token operator">=</span> path<span class="token operator">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u9012\u5F52\u89E3\u6790\u5176\u4E2D\u6240\u5F15\u5165\u7684\u5176\u4ED6\u8D44\u6E90</span>
      <span class="token keyword">const</span> <span class="token constant">child</span> <span class="token operator">=</span> <span class="token function">createAsset</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      asset<span class="token operator">.</span>mapping<span class="token punctuation">[</span>relativePath<span class="token punctuation">]</span> <span class="token operator">=</span> child<span class="token operator">.</span>id<span class="token punctuation">;</span>
      <span class="token comment">// \u5C06\`child\`\u63A8\u5165\u961F\u5217, \u901A\u8FC7\u9012\u5F52\u5B9E\u73B0\u4E86\u8FD9\u6837\u5B83\u7684\u4F9D\u8D56\u5173\u7CFB\u89E3\u6790</span>
      queue<span class="token operator">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// queue\u8FD9\u5C31\u662F\u6700\u7EC8\u7684\u4F9D\u8D56\u5173\u7CFB\u56FE\u8C31</span>
  <span class="token keyword">return</span> queue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u81EA\u5B9A\u4E49\u5B9E\u73B0\u4E86require \u65B9\u6CD5\uFF0C\u627E\u5230\u5BFC\u51FA\u53D8\u91CF\u7684\u5F15\u7528\u903B\u8F91</span>
<span class="token keyword">function</span> <span class="token function-definition function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  let modules <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span>
  graph<span class="token operator">.</span><span class="token keyword">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    modules <span class="token operator">+=</span> <span class="token string backtick-quoted-string">\`\${mod.id}: [
      function (require, module, exports) { \${mod.code} },
      \${JSON.stringify(mod.mapping)},
    ],\`</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token constant">result</span> <span class="token operator">=</span> <span class="token string backtick-quoted-string">\`
    (function(modules) {
      function require(id) {
        const [fn, mapping] = modules[id];
        function localRequire(name) {
          return require(mapping[name]);
        }
        const module = { exports : {} };
        fn(localRequire, module, module.exports);
        return module.exports;
      }
      require(0);
    })({\${modules}})
  \`</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u2764\uFE0F \u9879\u76EE\u7684\u5165\u53E3\u6587\u4EF6</span>
<span class="token keyword">const</span> <span class="token constant">graph</span> <span class="token operator">=</span> <span class="token function">createGraph</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;./example/entry.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">result</span> <span class="token operator">=</span> <span class="token function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u2B05\uFE0F \u521B\u5EFAdist\u76EE\u5F55\uFF0C\u5C06\u6253\u5305\u7684\u5185\u5BB9\u5199\u5165main.js\u4E2D</span>
fs<span class="token operator">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;dist&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span>
    fs<span class="token operator">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;dist/main.js&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> <span class="token punctuation">(</span>err1<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err1<span class="token punctuation">)</span> console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;\u6253\u5305\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6CE8</strong>\uFF1A<code>mini\u7248\u7684Webpack</code>\u672A\u6D89\u53CA loader \u548C plugin \u7B49\u590D\u6742\u529F\u80FD\uFF0C\u53EA\u662F\u4E00\u4E2A\u975E\u5E38\u7B80\u5316\u7684\u4F8B\u5B50</p><h5 id="mini-\u7248\u7684-webpack-\u6253\u5305\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#mini-\u7248\u7684-webpack-\u6253\u5305\u6D41\u7A0B" aria-hidden="true">#</a> mini \u7248\u7684 webpack \u6253\u5305\u6D41\u7A0B</h5><p>1\uFF09\u4ECE\u5165\u53E3\u6587\u4EF6\u5F00\u59CB\u89E3\u6790 2\uFF09\u67E5\u627E\u5165\u53E3\u6587\u4EF6\u5F15\u5165\u4E86\u54EA\u4E9B js \u6587\u4EF6\uFF0C\u627E\u5230\u4F9D\u8D56\u5173\u7CFB 3\uFF09\u9012\u5F52\u904D\u5386\u5F15\u5165\u7684\u5176\u4ED6 js\uFF0C\u751F\u6210\u6700\u7EC8\u7684\u4F9D\u8D56\u5173\u7CFB\u56FE\u8C31 4\uFF09\u540C\u65F6\u5C06 ES6 \u8BED\u6CD5\u8F6C\u5316\u6210 ES5 5\uFF09\u6700\u7EC8\u751F\u6210\u4E00\u4E2A\u53EF\u4EE5\u5728\u6D4F\u89C8\u5668\u52A0\u8F7D\u6267\u884C\u7684 js \u6587\u4EF6</p><h5 id="\u521B\u5EFA\u6D4B\u8BD5\u76EE\u5F55-example" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u6D4B\u8BD5\u76EE\u5F55-example" aria-hidden="true">#</a> \u521B\u5EFA\u6D4B\u8BD5\u76EE\u5F55 example</h5><p>\u5728\u76EE\u5F55\u4E0B\u521B\u5EFA\u4EE5\u4E0B 4 \u4E2A\u6587\u4EF6</p><p><strong>1\uFF09\u521B\u5EFA\u5165\u53E3\u6587\u4EF6<code>entry.js</code></strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>import message from &#39;./message.js&#39;;
// \u5C06message\u7684\u5185\u5BB9\u663E\u793A\u5230\u9875\u9762\u4E2D
<span class="token key attr-name">let p</span> <span class="token punctuation">=</span> <span class="token value attr-value">document.createElement(&#39;p&#39;);</span>
<span class="token key attr-name">p.innerHTML</span> <span class="token punctuation">=</span> <span class="token value attr-value">message;</span>
document.body.appendChild(p);

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2\uFF09\u521B\u5EFA<code>message.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./name.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3\uFF09\u521B\u5EFA<code>name.js</code></strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">export const name</span> <span class="token punctuation">=</span> <span class="token value attr-value">&#39;Webpack&#39;;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>4\uFF09\u521B\u5EFA<code>index.html</code></strong></p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Webpack App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u5F15\u5165\u6253\u5305\u540E\u7684main.js --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./dist/main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>5\uFF09 \u6267\u884C\u6253\u5305</strong></p><p>\u8FD0\u884C<code>node minipack.js</code>\uFF0Cdist \u76EE\u5F55\u4E0B\u751F\u6210 main.js</p><p><strong>6\uFF09 \u6D4F\u89C8\u5668\u6253\u5F00 index.html</strong></p><p>\u9875\u9762\u4E0A\u663E\u793A<code>hello Webpack!</code></p>`,28),d={href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fxy-sea%2Fblog%2Ftree%2Fdev%2Fmini-webpack",target:"_blank",rel:"noopener noreferrer"},k=e(`<h4 id="\u5206\u6790\u6253\u5305\u751F\u6210\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5206\u6790\u6253\u5305\u751F\u6210\u7684\u6587\u4EF6" aria-hidden="true">#</a> \u5206\u6790\u6253\u5305\u751F\u6210\u7684\u6587\u4EF6</h4><p><strong>\u5206\u6790<code>dist/main.js</code></strong></p><h5 id="\u6587\u4EF6\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u6587\u4EF6\u5185\u5BB9" aria-hidden="true">#</a> \u6587\u4EF6\u5185\u5BB9</h5><p>1\uFF09\u6587\u4EF6\u91CC\u662F\u4E00\u4E2A\u7ACB\u5373\u6267\u884C\u51FD\u6570</p><p>2\uFF09\u8BE5\u51FD\u6570\u63A5\u6536\u7684\u53C2\u6570\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u6709 3 \u4E2A\u5C5E\u6027 <code>0</code> \u4EE3\u8868<code>entry.js</code>; <code>1</code> \u4EE3\u8868<code>message.js</code>; <code>2</code> \u4EE3\u8868<code>name.js</code></p><p><strong>dist/main.js \u4EE3\u7801</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u6587\u4EF6\u91CC\u662F\u4E00\u4E2A\u7ACB\u5373\u6267\u884C\u51FD\u6570</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>fn<span class="token punctuation">,</span> mapping<span class="token punctuation">]</span> <span class="token operator">=</span> modules<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">localRequire</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u56DB\u6B65 \u8DF3\u8F6C\u5230\u8FD9\u91CC \u6B64\u65F6mapping[name] = 1\uFF0C\u7EE7\u7EED\u6267\u884Crequire(1)</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u516D\u6B65 \u53C8\u8DF3\u8F6C\u5230\u8FD9\u91CC \u6B64\u65F6mapping[name] = 2\uFF0C\u7EE7\u7EED\u6267\u884Crequire(2)</span>
      <span class="token keyword">return</span> <span class="token function">require</span><span class="token punctuation">(</span>mapping<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u521B\u5EFAmodule\u5BF9\u8C61</span>
    <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E8C\u6B65 \u6267\u884Cfn</span>
    <span class="token function">fn</span><span class="token punctuation">(</span>localRequire<span class="token punctuation">,</span> module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E00\u6B65 \u6267\u884Crequire(0)</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// \u7ACB\u5373\u6267\u884C\u51FD\u6570\u7684\u53C2\u6570\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u67093\u4E2A\u5C5E\u6027</span>
  <span class="token comment">// 0 \u4EE3\u8868entry.js;</span>
  <span class="token comment">// 1 \u4EE3\u8868message.js</span>
  <span class="token comment">// 2 \u4EE3\u8868name.js</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E09\u6B65 \u8DF3\u8F6C\u5230\u8FD9\u91CC \u7EE7\u7EED\u6267\u884Crequire(&#39;./message.js&#39;)</span>
      <span class="token keyword">var</span> _message <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./message.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E5D\u6B65 \u8DF3\u5230\u8FD9\u91CC \u6B64\u65F6_message\u4E3A {default: &#39;hello Webpack!&#39;}</span>
      <span class="token keyword">var</span> _message2 <span class="token operator">=</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span>_message<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">_interopRequireDefault</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>__esModule <span class="token operator">?</span> obj <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> obj <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">var</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u6700\u540E\u4E00\u6B65 \u5C06_message2.default: &#39;hello Webpack!&#39;\u5199\u5230p\u6807\u7B7E\u4E2D</span>
      p<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _message2<span class="token punctuation">.</span>default<span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;./message.js&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">&quot;__esModule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E94\u6B65 \u8DF3\u8F6C\u5230\u8FD9\u91CC \u7EE7\u7EED\u6267\u884Crequire(&#39;./name.js&#39;)</span>
      <span class="token keyword">var</span> _name <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./name.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u516B\u6B65 \u8DF3\u5230\u8FD9\u91CC \u6B64\u65F6_name\u4E3A{name: &#39;Webpack&#39;}, \u5728exports\u5BF9\u8C61\u4E0A\u8BBE\u7F6Edefault\u5C5E\u6027\uFF0C\u503C\u4E3A&#39;hello Webpack!&#39;</span>
      exports<span class="token punctuation">.</span>default <span class="token operator">=</span> <span class="token string">&quot;hello &quot;</span> <span class="token operator">+</span> _name<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;./name.js&quot;</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">&quot;__esModule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u2B05\uFE0F \u7B2C\u4E03\u6B65 \u8DF3\u5230\u8FD9\u91CC \u5728\u4F20\u5165\u7684exports\u5BF9\u8C61\u4E0A\u6DFB\u52A0name\u5C5E\u6027\uFF0C\u503C\u4E3A&#39;Webpack&#39;</span>
      <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token punctuation">(</span>exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u2B05\uFE0F-\u5206\u6790\u6587\u4EF6\u7684\u6267\u884C\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u2B05\uFE0F-\u5206\u6790\u6587\u4EF6\u7684\u6267\u884C\u8FC7\u7A0B" aria-hidden="true">#</a> \u2B05\uFE0F \u5206\u6790\u6587\u4EF6\u7684\u6267\u884C\u8FC7\u7A0B</h5><p>1\uFF09\u6574\u4F53\u5927\u81F4\u5206\u4E3A 10 \u6B65\uFF0C\u7B2C\u4E00\u6B65\u4ECE<code>require(0)</code>\u5F00\u59CB\u6267\u884C\uFF0C\u8C03\u7528\u5185\u7F6E\u7684\u81EA\u5B9A\u4E49 require \u51FD\u6570\uFF0C\u8DF3\u8F6C\u5230\u7B2C\u4E8C\u6B65\uFF0C\u6267\u884C<code>fn</code>\u51FD\u6570</p><p>2\uFF09\u6267\u884C\u7B2C\u4E09\u6B65<code>require(&#39;./message.js&#39;)</code>\uFF0C\u7EE7\u7EED\u8DF3\u8F6C\u5230\u7B2C\u56DB\u6B65 <code>require(mapping[&#39;./message.js&#39;])</code>, \u6700\u7EC8\u8F6C\u5316\u4E3A<code>require(1)</code></p><p>3\uFF09\u7EE7\u7EED\u6267\u884C<code>require(1)</code>\uFF0C\u83B7\u53D6<code>modules[1]</code>\uFF0C\u4E5F\u5C31\u662F\u6267\u884C<code>message.js</code>\u7684\u5185\u5BB9</p><p>4\uFF09\u7B2C\u4E94\u6B65<code>require(&#39;./name.js&#39;)</code>\uFF0C\u6700\u7EC8\u8F6C\u5316\u4E3A<code>require(2)</code>\uFF0C\u6267\u884C<code>name.js</code>\u7684\u5185\u5BB9</p><p>5\uFF09\u901A\u8FC7\u9012\u5F52\u8C03\u7528\uFF0C\u5C06\u4EE3\u7801\u4E2D\u5BFC\u51FA\u7684\u5C5E\u6027\uFF0C\u653E\u5230<code>exports</code>\u5BF9\u8C61\u4E2D\uFF0C\u4E00\u5C42\u5C42\u5BFC\u51FA\u5230\u6700\u5916\u5C42</p><p>6\uFF09\u6700\u7EC8\u901A\u8FC7<code>_message2.default</code>\u83B7\u53D6\u5BFC\u51FA\u7684\u503C\uFF0C\u9875\u9762\u663E\u793A<code>hello Webpack!</code></p><h4 id="webpack-\u7684\u6253\u5305\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#webpack-\u7684\u6253\u5305\u6D41\u7A0B" aria-hidden="true">#</a> Webpack \u7684\u6253\u5305\u6D41\u7A0B</h4><p><strong>\u603B\u7ED3\u4E00\u4E0B webpack \u5B8C\u6574\u7684\u6253\u5305\u6D41\u7A0B</strong></p><p>1\uFF09webpack \u4ECE\u9879\u76EE\u7684<code>entry</code>\u5165\u53E3\u6587\u4EF6\u5F00\u59CB\u9012\u5F52\u5206\u6790\uFF0C\u8C03\u7528\u6240\u6709\u914D\u7F6E\u7684 <code>loader</code>\u5BF9\u6A21\u5757\u8FDB\u884C\u7F16\u8BD1</p><p>\u56E0\u4E3A webpack \u9ED8\u8BA4\u53EA\u80FD\u8BC6\u522B js \u4EE3\u7801\uFF0C\u6240\u4EE5\u5982 css \u6587\u4EF6\u3001.vue \u7ED3\u5C3E\u7684\u6587\u4EF6\uFF0C\u5FC5\u987B\u8981\u901A\u8FC7\u5BF9\u5E94\u7684 loader \u89E3\u6790\u6210 js \u4EE3\u7801\u540E\uFF0Cwebpack \u624D\u80FD\u8BC6\u522B</p><p>2\uFF09\u5229\u7528<code>babel(babylon)</code>\u5C06 js \u4EE3\u7801\u8F6C\u5316\u4E3A<code>ast\u62BD\u8C61\u8BED\u6CD5\u6811</code>\uFF0C\u7136\u540E\u901A\u8FC7<code>babel-traverse</code>\u5BF9 ast \u8FDB\u884C\u904D\u5386</p><p>3\uFF09\u904D\u5386\u7684\u76EE\u7684\u627E\u5230\u6587\u4EF6\u7684<code>import\u5F15\u7528\u8282\u70B9</code></p><p>\u56E0\u4E3A\u73B0\u5728\u6211\u4EEC\u5F15\u5165\u6587\u4EF6\u90FD\u662F\u901A\u8FC7 import \u7684\u65B9\u5F0F\u5F15\u5165\uFF0C\u6240\u4EE5\u627E\u5230\u4E86 import \u8282\u70B9\uFF0C\u5C31\u627E\u5230\u4E86\u6587\u4EF6\u7684\u4F9D\u8D56\u5173\u7CFB</p><p>4\uFF09\u540C\u65F6\u6BCF\u4E2A\u6A21\u5757\u751F\u6210\u4E00\u4E2A\u552F\u4E00\u7684 id\uFF0C\u5E76\u5C06\u89E3\u6790\u8FC7\u7684<code>\u6A21\u5757\u7F13\u5B58</code>\u8D77\u6765\uFF0C\u5982\u679C\u5176\u4ED6\u5730\u65B9\u4E5F\u5F15\u5165\u8BE5\u6A21\u5757\uFF0C\u5C31\u65E0\u9700\u91CD\u65B0\u89E3\u6790\uFF0C\u6700\u540E\u6839\u636E\u4F9D\u8D56\u5173\u7CFB\u751F\u6210\u4F9D\u8D56\u56FE\u8C31</p><p>5\uFF09\u9012\u5F52\u904D\u5386\u6240\u6709\u4F9D\u8D56\u56FE\u8C31\u7684\u6A21\u5757\uFF0C\u7EC4\u88C5\u6210\u4E00\u4E2A\u4E2A\u5305\u542B\u591A\u4E2A\u6A21\u5757\u7684 <code>Chunk(\u5757)</code></p><p>6\uFF09\u6700\u540E\u5C06\u751F\u6210\u7684\u6587\u4EF6\u8F93\u51FA\u5230 <code>output</code> \u7684\u76EE\u5F55\u4E2D</p><h4 id="\u70ED\u66F4\u65B0\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u70ED\u66F4\u65B0\u539F\u7406" aria-hidden="true">#</a> \u70ED\u66F4\u65B0\u539F\u7406</h4><p><strong>\u4EC0\u4E48\u662F webpack \u70ED\u66F4\u65B0\uFF1F</strong></p><p>\u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u4EE3\u7801\u53D1\u751F\u53D8\u52A8\u540E\uFF0Cwebpack \u4F1A\u91CD\u65B0\u7F16\u8BD1\uFF0C\u7F16\u8BD1\u540E\u6D4F\u89C8\u5668\u66FF\u6362\u4FEE\u6539\u7684\u6A21\u5757\uFF0C\u5C40\u90E8\u66F4\u65B0\uFF0C\u65E0\u9700\u5237\u65B0\u6574\u4E2A\u9875\u9762</p><p><strong>\u597D\u5904</strong>\uFF1A\u8282\u7701\u5F00\u53D1\u65F6\u95F4\u3001\u63D0\u5347\u5F00\u53D1\u4F53\u9A8C</p><p><strong>\u70ED\u66F4\u65B0\u539F\u7406</strong></p><p>\u4E3B\u8981\u662F\u901A\u8FC7<code>websocket</code>\u5B9E\u73B0\uFF0C\u5EFA\u7ACB\u672C\u5730\u670D\u52A1\u548C\u6D4F\u89C8\u5668\u7684\u53CC\u5411\u901A\u4FE1\u3002\u5F53\u4EE3\u7801\u53D8\u5316\uFF0C\u91CD\u65B0\u7F16\u8BD1\u540E\uFF0C\u901A\u77E5\u6D4F\u89C8\u5668\u8BF7\u6C42\u66F4\u65B0\u7684\u6A21\u5757\uFF0C\u66FF\u6362\u539F\u6709\u7684\u6A21\u5757</p><p>1\uFF09 \u901A\u8FC7<code>webpack-dev-server</code>\u5F00\u542F<code>server\u670D\u52A1</code>\uFF0C\u672C\u5730 server \u542F\u52A8\u4E4B\u540E\uFF0C\u518D\u53BB\u542F\u52A8 websocket \u670D\u52A1\uFF0C\u5EFA\u7ACB\u672C\u5730\u670D\u52A1\u548C\u6D4F\u89C8\u5668\u7684\u53CC\u5411\u901A\u4FE1</p><p>2\uFF09 webpack \u6BCF\u6B21\u7F16\u8BD1\u540E\uFF0C\u4F1A\u751F\u6210\u4E00\u4E2A<code>Hash\u503C</code>\uFF0CHash \u4EE3\u8868\u6BCF\u4E00\u6B21\u7F16\u8BD1\u7684\u6807\u8BC6\u3002\u672C\u6B21\u8F93\u51FA\u7684 Hash \u503C\u4F1A\u7F16\u8BD1\u65B0\u751F\u6210\u7684\u6587\u4EF6\u6807\u8BC6\uFF0C\u88AB\u4F5C\u4E3A\u4E0B\u6B21\u70ED\u66F4\u65B0\u7684\u6807\u8BC6</p><p>3\uFF09webpack<code>\u76D1\u542C\u6587\u4EF6\u53D8\u5316</code>\uFF08\u4E3B\u8981\u662F\u901A\u8FC7\u6587\u4EF6\u7684\u751F\u6210\u65F6\u95F4\u5224\u65AD\u662F\u5426\u6709\u53D8\u5316\uFF09\uFF0C\u5F53\u6587\u4EF6\u53D8\u5316\u540E\uFF0C\u91CD\u65B0\u7F16\u8BD1</p><p>4\uFF09\u7F16\u8BD1\u7ED3\u675F\u540E\uFF0C\u901A\u77E5\u6D4F\u89C8\u5668\u8BF7\u6C42\u53D8\u5316\u7684\u8D44\u6E90\uFF0C\u540C\u65F6\u5C06\u65B0\u751F\u6210\u7684 hash \u503C\u4F20\u7ED9\u6D4F\u89C8\u5668\uFF0C\u7528\u4E8E\u4E0B\u6B21\u70ED\u66F4\u65B0\u4F7F\u7528</p><p>5\uFF09\u6D4F\u89C8\u5668\u62FF\u5230\u66F4\u65B0\u540E\u7684\u6A21\u5757\u540E\uFF0C\u7528\u65B0\u6A21\u5757\u66FF\u6362\u6389\u65E7\u7684\u6A21\u5757\uFF0C\u4ECE\u800C\u5B9E\u73B0\u4E86\u5C40\u90E8\u5237\u65B0</p>`,35),v={href:"https://juejin.cn/post/6844904008432222215",target:"_blank",rel:"noopener noreferrer"},m={href:"https://link.juejin.cn/?target=http%3A%2F%2Fwebpack.wuhaolin.cn",target:"_blank",rel:"noopener noreferrer"},b={href:"https://juejin.cn/post/6844904079219490830",target:"_blank",rel:"noopener noreferrer"},g=e(`<h3 id="plugin" tabindex="-1"><a class="header-anchor" href="#plugin" aria-hidden="true">#</a> Plugin</h3><p><strong>\u4F5C\u7528\uFF1A\u6269\u5C55 webpack \u529F\u80FD</strong></p><p><strong>\u5DE5\u4F5C\u539F\u7406</strong></p><p>webpack \u901A\u8FC7\u5185\u90E8\u7684\u4E8B\u4EF6\u6D41\u673A\u5236\u4FDD\u8BC1\u4E86\u63D2\u4EF6\u7684\u6709\u5E8F\u6027\uFF0C\u5E95\u5C42\u662F\u5229\u7528<code>\u53D1\u5E03\u8BA2\u9605\u6A21\u5F0F</code>\uFF0Cwebpack \u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u4F1A\u5E7F\u64AD\u4E8B\u4EF6\uFF0C\u63D2\u4EF6\u53EA\u9700\u8981\u76D1\u542C\u5B83\u6240\u5173\u5FC3\u7684\u4E8B\u4EF6\uFF0C\u5728\u7279\u5B9A\u7684\u65F6\u673A\u5BF9\u8D44\u6E90\u505A\u5904\u7406</p><h4 id="\u624B\u5199\u4E00\u4E2A-plugin-\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199\u4E00\u4E2A-plugin-\u63D2\u4EF6" aria-hidden="true">#</a> \u624B\u5199\u4E00\u4E2A Plugin \u63D2\u4EF6</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u81EA\u5B9A\u4E49\u4E00\u4E2A\u540D\u4E3AMyPlugin\u63D2\u4EF6\uFF0C\u8BE5\u63D2\u4EF6\u5728\u6253\u5305\u5B8C\u6210\u540E\uFF0C\u5728\u63A7\u5236\u53F0\u8F93\u51FA&quot;\u6253\u5305\u5DF2\u5B8C\u6210&quot;</span>
<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u539F\u578B\u4E0A\u9700\u8981\u5B9A\u4E49apply \u7684\u65B9\u6CD5</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u901A\u8FC7compiler\u83B7\u53D6webpack\u5185\u90E8\u7684\u94A9\u5B50</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;My Plugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\u6253\u5305\u5DF2\u5B8C\u6210&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u5206\u4E3A\u540C\u6B65\u548C\u5F02\u6B65\u7684\u94A9\u5B50\uFF0C\u5F02\u6B65\u94A9\u5B50\u5FC5\u987B\u6267\u884C\u5BF9\u5E94\u7684\u56DE\u8C03</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyPlugin<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5728-vue-\u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5728-vue-\u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49\u63D2\u4EF6" aria-hidden="true">#</a> \u5728 vue \u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49\u63D2\u4EF6</h4><p>1\uFF09\u5728<code>vue.config.js</code>\u5F15\u5165\u8BE5\u63D2\u4EF6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>const MyPlugin = require(&#39;./MyPlugin.js&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2\uFF09\u5728<code>configureWebpack</code>\u7684 plugins \u5217\u8868\u4E2D\u6CE8\u518C\u8BE5\u63D2\u4EF6</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">module.exports</span> <span class="token punctuation">=</span> <span class="token value attr-value">{</span>
  configureWebpack: {
    plugins: [new MyPlugin()]
  }
};

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3\uFF09\u6267\u884C\u9879\u76EE\u7684\u6253\u5305\u547D\u4EE4 \u5F53\u9879\u76EE\u6253\u5305\u6210\u529F\u540E\uFF0C\u4F1A\u5728\u63A7\u5236\u53F0\u8F93\u51FA\uFF1A<code>\u6253\u5305\u5DF2\u5B8C\u6210</code></p><h4 id="plugin-\u7684\u7EC4\u6210\u90E8\u5206" tabindex="-1"><a class="header-anchor" href="#plugin-\u7684\u7EC4\u6210\u90E8\u5206" aria-hidden="true">#</a> Plugin \u7684\u7EC4\u6210\u90E8\u5206</h4><p>1\uFF09Plugin \u7684\u672C\u8D28\u662F\u4E00\u4E2A <code>node \u6A21\u5757</code>\uFF0C\u8FD9\u4E2A\u6A21\u5757\u5BFC\u51FA\u4E00\u4E2A JavaScript \u7C7B</p><p>2\uFF09\u5B83\u7684\u539F\u578B\u4E0A\u9700\u8981\u5B9A\u4E49\u4E00\u4E2A<code>apply</code> \u7684\u65B9\u6CD5</p><p>3\uFF09\u901A\u8FC7<code>compiler</code>\u83B7\u53D6 webpack \u5185\u90E8\u7684\u94A9\u5B50\uFF0C\u83B7\u53D6 webpack \u6253\u5305\u8FC7\u7A0B\u4E2D\u7684\u5404\u4E2A\u9636\u6BB5</p><p>\u94A9\u5B50\u5206\u4E3A\u540C\u6B65\u548C\u5F02\u6B65\u7684\u94A9\u5B50\uFF0C\u5F02\u6B65\u94A9\u5B50\u5FC5\u987B\u6267\u884C\u5BF9\u5E94\u7684\u56DE\u8C03</p><p>4\uFF09\u901A\u8FC7<code>compilation</code>\u64CD\u4F5C webpack \u5185\u90E8\u5B9E\u4F8B\u7279\u5B9A\u6570\u636E</p><p>5\uFF09\u529F\u80FD\u5B8C\u6210\u540E\uFF0C\u6267\u884C webpack \u63D0\u4F9B\u7684 cb \u56DE\u8C03</p><p><strong>compiler \u4E0A\u66B4\u9732\u7684\u4E00\u4E9B\u5E38\u7528\u7684\u94A9\u5B50\u7B80\u4ECB</strong></p><table><thead><tr><th>\u94A9\u5B50</th><th>\u7C7B\u578B</th><th>\u8C03\u7528\u65F6\u673A</th></tr></thead><tbody><tr><td>run</td><td>AsyncSeriesHook</td><td>\u5728\u7F16\u8BD1\u5668\u5F00\u59CB\u8BFB\u53D6\u8BB0\u5F55\u524D\u6267\u884C</td></tr><tr><td>compile</td><td>SyncHook</td><td>\u5728\u4E00\u4E2A\u65B0\u7684 compilation \u521B\u5EFA\u4E4B\u524D\u6267\u884C</td></tr><tr><td>compilation</td><td>SyncHook</td><td>\u5728\u4E00\u6B21 compilation \u521B\u5EFA\u540E\u6267\u884C\u63D2\u4EF6</td></tr><tr><td>make</td><td>AsyncParallelHook</td><td>\u5B8C\u6210\u4E00\u6B21\u7F16\u8BD1\u4E4B\u524D\u6267\u884C</td></tr><tr><td>emit</td><td>AsyncSeriesHook</td><td>\u5728\u751F\u6210\u6587\u4EF6\u5230 output \u76EE\u5F55\u4E4B\u524D\u6267\u884C\uFF0C\u56DE\u8C03\u53C2\u6570\uFF1A compilation</td></tr><tr><td>afterEmit</td><td>AsyncSeriesHook</td><td>\u5728\u751F\u6210\u6587\u4EF6\u5230 output \u76EE\u5F55\u4E4B\u540E\u6267\u884C</td></tr><tr><td>assetEmitted</td><td>AsyncSeriesHook</td><td>\u751F\u6210\u6587\u4EF6\u7684\u65F6\u5019\u6267\u884C\uFF0C\u63D0\u4F9B\u8BBF\u95EE\u4EA7\u51FA\u6587\u4EF6\u4FE1\u606F\u7684\u5165\u53E3\uFF0C\u56DE\u8C03\u53C2\u6570\uFF1Afile\uFF0Cinfo</td></tr><tr><td>done</td><td>AsyncSeriesHook</td><td>\u4E00\u6B21\u7F16\u8BD1\u5B8C\u6210\u540E\u6267\u884C\uFF0C\u56DE\u8C03\u53C2\u6570\uFF1Astats</td></tr></tbody></table><h4 id="\u5E38\u7528\u7684-plugin-\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5E38\u7528\u7684-plugin-\u63D2\u4EF6" aria-hidden="true">#</a> \u5E38\u7528\u7684 Plugin \u63D2\u4EF6</h4><table><thead><tr><th>\u63D2\u4EF6\u540D\u79F0</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td>html-webpack-plugin</td><td>\u751F\u6210 html \u6587\u4EF6,\u5F15\u5165\u516C\u5171\u7684 js \u548C css \u8D44\u6E90</td></tr><tr><td>webpack-bundle-analyzer</td><td>\u5BF9\u6253\u5305\u540E\u7684\u6587\u4EF6\u8FDB\u884C\u5206\u6790\uFF0C\u751F\u6210\u8D44\u6E90\u5206\u6790\u56FE</td></tr><tr><td>terser-webpack-plugin</td><td>\u4EE3\u7801\u538B\u7F29\uFF0C\u79FB\u9664 console.log \u6253\u5370\u7B49</td></tr><tr><td>HappyPack Plugin</td><td>\u5F00\u542F\u591A\u7EBF\u7A0B\u6253\u5305\uFF0C\u63D0\u5347\u6253\u5305\u901F\u5EA6</td></tr><tr><td>Dllplugin</td><td>\u52A8\u6001\u94FE\u63A5\u5E93\uFF0C\u5C06\u9879\u76EE\u4E2D\u4F9D\u8D56\u7684\u4E09\u65B9\u6A21\u5757\u62BD\u79BB\u51FA\u6765\uFF0C\u5355\u72EC\u6253\u5305</td></tr><tr><td>DllReferencePlugin</td><td>\u914D\u5408 Dllplugin\uFF0C\u901A\u8FC7 manifest.json \u6620\u5C04\u5230\u76F8\u5173\u7684\u4F9D\u8D56\u4E0A\u53BB</td></tr><tr><td>clean-webpack-plugin</td><td>\u6E05\u7406\u4E0A\u4E00\u6B21\u9879\u76EE\u751F\u6210\u7684\u6587\u4EF6</td></tr><tr><td>vue-skeleton-webpack-plugin</td><td>vue \u9879\u76EE\u5B9E\u73B0\u9AA8\u67B6\u5C4F</td></tr></tbody></table>`,23),h={href:"https://link.juejin.cn/?target=https%3A%2F%2Fchampyin.com%2F2020%2F01%2F12%2F%E6%8F%AD%E7%A7%98webpack-plugin%2F",target:"_blank",rel:"noopener noreferrer"},f=e(`<h3 id="loader" tabindex="-1"><a class="header-anchor" href="#loader" aria-hidden="true">#</a> Loader</h3><p><strong>Loader \u4F5C\u7528</strong></p><p>webpack \u53EA\u80FD\u76F4\u63A5\u5904\u7406 js \u683C\u5F0F\u7684\u8D44\u6E90\uFF0C\u4EFB\u4F55\u975E js \u6587\u4EF6\u90FD\u5FC5\u987B\u88AB\u5BF9\u5E94\u7684<code>loader</code>\u5904\u7406\u8F6C\u6362\u4E3A js \u4EE3\u7801</p><h4 id="\u624B\u5199\u4E00\u4E2A-loader" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199\u4E00\u4E2A-loader" aria-hidden="true">#</a> \u624B\u5199\u4E00\u4E2A loader</h4><p><strong>\u4E00\u4E2A\u7B80\u5355\u7684<code>style-loader</code></strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>// \u4F5C\u7528\uFF1A\u5C06css\u5185\u5BB9\uFF0C\u901A\u8FC7style\u6807\u7B7E\u63D2\u5165\u5230\u9875\u9762\u4E2D
// source\u4E3A\u8981\u5904\u7406\u7684css\u6E90\u6587\u4EF6
function loader(source) {
  <span class="token key attr-name">let style</span> <span class="token punctuation">=</span> <span class="token value attr-value">\`</span>
    <span class="token key attr-name">let style</span> <span class="token punctuation">=</span> <span class="token value attr-value">document.createElement(&#39;style&#39;);</span>
    style.setAttribute(&quot;type&quot;, &quot;text/css&quot;);
    <span class="token key attr-name">style.innerHTML</span> <span class="token punctuation">=</span> <span class="token value attr-value">\${source};</span>
    document.head.appendChild(style)\`;
  return style;
}
<span class="token key attr-name">module.exports</span> <span class="token punctuation">=</span> <span class="token value attr-value">loader;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5728-vue-\u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49-loader" tabindex="-1"><a class="header-anchor" href="#\u5728-vue-\u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49-loader" aria-hidden="true">#</a> \u5728 vue \u9879\u76EE\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49 loader</h4><p>1\uFF09\u5728<code>vue.config.js</code>\u5F15\u5165\u8BE5 loader</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>const MyStyleLoader = require(&#39;./style-loader&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2\uFF09\u5728<code>configureWebpack</code>\u4E2D\u6DFB\u52A0\u914D\u7F6E</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">module.exports =</span> <span class="token punctuation">{</span>
  <span class="token selector">configureWebpack:</span> <span class="token punctuation">{</span>
    <span class="token selector">module:</span> <span class="token punctuation">{</span>
      <span class="token selector">rules: [</span>
        <span class="token punctuation">{</span>
          // \u5BF9main.css\u6587\u4EF6\u4F7F\u7528MyStyleLoader\u5904\u7406
          <span class="token property">test</span><span class="token punctuation">:</span> /main.css/<span class="token punctuation">,</span>
          <span class="token property">loader</span><span class="token punctuation">:</span> MyStyleLoader
        <span class="token punctuation">}</span>
      ]
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3\uFF09\u9879\u76EE\u91CD\u65B0\u7F16\u8BD1 <code>main.css</code>\u6837\u5F0F\u5DF2\u52A0\u8F7D\u5230\u9875\u9762\u4E2D</p><h4 id="loader-\u7684\u7EC4\u6210\u90E8\u5206" tabindex="-1"><a class="header-anchor" href="#loader-\u7684\u7EC4\u6210\u90E8\u5206" aria-hidden="true">#</a> loader \u7684\u7EC4\u6210\u90E8\u5206</h4><p>loader \u7684\u672C\u8D28\u662F\u4E00\u4E2A <code>node</code>\u6A21\u5757\uFF0C\u8BE5\u6A21\u5757\u5BFC\u51FA\u4E00\u4E2A\u51FD\u6570\uFF0C\u51FD\u6570\u63A5\u6536<code>source(\u6E90\u6587\u4EF6)</code>\uFF0C\u8FD4\u56DE\u5904\u7406\u540E\u7684<code>source</code></p><h4 id="loader-\u6267\u884C\u987A\u5E8F" tabindex="-1"><a class="header-anchor" href="#loader-\u6267\u884C\u987A\u5E8F" aria-hidden="true">#</a> loader \u6267\u884C\u987A\u5E8F</h4><p>\u76F8\u540C\u4F18\u5148\u7EA7\u7684 loader \u94FE\uFF0C\u6267\u884C\u987A\u5E8F\u4E3A\uFF1A<code>\u4ECE\u53F3\u5230\u5DE6\uFF0C\u4ECE\u4E0B\u5230\u4E0A</code></p><p>\u5982<code>use: [&#39;loader1&#39;, &#39;loader2&#39;, &#39;loader3&#39;]</code>\uFF0C\u6267\u884C\u987A\u5E8F\u4E3A <code>loader3 \u2192 loader2 \u2192 loader1</code></p><h4 id="\u5E38\u7528\u7684-loader" tabindex="-1"><a class="header-anchor" href="#\u5E38\u7528\u7684-loader" aria-hidden="true">#</a> \u5E38\u7528\u7684 loader</h4><table><thead><tr><th>\u540D\u79F0</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td>style-loader</td><td>\u7528\u4E8E\u5C06 css \u7F16\u8BD1\u5B8C\u6210\u7684\u6837\u5F0F\uFF0C\u6302\u8F7D\u5230\u9875\u9762 style \u6807\u7B7E\u4E0A</td></tr><tr><td>css-loader</td><td>\u7528\u4E8E\u8BC6\u522B .css \u6587\u4EF6, \u987B\u914D\u5408 style-loader \u5171\u540C\u4F7F\u7528</td></tr><tr><td>sass-loader/less-loader</td><td>css \u9884\u5904\u7406\u5668</td></tr><tr><td>postcss-loader</td><td>\u7528\u4E8E\u8865\u5145 css \u6837\u5F0F\u5404\u79CD\u6D4F\u89C8\u5668\u5185\u6838\u524D\u7F00</td></tr><tr><td>url-loader</td><td>\u5904\u7406\u56FE\u7247\u7C7B\u578B\u8D44\u6E90\uFF0C\u53EF\u4EE5\u8F6C base64</td></tr><tr><td>vue-loader</td><td>\u7528\u4E8E\u7F16\u8BD1 .vue \u6587\u4EF6</td></tr><tr><td>worker-loader</td><td>\u901A\u8FC7\u5185\u8054 loader \u7684\u65B9\u5F0F\u4F7F\u7528 web worker \u529F\u80FD</td></tr><tr><td>style-resources-loader</td><td>\u5168\u5C40\u5F15\u7528\u5BF9\u5E94\u7684 css\uFF0C\u907F\u514D\u9875\u9762\u518D\u5206\u522B\u5F15\u5165</td></tr></tbody></table>`,19),y={href:"https://link.juejin.cn/?target=https%3A%2F%2Fchampyin.com%2F2020%2F01%2F28%2F%E6%8F%AD%E7%A7%98webpack-loader%2F",target:"_blank",rel:"noopener noreferrer"},q=e(`<h3 id="webpack5-\u6A21\u5757\u8054\u90A6" tabindex="-1"><a class="header-anchor" href="#webpack5-\u6A21\u5757\u8054\u90A6" aria-hidden="true">#</a> Webpack5 \u6A21\u5757\u8054\u90A6</h3><p>webpack5 <code>\u6A21\u5757\u8054\u90A6(Module Federation)</code> \u4F7F JavaScript \u5E94\u7528\uFF0C\u5F97\u4EE5\u4ECE\u53E6\u4E00\u4E2A JavaScript \u5E94\u7528\u4E2D\u52A8\u6001\u7684\u52A0\u8F7D\u4EE3\u7801\uFF0C\u5B9E\u73B0\u5171\u4EAB\u4F9D\u8D56\uFF0C\u7528\u4E8E\u524D\u7AEF\u7684\u5FAE\u670D\u52A1\u5316</p><p>\u6BD4\u5982<code>\u9879\u76EEA</code>\u548C<code>\u9879\u76EEB</code>\uFF0C\u516C\u7528<code>\u9879\u76EEC</code>\u7EC4\u4EF6\uFF0C\u4EE5\u5F80\u8FD9\u79CD\u60C5\u51B5\uFF0C\u53EF\u4EE5\u5C06 C \u7EC4\u4EF6\u53D1\u5E03\u5230 npm \u4E0A\uFF0C\u7136\u540E A \u548C B \u518D\u5177\u4F53\u5F15\u5165\u3002\u5F53 C \u7EC4\u4EF6\u53D1\u751F\u53D8\u5316\u540E\uFF0C\u9700\u8981\u91CD\u65B0\u53D1\u5E03\u5230 npm \u4E0A\uFF0CA \u548C B \u4E5F\u9700\u8981\u91CD\u65B0\u4E0B\u8F7D\u5B89\u88C5</p><p>\u4F7F\u7528\u6A21\u5757\u8054\u90A6\u540E\uFF0C\u53EF\u4EE5\u5728\u8FDC\u7A0B\u6A21\u5757\u7684 Webpack \u914D\u7F6E\u4E2D\uFF0C\u5C06 C \u7EC4\u4EF6\u6A21\u5757\u66B4\u9732\u51FA\u53BB\uFF0C\u9879\u76EE A \u548C\u9879\u76EE B \u5C31\u53EF\u4EE5\u8FDC\u7A0B\u8FDB\u884C\u4F9D\u8D56\u5F15\u7528\u3002\u5F53 C \u7EC4\u4EF6\u53D1\u751F\u53D8\u5316\u540E\uFF0CA \u548C B \u65E0\u9700\u91CD\u65B0\u5F15\u7528</p><p>\u6A21\u5757\u8054\u90A6\u5229\u7528 webpack5 \u5185\u7F6E\u7684<code>ModuleFederationPlugin</code>\u63D2\u4EF6\uFF0C\u5B9E\u73B0\u4E86\u9879\u76EE\u4E2D\u95F4\u76F8\u4E92\u5F15\u7528\u7684\u6309\u9700\u70ED\u63D2\u62D4</p><h4 id="webpack-modulefederationplugin" tabindex="-1"><a class="header-anchor" href="#webpack-modulefederationplugin" aria-hidden="true">#</a> <strong>Webpack ModuleFederationPlugin</strong></h4><p><strong>\u91CD\u8981\u53C2\u6570\u8BF4\u660E</strong></p><p>1\uFF09<code>name</code> \u5F53\u524D\u5E94\u7528\u540D\u79F0\uFF0C\u9700\u8981\u5168\u5C40\u552F\u4E00</p><p>2\uFF09<code>remotes</code> \u53EF\u4EE5\u5C06\u5176\u4ED6\u9879\u76EE\u7684 <code>name</code> \u6620\u5C04\u5230\u5F53\u524D\u9879\u76EE\u4E2D</p><p>3\uFF09<code>exposes</code> \u8868\u793A\u5BFC\u51FA\u7684\u6A21\u5757\uFF0C\u53EA\u6709\u5728\u6B64\u7533\u660E\u7684\u6A21\u5757\u624D\u53EF\u4EE5\u4F5C\u4E3A\u8FDC\u7A0B\u4F9D\u8D56\u88AB\u4F7F\u7528</p><p>4\uFF09<code>shared</code> \u662F\u975E\u5E38\u91CD\u8981\u7684\u53C2\u6570\uFF0C\u5236\u5B9A\u4E86\u8FD9\u4E2A\u53C2\u6570\uFF0C\u53EF\u4EE5\u8BA9\u8FDC\u7A0B\u52A0\u8F7D\u7684\u6A21\u5757\u5BF9\u5E94\u4F9D\u8D56\uFF0C\u6539\u4E3A\u4F7F\u7528\u672C\u5730\u9879\u76EE\u7684\u4F9D\u8D56\uFF0C\u5982 React \u6216 ReactDOM</p><p><strong>\u914D\u7F6E\u793A\u4F8B</strong></p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">new ModuleFederationPlugin(</span><span class="token punctuation">{</span>
     <span class="token selector">name: &quot;app_1&quot;,
     library:</span> <span class="token punctuation">{</span> <span class="token property">type</span><span class="token punctuation">:</span> <span class="token string">&quot;var&quot;</span><span class="token punctuation">,</span> <span class="token property">name</span><span class="token punctuation">:</span> <span class="token string">&quot;app_1&quot;</span> <span class="token punctuation">}</span><span class="token selector">,
     filename: &quot;remoteEntry.js&quot;,
     remotes:</span> <span class="token punctuation">{</span>
        <span class="token property">app_02</span><span class="token punctuation">:</span> <span class="token string">&#39;app_02&#39;</span><span class="token punctuation">,</span>
        <span class="token property">app_03</span><span class="token punctuation">:</span> <span class="token string">&#39;app_03&#39;</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token selector">,
     exposes:</span> <span class="token punctuation">{</span>
        <span class="token property">antd</span><span class="token punctuation">:</span> <span class="token string">&#39;./src/antd&#39;</span><span class="token punctuation">,</span>
        <span class="token property">button</span><span class="token punctuation">:</span> <span class="token string">&#39;./src/button&#39;</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">shared</span><span class="token punctuation">:</span> [<span class="token string">&#39;react&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;react-dom&#39;</span>]<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),w={href:"https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F115403616",target:"_blank",rel:"noopener noreferrer"},j={href:"https://juejin.cn/post/6844904187147321352",target:"_blank",rel:"noopener noreferrer"},x={href:"https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fsendudu%2Farticle%2Fdetails%2F110232830",target:"_blank",rel:"noopener noreferrer"},_=e(`<h3 id="vite" tabindex="-1"><a class="header-anchor" href="#vite" aria-hidden="true">#</a> Vite</h3><p>Vite \u88AB\u8A89\u4E3A<code>\u4E0B\u4E00\u4EE3\u7684\u6784\u5EFA\u5DE5\u5177</code></p><p>\u4E0A\u624B\u4E86\u51E0\u4E2A\u9879\u76EE\u540E\uFF0C\u679C\u7136\u540D\u4E0D\u865A\u4F20\uFF0C\u70ED\u66F4\u65B0\u901F\u5EA6\u771F\u7684\u662F<code>\u5FEB\u7684\u98DE\u8D77\uFF01</code></p><h4 id="vite-\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#vite-\u539F\u7406" aria-hidden="true">#</a> Vite \u539F\u7406</h4><p>1\uFF09Vite \u5229\u7528\u6D4F\u89C8\u5668\u652F\u6301\u539F\u751F\u7684<code>es module</code>\u6A21\u5757\uFF0C\u5F00\u53D1\u65F6\u8DF3\u8FC7\u6253\u5305\u7684\u8FC7\u7A0B\uFF0C\u63D0\u5347\u7F16\u8BD1\u6548\u7387</p><p>2\uFF09\u5F53\u901A\u8FC7 import \u52A0\u8F7D\u8D44\u6E90\u65F6\uFF0C\u6D4F\u89C8\u5668\u4F1A\u53D1\u51FA HTTP \u8BF7\u6C42\u5BF9\u5E94\u7684\u6587\u4EF6\uFF0C<code>Vite\u62E6\u622A\u5230\u8BE5\u8BF7\u6C42</code>\uFF0C\u8FD4\u56DE\u5BF9\u5E94\u7684\u6A21\u5757\u6587\u4EF6</p><p><strong>es module \u7B80\u5355\u793A\u4F8B</strong></p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>import { a } from &#39;./a.js&#39;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>1\uFF09\u5F53\u58F0\u660E\u4E00\u4E2A script \u6807\u7B7E\u7C7B\u578B\u4E3A <code>module</code> \u65F6\uFF0C\u6D4F\u89C8\u5668\u5C06\u5BF9\u5176\u5185\u90E8\u7684 import \u5F15\u7528\u53D1\u8D77 HTTP \u8BF7\u6C42\uFF0C\u83B7\u53D6\u6A21\u5757\u5185\u5BB9</p><p>2\uFF09\u6D4F\u89C8\u5668\u5C06\u53D1\u8D77\u4E00\u4E2A\u5BF9 <code>HOST/a.js</code> \u7684 HTTP \u8BF7\u6C42\uFF0C\u83B7\u53D6\u5230\u5185\u5BB9\u4E4B\u540E\u518D\u6267\u884C</p><p><strong>Vite \u7684\u9650\u5236</strong></p><p>Vite \u4E3B\u8981\u5BF9\u5E94\u7684\u573A\u666F\u662F\u5F00\u53D1\u6A21\u5F0F\uFF08\u751F\u4EA7\u6A21\u5F0F\u662F\u7528 <code>rollup \u6253\u5305</code>\uFF09</p><h4 id="vite-\u70ED\u66F4\u65B0\u901F\u5EA6" tabindex="-1"><a class="header-anchor" href="#vite-\u70ED\u66F4\u65B0\u901F\u5EA6" aria-hidden="true">#</a> Vite \u70ED\u66F4\u65B0\u901F\u5EA6</h4><p><strong>Vite \u70ED\u66F4\u65B0\u7684\u901F\u5EA6\u4E0D\u4F1A\u968F\u7740\u6A21\u5757\u589E\u591A\u800C\u53D8\u6162</strong></p><p>1\uFF09Webpack \u7684\u70ED\u66F4\u65B0\u539F\u7406\uFF1A\u4E00\u65E6\u67D0\u4E2A\u4F9D\u8D56\uFF08\u6BD4\u5982\u4E0A\u9762\u7684 a.js\uFF09\u6539\u53D8\uFF0C\u5C31\u5C06\u8FD9\u4E2A\u4F9D\u8D56\u6240\u5904\u7684 \u6574\u4E2A<code>module</code> \u66F4\u65B0\uFF0C\u5E76\u5C06\u65B0\u7684 module \u53D1\u9001\u7ED9\u6D4F\u89C8\u5668\u91CD\u65B0\u6267\u884C</p><p>\u8BD5\u60F3\u5982\u679C\u4F9D\u8D56\u8D8A\u6765\u8D8A\u591A\uFF0C\u5C31\u7B97\u53EA\u4FEE\u6539\u4E00\u4E2A\u6587\u4EF6\uFF0C\u70ED\u66F4\u65B0\u7684\u901F\u5EA6\u4F1A\u8D8A\u6765\u8D8A\u6162</p><p>2\uFF09Vite \u7684\u70ED\u66F4\u65B0\u539F\u7406\uFF1A\u5982\u679C a.js \u53D1\u751F\u4E86\u6539\u53D8\uFF0C\u53EA\u4F1A\u91CD\u65B0\u7F16\u8BD1\u8FD9\u4E2A\u6587\u4EF6 a\uFF0C\u800C\u5176\u4F59\u6587\u4EF6\u90FD\u65E0\u9700\u91CD\u65B0\u7F16\u8BD1</p><p>\u6240\u4EE5\u7406\u8BBA\u4E0A Vite \u70ED\u66F4\u65B0\u7684\u901F\u5EA6\u4E0D\u4F1A\u968F\u7740\u6587\u4EF6\u589E\u52A0\u800C\u53D8\u6162</p><h4 id="\u624B\u5199-vite" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199-vite" aria-hidden="true">#</a> \u624B\u5199 vite</h4>`,19),F={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1at4y1a7zi%3Ffrom%3Dsearch%26seid%3D13340994191382185418%26spm_id_from%3D333.337.0.0",target:"_blank",rel:"noopener noreferrer"},S=e("<p><strong>vite \u7684\u5B9E\u73B0\u6D41\u7A0B</strong></p><p>1\uFF09\u901A\u8FC7<code>koa</code>\u5F00\u542F\u4E00\u4E2A\u670D\u52A1\uFF0C\u83B7\u53D6\u8BF7\u6C42\u7684\u9759\u6001\u6587\u4EF6\u5185\u5BB9</p><p>2\uFF09\u901A\u8FC7<code>es-module-lexer</code> \u89E3\u6790 <code>ast</code> \u62FF\u5230 import \u7684\u5185\u5BB9</p><p>3\uFF09\u5224\u65AD import \u5BFC\u5165\u6A21\u5757\u662F\u5426\u4E3A<code>\u4E09\u65B9\u6A21\u5757</code>\uFF0C\u662F\u7684\u8BDD\uFF0C\u8FD4\u56DE<code>node_module</code>\u4E0B\u7684\u6A21\u5757\uFF0C \u5982 <code>import vue</code> \u8FD4\u56DE <code>import &#39;./@modules/vue&#39;</code></p><p>4\uFF09\u5982\u679C\u662F<code>.vue\u6587\u4EF6</code>\uFF0Cvite \u62E6\u622A\u5BF9\u5E94\u7684\u8BF7\u6C42\uFF0C\u8BFB\u53D6.vue \u6587\u4EF6\u5185\u5BB9\u8FDB\u884C\u7F16\u8BD1\uFF0C\u901A\u8FC7<code>compileTemplate</code> \u7F16\u8BD1\u6A21\u677F\uFF0C\u5C06<code>template\u8F6C\u5316\u4E3Arender\u51FD\u6570</code></p><p>5\uFF09\u901A\u8FC7 babel parse \u5BF9 js \u8FDB\u884C\u7F16\u8BD1\uFF0C\u6700\u7EC8\u8FD4\u56DE\u7F16\u8BD1\u540E\u7684 js \u6587\u4EF6</p>",6),P={href:"https://juejin.cn/post/7021306258057592862",target:"_blank",rel:"noopener noreferrer"},T={href:"https://juejin.cn/post/6844904146915573773",target:"_blank",rel:"noopener noreferrer"},A=e(`<h3 id="babel" tabindex="-1"><a class="header-anchor" href="#babel" aria-hidden="true">#</a> Babel</h3><h4 id="ast-\u62BD\u8C61\u8BED\u6CD5\u6811" tabindex="-1"><a class="header-anchor" href="#ast-\u62BD\u8C61\u8BED\u6CD5\u6811" aria-hidden="true">#</a> AST \u62BD\u8C61\u8BED\u6CD5\u6811</h4><p>\u8FD9\u91CC\u5148\u804A\u4E00\u4E0B<code>AST\u62BD\u8C61\u8BED\u6CD5\u6811</code>\uFF0C\u56E0\u4E3A<code>AST</code>\u662F<code>babel</code>\u7684\u6838\u5FC3</p><p><strong>\u4EC0\u4E48\u662F AST \uFF1F</strong></p><p><code>AST</code>\u662F\u6E90\u4EE3\u7801\u7684\u62BD\u8C61\u8BED\u6CD5\u7ED3\u6784\u7684\u6811\u72B6\u8868\u73B0\u5F62\u5F0F</p><p><strong>\u5728 js \u4E16\u754C\u4E2D\uFF0C\u53EF\u4EE5\u8BA4\u4E3A<code>\u62BD\u8C61\u8BED\u6CD5\u6811(AST)\u662F\u6700\u5E95\u5C42</code></strong></p><p><strong>\u4E00\u4E2A\u7B80\u5355\u7684 AST \u793A\u4F8B</strong></p><p><code>let a = 1</code>\uFF0C\u8F6C\u5316\u6210 AST \u7684\u7ED3\u679C</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
      <span class="token property">&quot;declarations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclarator&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;init&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;let&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),C={href:"https://link.juejin.cn/?target=https%3A%2F%2Fastexplorer.net%2F%23%2F",target:"_blank",rel:"noopener noreferrer"},L={href:"https://link.juejin.cn/?target=https%3A%2F%2Fsegmentfault.com%2Fa%2F1190000016231512",target:"_blank",rel:"noopener noreferrer"},D=e(`<h4 id="babel-\u57FA\u672C\u539F\u7406\u4E0E\u4F5C\u7528" tabindex="-1"><a class="header-anchor" href="#babel-\u57FA\u672C\u539F\u7406\u4E0E\u4F5C\u7528" aria-hidden="true">#</a> Babel \u57FA\u672C\u539F\u7406\u4E0E\u4F5C\u7528</h4><p><code>Babel</code> \u662F\u4E00\u4E2A <code>JS \u7F16\u8BD1\u5668</code>\uFF0C\u628A\u6211\u4EEC\u7684\u4EE3\u7801\u8F6C\u6210\u6D4F\u89C8\u5668\u53EF\u4EE5\u8FD0\u884C\u7684\u4EE3\u7801</p><p><strong>\u4F5C\u7528</strong></p><p>babel \u4E3B\u8981\u7528\u4E8E\u5C06\u65B0\u7248\u672C\u7684\u4EE3\u7801\u8F6C\u6362\u4E3A\u5411\u540E\u517C\u5BB9\u7684 js \u8BED\u6CD5(<code>Polyfill</code> \u65B9\u5F0F)\uFF0C\u4EE5\u4FBF\u80FD\u591F\u8FD0\u884C\u5728\u5404\u7248\u672C\u7684\u6D4F\u89C8\u5668\u6216\u5176\u4ED6\u73AF\u5883\u4E2D</p><p><strong>\u57FA\u672C\u539F\u7406</strong></p><p>\u6838\u5FC3\u5C31\u662F <code>AST (\u62BD\u8C61\u8BED\u6CD5\u6811)</code></p><p>\u9996\u5148\u5C06\u6E90\u7801\u8F6C\u6210\u62BD\u8C61\u8BED\u6CD5\u6811\uFF0C\u7136\u540E\u5BF9\u8BED\u6CD5\u6811\u8FDB\u884C\u5904\u7406\u751F\u6210\u65B0\u7684\u8BED\u6CD5\u6811\uFF0C\u6700\u540E\u5C06\u65B0\u8BED\u6CD5\u6811\u751F\u6210\u65B0\u7684 JS \u4EE3\u7801</p><p><strong>Babel \u7684\u6D41\u7A0B</strong></p><p><strong>3 \u4E2A\u9636\u6BB5\uFF1A parsing (\u89E3\u6790)\u3001transforming (\u8F6C\u6362)\u3001generating (\u751F\u6210)</strong></p><p>1\uFF09\u901A\u8FC7<code>babylon</code>\u5C06 js \u8F6C\u5316\u6210 ast (\u62BD\u8C61\u8BED\u6CD5\u6811)</p><p>2\uFF09\u901A\u8FC7<code>babel-traverse</code>\u662F\u4E00\u4E2A\u5BF9 ast \u8FDB\u884C\u904D\u5386\uFF0C\u4F7F\u7528 babel \u63D2\u4EF6\u8F6C\u5316\u6210\u65B0\u7684 ast</p><p>3\uFF09\u901A\u8FC7<code>babel-generator</code>\u5C06 ast \u751F\u6210\u65B0\u7684 js \u4EE3\u7801</p><h4 id="\u914D\u7F6E\u548C\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u548C\u4F7F\u7528" aria-hidden="true">#</a> \u914D\u7F6E\u548C\u4F7F\u7528</h4><p><strong>1\uFF09\u5355\u4E2A\u8F6F\u4EF6\u5305\u5728 <code>.babelrc</code> \u4E2D\u914D\u7F6E</strong></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>.babelrc <span class="token punctuation">{</span>
  <span class="token comment">// \u9884\u8BBE: Babel \u5B98\u65B9\u505A\u4E86\u4E00\u4E9B\u9884\u8BBE\u7684\u63D2\u4EF6\u96C6\uFF0C\u79F0\u4E4B\u4E3A Preset\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u4F7F\u7528\u5BF9\u5E94\u7684 Preset \u5C31\u53EF\u4EE5\u4E86</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token comment">// babel\u548Cwebpack\u7C7B\u4F3C\uFF0C\u4E3B\u8981\u662F\u901A\u8FC7plugin\u63D2\u4EF6\u8FDB\u884C\u4EE3\u7801\u8F6C\u5316\u7684\uFF0C\u5982\u679C\u4E0D\u914D\u7F6E\u63D2\u4EF6\uFF0Cbabel\u4F1A\u5C06\u4EE3\u7801\u539F\u6837\u8FD4\u56DE</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2\uFF09vue \u4E2D\uFF0C\u5728 babel.config.js \u4E2D\u914D\u7F6E</strong></p><p>\u914D\u7F6E babel-plugin-component \u63D2\u4EF6\uFF0C\u6309\u9700\u5F15\u5165 elementUI</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
   presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@vue/app&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// \u914D\u7F6Ebabel-plugin-component\u63D2\u4EF6</span>
   plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
	  <span class="token string">&quot;component&quot;</span><span class="token punctuation">,</span>
	  <span class="token punctuation">{</span>
	    libraryName<span class="token operator">:</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
	    styleLibraryName<span class="token operator">:</span> <span class="token string">&quot;theme-chalk&quot;</span>
	<span class="token punctuation">}</span>
     <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3\uFF09\u914D\u7F6E<code>browserslist</code></strong></p><p><code>browserslist</code> \u7528\u6765\u63A7\u5236\u8981\u517C\u5BB9\u6D4F\u89C8\u5668\u7248\u672C\uFF0C\u914D\u7F6E\u7684\u8303\u56F4\u8D8A\u5177\u4F53\uFF0C\u5C31\u53EF\u4EE5\u66F4\u7CBE\u786E\u63A7\u5236<code>Polyfill</code>\u8F6C\u5316\u540E\u7684\u4F53\u79EF\u5927\u5C0F</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;browserslist&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
   <span class="token comment">// \u5168\u7403\u8D85\u8FC71%\u4EBA\u4F7F\u7528\u7684\u6D4F\u89C8\u5668</span>
   <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>
   <span class="token comment">//  \u6240\u6709\u6D4F\u89C8\u5668\u517C\u5BB9\u5230\u6700\u540E\u4E24\u4E2A\u7248\u672C\u6839\u636ECanIUse.com\u8FFD\u8E2A\u7684\u7248\u672C</span>
   <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">,</span>
   <span class="token comment">// chrome \u7248\u672C\u5927\u4E8E70</span>
   <span class="token string">&quot;chrome &gt;= 70&quot;</span>
   <span class="token comment">// \u6392\u9664\u90E8\u5206\u7248\u672C</span>
   <span class="token string">&quot;not ie &lt;= 8&quot;</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5982\u4F55\u5F00\u53D1\u4E00\u4E2A-babel-\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u5F00\u53D1\u4E00\u4E2A-babel-\u63D2\u4EF6" aria-hidden="true">#</a> \u5982\u4F55\u5F00\u53D1\u4E00\u4E2A babel \u63D2\u4EF6</h4><p><strong>Babel \u63D2\u4EF6\u7684\u4F5C\u7528</strong></p><p>Babel \u63D2\u4EF6\u62C5\u8D1F\u7740\u7F16\u8BD1\u8FC7\u7A0B\u4E2D\u7684\u6838\u5FC3\u4EFB\u52A1\uFF1A<code>\u8F6C\u6362 AST</code></p><p><strong>babel \u63D2\u4EF6\u7684\u57FA\u672C\u683C\u5F0F</strong></p><p>1\uFF09\u4E00\u4E2A\u51FD\u6570\uFF0C\u53C2\u6570\u662F babel\uFF0C\u7136\u540E\u5C31\u662F\u8FD4\u56DE\u4E00\u4E2A\u5BF9\u8C61\uFF0C<code>key\u662Fvisitor</code>\uFF0C\u7136\u540E\u91CC\u9762\u7684\u5BF9\u8C61\u662F\u4E00\u4E2A\u7BAD\u5934\u51FD\u6570</p><p>2\uFF09\u51FD\u6570\u6709\u4E24\u4E2A\u53C2\u6570\uFF0C<code>path</code>\u8868\u793A\u8DEF\u5F84\uFF0C<code>state</code>\u8868\u793A\u72B6\u6001</p><p>3\uFF09<code>CallExpression</code>\u5C31\u662F\u6211\u4EEC\u8981\u8BBF\u95EE\u7684\u8282\u70B9\uFF0Cpath \u53C2\u6570\u8868\u793A\u5F53\u524D\u8282\u70B9\u7684\u4F4D\u7F6E\uFF0C\u5305\u542B\u7684\u4E3B\u8981\u662F\u5F53\u524D<code>\u8282\u70B9\uFF08node\uFF09</code>\u5185\u5BB9\u4EE5\u53CA<code>\u7236\u8282\u70B9\uFF08parent\uFF09</code>\u5185\u5BB9</p><p><strong>\u63D2\u4EF6\u7684\u7B80\u5355\u683C\u5F0F\u793A\u4F8B</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">babel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> t <span class="token operator">=</span> babel<span class="token punctuation">.</span>type
   <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">visitor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">CallExression</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
           <span class="token keyword">do</span> soming
     <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E00\u4E2A\u6700\u7B80\u5355\u7684\u63D2\u4EF6: <code>\u5C06const a \u8F6C\u5316\u4E3Aconst b</code></strong></p><p>\u521B\u5EFA babelPluginAtoB.js</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">module.exports</span> <span class="token punctuation">=</span> <span class="token value attr-value">function(babel) {</span>
  <span class="token key attr-name">let t</span> <span class="token punctuation">=</span> <span class="token value attr-value">babel.types;</span>
  return {
    visitor: {
      VariableDeclarator(path, state) {
        // VariableDeclarator \u662F\u8981\u627E\u7684\u53D8\u91CF\u58F0\u660E
        <span class="token key attr-name">if (path.node.id.name</span> <span class="token punctuation">=</span><span class="token value attr-value">= &quot;a&quot;) {</span>
         // \u65B9\u5F0F\u4E00\uFF1A\u76F4\u63A5\u4FEE\u6539name
         <span class="token key attr-name">path.node.id.name</span> <span class="token punctuation">=</span> <span class="token value attr-value">&#39;b&#39;;</span>
         // \u65B9\u5F0F\u4E8C\uFF1A\u628Aid\u662Fa\u7684ast\u6362\u6210b\u7684ast
         <span class="token key attr-name">// path.node.id</span> <span class="token punctuation">=</span> <span class="token value attr-value">t.Identifier(&quot;b&quot;);</span>
        }
      }
    }
  };
};

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5728.babelrc \u4E2D\u5F15\u5165 babelPluginAtoB \u63D2\u4EF6</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">const babelPluginAtoB</span> <span class="token punctuation">=</span> <span class="token value attr-value">require(&#39;./babelPluginAtoB.js&#39;);</span>
{
    &quot;plugins&quot;: [
        <span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">babelPluginAtoB</span><span class="token punctuation">]</span></span>
    ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u7F16\u5199\u6D4B\u8BD5\u4EE3\u7801</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">let a</span> <span class="token punctuation">=</span> <span class="token value attr-value">1;</span>
console.log(b);
// babel\u63D2\u4EF6\u751F\u6548\uFF0C\u6CA1\u6709\u62A5\u9519\uFF0C\u6253\u5370 1

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,37),E={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2016%2F01%2Fbabel.html",target:"_blank",rel:"noopener noreferrer"},M={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.babeljs.cn%2Fdocs%2F",target:"_blank",rel:"noopener noreferrer"},z={href:"https://juejin.cn/post/6844904008679686152",target:"_blank",rel:"noopener noreferrer"},I={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F44c0075fd043",target:"_blank",rel:"noopener noreferrer"},O=e('<h3 id="gulp" tabindex="-1"><a class="header-anchor" href="#gulp" aria-hidden="true">#</a> Gulp</h3><p><code>gulp</code> \u662F\u57FA\u4E8E <code>node \u6D41</code> \u5B9E\u73B0\u7684\u524D\u7AEF\u81EA\u52A8\u5316\u5F00\u53D1\u7684\u5DE5\u5177</p><p><strong>\u9002\u7528\u573A\u666F</strong></p><p>\u5728\u524D\u7AEF\u5F00\u53D1\u5DE5\u4F5C\u4E2D\u6709\u5F88\u591A<code>\u201C\u91CD\u590D\u5DE5\u4F5C\u201D</code>\uFF0C\u6BD4\u5982<code>\u6279\u91CF\u5C06Scss\u6587\u4EF6\u7F16\u8BD1\u4E3ACSS\u6587\u4EF6</code></p><p><strong>\u8FD9\u91CC\u4E3B\u8981\u804A\u4E00\u4E0B\uFF0C\u5728\u5F00\u53D1\u7684\u7EC4\u4EF6\u5E93\u4E2D\u5982\u4F55\u4F7F\u7528 gulp</strong></p><h4 id="gulp-\u5728\u7EC4\u4EF6\u5E93\u4E2D\u7684\u8FD0\u7528" tabindex="-1"><a class="header-anchor" href="#gulp-\u5728\u7EC4\u4EF6\u5E93\u4E2D\u7684\u8FD0\u7528" aria-hidden="true">#</a> Gulp \u5728\u7EC4\u4EF6\u5E93\u4E2D\u7684\u8FD0\u7528</h4>',6),B=n("code",null,"elementUI",-1),H={href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FElemeFE%2Felement",target:"_blank",rel:"noopener noreferrer"},N=e(`<p>\u6253\u5F00<code>packages/theme-chalk/gulpfile.js</code></p><p><strong>\u8BE5\u6587\u4EF6\u7684\u4F5C\u7528\u662F\u5C06 scss \u6587\u4EF6\u7F16\u8BD1\u4E3A css \u6587\u4EF6</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// \u5F15\u5165gulp</span>
<span class="token comment">// series\u521B\u5EFA\u4EFB\u52A1\u5217\u8868\uFF0C</span>
<span class="token comment">// src\u521B\u5EFA\u4E00\u4E2A\u6D41\uFF0C\u8BFB\u53D6\u6587\u4EF6</span>
<span class="token comment">// dest \u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u5199\u5165\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u6D41</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> series<span class="token punctuation">,</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// gulp-dart-sass\u7F16\u8BD1scss\u6587\u4EF6</span>
<span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-dart-sass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// gulp-autoprefixer \u7ED9css\u6837\u5F0F\u6DFB\u52A0\u524D\u7F00</span>
<span class="token keyword">const</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-autoprefixer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// gulp-cssmin \u538B\u7F29css</span>
<span class="token keyword">const</span> cssmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-cssmin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5904\u7406src\u76EE\u5F55\u4E0B\u7684\u6240\u6709scss\u6587\u4EF6\uFF0C\u8F6C\u5316\u4E3Acss\u6587\u4EF6</span>
<span class="token keyword">function</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/*.scss&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sass<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> sass<span class="token punctuation">.</span>logError<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
        <span class="token comment">// \u7ED9css\u6837\u5F0F\u6DFB\u52A0\u524D\u7F00</span>
        <span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">overrideBrowserslist</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ie &gt; 9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cascade</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
      <span class="token comment">// \u538B\u7F29css</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token comment">// \u5C06\u7F16\u8BD1\u597D\u7684css \u8F93\u51FA\u5230lib\u76EE\u5F55\u4E0B</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5C06src/fonts\u6587\u4EF6\u7684\u5B57\u4F53\u6587\u4EF6 copy\u5230 /lib/fonts\u76EE\u5F55\u4E0B</span>
<span class="token keyword">function</span> <span class="token function">copyfont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/fonts/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib/fonts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// series\u521B\u5EFA\u4EFB\u52A1\u5217\u8868</span>
exports<span class="token punctuation">.</span>build <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>compile<span class="token punctuation">,</span> copyfont<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="gulp-\u7ED9-elementui-\u589E\u52A0\u4E00\u952E\u6362\u80A4\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#gulp-\u7ED9-elementui-\u589E\u52A0\u4E00\u952E\u6362\u80A4\u529F\u80FD" aria-hidden="true">#</a> Gulp \u7ED9 elementUI \u589E\u52A0\u4E00\u952E\u6362\u80A4\u529F\u80FD</h4><p><strong>\u603B\u4F53\u6D41\u7A0B</strong></p><p>1\uFF09\u4F7F\u7528<code>css var()</code>\u5B9A\u4E49\u989C\u8272\u53D8\u91CF</p><p>2\uFF09\u521B\u5EFA\u4E3B\u9898<code>theme.css</code>\u6587\u4EF6\uFF0C\u5B58\u50A8\u6240\u6709\u7684\u989C\u8272\u53D8\u91CF</p><p>3\uFF09\u4F7F\u7528<code>gulp</code>\u5C06<code>theme.css</code>\u5408\u5E76\u5230<code>base.css</code>\u4E2D\uFF0C\u89E3\u51B3\u6309\u9700\u5F15\u5165\u7684\u60C5\u51B5</p><p>4\uFF09\u4F7F\u7528<code>gulp</code>\u5C06<code>index.css</code>\u4E0E<code>base.css</code>\u5408\u5E76\uFF0C\u89E3\u51B3\u5168\u5C40\u5F15\u5165\u7684\u60C5\u51B5</p><p><strong>\u6B65\u9AA4\u4E00\uFF1A\u521B\u5EFA\u57FA\u7840\u989C\u8272\u53D8\u91CF<code>theme.css</code>\u6587\u4EF6</strong></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52a9c3cab0544603b4a7e5bf9ceb2c20~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="theme.jpg"></p><p><strong>\u6B65\u9AA4\u4E8C\uFF1A\u4FEE\u6539<code>packages/theme-chalk/src/common/var.scss</code>\u6587\u4EF6</strong></p><p><strong>\u5C06\u8BE5\u6587\u4EF6\u7684\u4E2D\u5B9A\u4E49\u7684 scss \u53D8\u91CF\uFF0C\u66FF\u6362\u6210 var()\u53D8\u91CF</strong></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f5f561727524921b52a52b181a6fbb0~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="var.jpg"></p><p><strong>\u6B65\u9AA4\u4E09\uFF1A\u4FEE\u6539\u540E\u7684<code>packages/theme-chalk/gulpfile.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> series<span class="token punctuation">,</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-dart-sass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-autoprefixer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cssmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-cssmin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> concat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-concat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/*.scss&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sass<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> sass<span class="token punctuation">.</span>logError<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">overrideBrowserslist</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ie &gt; 9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">cascade</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5C06 theme.css \u548C lib/base.css\u5408\u5E76\u6210 \u6700\u7EC8\u7684 base.css</span>
<span class="token keyword">function</span> <span class="token function">compile1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./src/theme.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./lib/base.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">&quot;base.css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5C06 base.css\u3001 index.css \u5408\u5E76\u6210 \u6700\u7EC8\u7684 index.css</span>
<span class="token keyword">function</span> <span class="token function">compile2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./lib/base.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./lib/index.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">&quot;index.css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">copyfont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/fonts/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./lib/fonts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span>build <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>compile<span class="token punctuation">,</span> compile1<span class="token punctuation">,</span> compile2<span class="token punctuation">,</span> copyfont<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16),R={href:"https://juejin.cn/post/7136936387181281311",target:"_blank",rel:"noopener noreferrer"},W=e(`<h2 id="\u811A\u624B\u67B6" tabindex="-1"><a class="header-anchor" href="#\u811A\u624B\u67B6" aria-hidden="true">#</a> \u811A\u624B\u67B6</h2><p>\u811A\u624B\u67B6\u662F\u5F00\u53D1\u4E2D\u7ECF\u5E38\u4F1A\u4F7F\u7528\u7684\u5DE5\u5177\uFF0C\u6BD4\u5982<code>vue-cli</code>\u3001<code>create-react-app</code>\u7B49\uFF0C\u8FD9\u4E9B\u811A\u624B\u67B6\u53EF\u4EE5\u901A\u8FC7\u7B80\u5355\u7684\u547D\u4EE4\uFF0C\u5FEB\u901F\u53BB\u642D\u5EFA\u9879\u76EE\uFF0C\u8BA9\u6211\u4EEC\u66F4\u4E13\u6CE8\u4E8E\u9879\u76EE\u7684\u5F00\u53D1</p><p>\u968F\u7740\u9879\u76EE\u7684\u589E\u591A\u3001\u4EBA\u5458\u7684\u6269\u5C55\uFF0C\u5927\u5BB6\u5F00\u53D1\u7684\u57FA\u7840\u7EC4\u4EF6\u548C\u516C\u5171\u65B9\u6CD5\u4E5F\u8D8A\u6765\u8D8A\u591A\uFF0C\u5E0C\u671B\u628A\u8FD9\u4E9B\u79EF\u7D2F\u6DFB\u52A0\u5230\u811A\u624B\u67B6\u4E2D\uFF0C\u5F53\u6210\u9879\u76EE\u6A21\u677F\u7559\u5B58\u4E0B\u6765</p><p>\u8FD9\u6837\u518D\u521B\u5EFA\u9879\u76EE\u65F6\uFF0C\u5C31\u4E0D\u7528\u6BCF\u6B21\u53BB\u5176\u4ED6\u9879\u76EE\u4E2D\u6765\u56DE copy</p><h3 id="\u624B\u5199\u4E00\u4E2A-mini-\u7248\u7684\u811A\u624B\u67B6" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199\u4E00\u4E2A-mini-\u7248\u7684\u811A\u624B\u67B6" aria-hidden="true">#</a> \u624B\u5199\u4E00\u4E2A mini \u7248\u7684\u811A\u624B\u67B6</h3><p>\u4E0B\u9762\u6211\u4EEC\u4E00\u8D77\uFF0C\u624B\u5199\u4E00\u4E2A mini \u7248\u7684\u811A\u624B\u67B6</p><p>\u901A\u8FC7\u8FD9\u4E2A\u6848\u4F8B\u6765\u4E86\u89E3\u811A\u624B\u67B6\u7684\u5DE5\u4F5C\u6D41\u7A0B\uFF0C\u4EE5\u53CA\u4F7F\u7528\u4E86\u54EA\u4E9B\u5E38\u7528\u5DE5\u5177</p><p>\u65B0\u5EFA\u6587\u4EF6\u5939<code>my-build-cli</code>\uFF0C\u6267\u884C<code>npm init -y</code></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6e8c8fb28d445afb79e914ab8edfe67~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="init-y.png"></p><h3 id="\u914D\u7F6E\u811A\u624B\u67B6\u5165\u53E3\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u811A\u624B\u67B6\u5165\u53E3\u6587\u4EF6" aria-hidden="true">#</a> \u914D\u7F6E\u811A\u624B\u67B6\u5165\u53E3\u6587\u4EF6</h3><p><strong>1\uFF09\u521B\u5EFA<code>bin</code>\u76EE\u5F55\uFF0C\u8BE5\u76EE\u5F55\u4E0B\u521B\u5EFA<code>www.js</code></strong></p><p><strong><code>bin/www.js</code> \u5185\u5BB9</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token hashbang comment">#! /usr/bin/env node</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;link \u6210\u529F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>\u6CE8\uFF1A<code>/usr/bin/env node</code> \u8FD9\u884C\u7684\u610F\u601D\u662F\u4F7F\u7528 node \u6765\u6267\u884C\u6B64\u6587\u4EF6</em></p><p><strong>2\uFF09<code>package.json</code>\u4E2D\u914D\u7F6E\u5165\u53E3\u6587\u4EF6\u7684\u8DEF\u5F84</strong></p><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token punctuation">{</span>
  <span class="token string-literal"><span class="token string">&quot;name&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;my-build-cli&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;version&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;1.0.0&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;description&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;bin&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;./bin/www.js&quot;</span></span><span class="token punctuation">,</span> <span class="token comment">// \u624B\u52A8\u6DFB\u52A0\u5165\u53E3\u6587\u4EF6\u4E3A ./bin/www.js</span>
  <span class="token string-literal"><span class="token string">&quot;scripts&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string-literal"><span class="token string">&quot;test&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;keywords&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;author&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;license&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;ISC&quot;</span></span>
<span class="token punctuation">}</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3\uFF09\u9879\u76EE\u76EE\u5F55\u7ED3\u6784</strong></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>my<span class="token operator">-</span>build<span class="token operator">-</span>cli
\u251C\u2500 bin
\u2502  \u2514\u2500 www<span class="token punctuation">.</span>js
\u2514\u2500 <span class="token keyword">package</span><span class="token punctuation">.</span>json

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="npm-link-\u5230\u5168\u5C40" tabindex="-1"><a class="header-anchor" href="#npm-link-\u5230\u5168\u5C40" aria-hidden="true">#</a> npm link \u5230\u5168\u5C40</h3><p>\u5728\u63A7\u5236\u53F0\u8F93\u5165<code>npm link</code></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3e341c830934ef9b3dcbf3753ea8561~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="link.jpg"></p><p>\u6D4B\u8BD5\u662F\u5426\u8FDE\u63A5\u6210\u529F</p><p>\u5728\u63A7\u5236\u53F0\u8F93\u5165<code>my-build-cli</code></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3cb3c167e8c14d17a71f9bd31bd4c23d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="linksuccess.jpg"></p><p>\u5728\u63A7\u5236\u53F0\u8F93\u51FA<code>link \u6210\u529F</code>, \u9879\u76EE\u914D\u7F6E\u6210\u529F</p><h3 id="\u5B89\u88C5\u811A\u624B\u67B6\u6240\u9700\u7684\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u811A\u624B\u67B6\u6240\u9700\u7684\u5DE5\u5177" aria-hidden="true">#</a> \u5B89\u88C5\u811A\u624B\u67B6\u6240\u9700\u7684\u5DE5\u5177</h3><p>\u4E00\u6B21\u6027\u5B89\u88C5\u6240\u9700\u7684\u5DE5\u5177</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm install commander inquirer download-git-repo util ora fs-extra axios
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>\u5DE5\u5177\u540D\u79F0</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td>commander</td><td>\u81EA\u5B9A\u4E49\u547D\u4EE4\u884C\u5DE5\u5177</td></tr><tr><td>inquirer</td><td>\u547D\u4EE4\u884C\u4EA4\u4E92\u5DE5\u5177</td></tr><tr><td>download-git-repo</td><td>\u4ECE git \u4E0A\u4E0B\u8F7D\u9879\u76EE\u6A21\u677F\u5DE5\u5177</td></tr><tr><td>util</td><td>download-git-repo \u4E0D\u652F\u6301\u5F02\u6B65\u8C03\u7528\uFF0C\u9700\u8981\u4F7F\u7528 util \u63D2\u4EF6\u7684<code>util.promisify</code>\u8FDB\u884C\u8F6C\u6362</td></tr><tr><td>ora</td><td>\u547D\u4EE4\u884C loading \u52A8\u6548</td></tr><tr><td>fs-extra</td><td>\u63D0\u4F9B\u6587\u4EF6\u64CD\u4F5C\u65B9\u6CD5</td></tr><tr><td>axios</td><td>\u53D1\u9001\u63A5\u53E3\uFF0C\u8BF7\u6C42 git \u4E0A\u7684\u6A21\u677F\u5217\u8868</td></tr></tbody></table><h3 id="commander-\u81EA\u5B9A\u4E49\u547D\u4EE4\u884C\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#commander-\u81EA\u5B9A\u4E49\u547D\u4EE4\u884C\u5DE5\u5177" aria-hidden="true">#</a> commander \u81EA\u5B9A\u4E49\u547D\u4EE4\u884C\u5DE5\u5177</h3><p><code>commander.js</code> \u662F\u81EA\u5B9A\u4E49\u547D\u4EE4\u884C\u5DE5\u5177</p><p>\u8FD9\u91CC\u7528\u6765<strong>\u521B\u5EFA<code>create</code> \u547D\u4EE4</strong>\uFF0C\u7528\u6237\u53EF\u4EE5\u901A\u8FC7\u8F93\u5165 <code>my-cli creat appName</code> \u6765\u521B\u5EFA\u9879\u76EE</p><p><strong>\u4FEE\u6539<code>www.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token hashbang comment">#! /usr/bin/env node</span>

<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;commander&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

program
  <span class="token comment">// \u521B\u5EFAcreate \u547D\u4EE4\uFF0C\u7528\u6237\u53EF\u4EE5\u901A\u8FC7 my-cli creat appName \u6765\u521B\u5EFA\u9879\u76EE</span>
  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;create &lt;app-name&gt;&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// \u547D\u540D\u7684\u63CF\u8FF0</span>
  <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;create a new project&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// create\u547D\u4EE4\u7684\u9009\u9879</span>
  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-f, --force&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;overwrite target if it exist&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u6267\u884C&#39;./create.js&#39;\uFF0C\u4F20\u5165\u9879\u76EE\u540D\u79F0\u548C \u7528\u6237\u9009\u9879</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./create&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

program<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="inquirer-\u547D\u4EE4\u884C\u4EA4\u4E92\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#inquirer-\u547D\u4EE4\u884C\u4EA4\u4E92\u5DE5\u5177" aria-hidden="true">#</a> inquirer \u547D\u4EE4\u884C\u4EA4\u4E92\u5DE5\u5177</h3><p><code>inquirer.js</code> \u547D\u4EE4\u884C\u4EA4\u4E92\u5DE5\u5177\uFF0C\u7528\u6765\u8BE2\u95EE\u7528\u6237\u7684\u64CD\u4F5C\uFF0C\u8BA9\u7528\u6237\u8F93\u5165\u6307\u5B9A\u7684\u4FE1\u606F\uFF0C\u6216\u7ED9\u51FA\u5BF9\u5E94\u7684\u9009\u9879\u8BA9\u7528\u6237\u9009\u62E9</p><p><strong>\u6B64\u5904 inquirer \u7684\u8FD0\u7528\u573A\u666F\u6709 2 \u4E2A</strong></p><p>1\uFF09\u573A\u666F 1\uFF1A\u5F53\u7528\u6237\u8981\u521B\u5EFA\u7684\u9879\u76EE\u76EE\u5F55\u5DF2\u5B58\u5728\u65F6\uFF0C\u63D0\u793A\u7528\u6237\u662F\u5426\u8981\u8986\u76D6 or \u53D6\u6D88</p><p>2\uFF09\u573A\u666F 2\uFF1A\u8BA9\u7528\u6237\u8F93\u5165\u9879\u76EE\u7684<code>author</code>\u4F5C\u8005\u548C\u9879\u76EE<code>description</code>\u63CF\u8FF0</p><h3 id="\u521B\u5EFAcreate-js" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAcreate-js" aria-hidden="true">#</a> \u521B\u5EFA<code>create.js</code></h3><p><strong><code>bin/create.js</code></strong></p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">fs</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;fs-extra&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">inquirer</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;inquirer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">Generator</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;./generator&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token operator">.</span>exports <span class="token operator">=</span> async <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// process.cwd\u83B7\u53D6\u5F53\u524D\u7684\u5DE5\u4F5C\u76EE\u5F55</span>
  <span class="token keyword">const</span> <span class="token constant">cwd</span> <span class="token operator">=</span> process<span class="token operator">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// path.join\u62FC\u63A5 \u8981\u521B\u5EFA\u9879\u76EE\u7684\u76EE\u5F55</span>
  <span class="token keyword">const</span> <span class="token constant">targetAir</span> <span class="token operator">=</span> path<span class="token operator">.</span><span class="token function">join</span><span class="token punctuation">(</span>cwd<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5982\u679C\u8BE5\u76EE\u5F55\u5DF2\u5B58\u5728</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token operator">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>targetAir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5F3A\u5236\u5220\u9664</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token operator">.</span>force<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      await fs<span class="token operator">.</span><span class="token function">remove</span><span class="token punctuation">(</span>targetAir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u901A\u8FC7inquirer\uFF1A\u8BE2\u95EE\u7528\u6237\u662F\u5426\u786E\u5B9A\u8981\u8986\u76D6 or \u53D6\u6D88</span>
      let <span class="token punctuation">{</span> action <span class="token punctuation">}</span> <span class="token operator">=</span> await inquirer<span class="token operator">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;action&#39;</span><span class="token punctuation">,</span>
          <span class="token argument-name">type</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;list&#39;</span><span class="token punctuation">,</span>
          <span class="token argument-name">message</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;Target already exists&#39;</span><span class="token punctuation">,</span>
          <span class="token argument-name">choices</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;overwrite&#39;</span><span class="token punctuation">,</span>
              <span class="token argument-name">value</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;overwrite&#39;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;cancel&#39;</span><span class="token punctuation">,</span>
              <span class="token argument-name">value</span><span class="token punctuation">:</span> <span class="token constant boolean">false</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5220\u9664\u6587\u4EF6\u5939</span>
        await fs<span class="token operator">.</span><span class="token function">remove</span><span class="token punctuation">(</span>targetAir<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token constant">args</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;./ask&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u901A\u8FC7inquirer\uFF0C\u8BA9\u7528\u6237\u8F93\u5165\u7684\u9879\u76EE\u5185\u5BB9\uFF1A\u4F5C\u8005\u548C\u63CF\u8FF0</span>
  <span class="token keyword">const</span> <span class="token constant">ask</span> <span class="token operator">=</span> await inquirer<span class="token operator">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u521B\u5EFA\u9879\u76EE</span>
  <span class="token keyword">const</span> <span class="token constant">generator</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> targetAir<span class="token punctuation">,</span> ask<span class="token punctuation">)</span><span class="token punctuation">;</span>
  generator<span class="token operator">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFAask-js" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAask-js" aria-hidden="true">#</a> \u521B\u5EFA<code>ask.js</code></h3><p>\u914D\u7F6E <code>ask</code> \u9009\u9879\uFF0C\u8BA9\u7528\u6237\u8F93\u5165\u4F5C\u8005\u548C\u9879\u76EE\u63CF\u8FF0</p><p><strong><code>bin/create.js</code></strong></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u914D\u7F6Eask \u9009\u9879</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token char">&#39;input&#39;</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token char">&#39;author&#39;</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token char">&#39;author?&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token char">&#39;input&#39;</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> &#39;description&#39;<span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> &#39;description?&#39;
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFAgenerator-js" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAgenerator-js" aria-hidden="true">#</a> \u521B\u5EFA<code>generator.js</code></h3><p><strong><code>generator.js</code>\u7684\u5DE5\u4F5C\u6D41\u7A0B</strong></p><p>1\uFF09\u901A\u8FC7\u63A5\u53E3\u83B7\u53D6<code>git</code>\u4E0A\u7684\u6A21\u677F\u76EE\u5F55</p><p>2\uFF09\u901A\u8FC7<code>inquirer</code>\u8BA9\u7528\u6237\u9009\u62E9\u9700\u8981\u4E0B\u8F7D\u7684\u9879\u76EE</p><p>3\uFF09\u4F7F\u7528<code>download-git-repo</code>\u4E0B\u8F7D\u7528\u6237\u9009\u62E9\u7684\u9879\u76EE\u6A21\u677F</p><p>4\uFF09\u5C06\u7528\u6237\u521B\u5EFA\u65F6\uFF0C\u5C06<code>\u9879\u76EE\u540D\u79F0\u3001\u4F5C\u8005\u540D\u5B57\u3001\u63CF\u8FF0</code>\u5199\u5165\u5230\u9879\u76EE\u6A21\u677F\u7684<code>package.json</code>\u6587\u4EF6\u4E2D</p><p><strong><code>bin/generator.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs-extra&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u5F15\u5165ora\u5DE5\u5177\uFF1A\u547D\u4EE4\u884Cloading \u52A8\u6548</span>
<span class="token keyword">const</span> ora <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ora&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;inquirer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u5F15\u5165download-git-repo\u5DE5\u5177</span>
<span class="token keyword">const</span> downloadGitRepo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;download-git-repo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// download-git-repo \u9ED8\u8BA4\u4E0D\u652F\u6301\u5F02\u6B65\u8C03\u7528\uFF0C\u9700\u8981\u4F7F\u7528util\u63D2\u4EF6\u7684util.promisify \u8FDB\u884C\u8F6C\u6362</span>
<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;util&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u83B7\u53D6git\u9879\u76EE\u5217\u8868</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> getRepolist <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">wrapLoading</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> spinner <span class="token operator">=</span> <span class="token function">ora</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u4E0B\u8F7D\u5F00\u59CB</span>
  spinner<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u4E0B\u8F7D\u6210\u529F</span>
    spinner<span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4E0B\u8F7D\u5931\u8D25</span>
    spinner<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">&quot;Request failed \u2026\u2026&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u521B\u5EFA\u9879\u76EE\u7C7B</span>
<span class="token keyword">class</span> <span class="token class-name">Generator</span> <span class="token punctuation">{</span>
  <span class="token comment">// name \u9879\u76EE\u540D\u79F0</span>
  <span class="token comment">// target \u521B\u5EFA\u9879\u76EE\u7684\u8DEF\u5F84</span>
  <span class="token comment">// \u7528\u6237\u8F93\u5165\u7684 \u4F5C\u8005\u548C\u9879\u76EE\u63CF\u8FF0 \u4FE1\u606F</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> target<span class="token punctuation">,</span> ask</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ask <span class="token operator">=</span> ask<span class="token punctuation">;</span>
    <span class="token comment">// download-git-repo \u9ED8\u8BA4\u4E0D\u652F\u6301\u5F02\u6B65\u8C03\u7528\uFF0C\u9700\u8981\u4F7F\u7528util\u63D2\u4EF6\u7684util.promisify \u8FDB\u884C\u8F6C\u6362</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>downloadGitRepo <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span>downloadGitRepo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">getRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u83B7\u53D6git\u4ED3\u5E93\u7684\u9879\u76EE\u5217\u8868</span>
    <span class="token keyword">const</span> repolist <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">wrapLoading</span><span class="token punctuation">(</span>getRepolist<span class="token punctuation">,</span> <span class="token string">&quot;waiting fetch template&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>repolist<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> repos <span class="token operator">=</span> repolist<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u901A\u8FC7inquirer \u8BA9\u7528\u6237\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u9879\u76EE\u6A21\u677F</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> repo <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;repo&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">choices</span><span class="token operator">:</span> repos<span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;Please choose a template&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> repo<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// \u4E0B\u8F7D\u7528\u6237\u9009\u62E9\u7684\u9879\u76EE\u6A21\u677F</span>
  <span class="token keyword">async</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token parameter">repo<span class="token punctuation">,</span> tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> requestUrl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">yuan-cli/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>repo<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">wrapLoading</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>downloadGitRepo<span class="token punctuation">,</span>
      <span class="token string">&quot;waiting download template&quot;</span><span class="token punctuation">,</span>
      requestUrl<span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// \u6587\u4EF6\u5165\u53E3\uFF0C\u5728create.js\u4E2D \u6267\u884Cgenerator.create();</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> repo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\u7528\u6237\u9009\u62E9\u4E86&quot;</span><span class="token punctuation">,</span> repo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u4E0B\u8F7D\u7528\u6237\u9009\u62E9\u7684\u9879\u76EE\u6A21\u677F</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>repo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u4E0B\u8F7D\u5B8C\u6210\u540E\uFF0C\u83B7\u53D6\u9879\u76EE\u91CC\u7684package.json</span>
    <span class="token comment">// \u5C06\u7528\u6237\u521B\u5EFA\u9879\u76EE\u7684\u586B\u5199\u7684\u4FE1\u606F\uFF08\u9879\u76EE\u540D\u79F0\u3001\u4F5C\u8005\u540D\u5B57\u3001\u63CF\u8FF0\uFF09\uFF0C\u5199\u5165\u5230package.json\u4E2D</span>
    <span class="token keyword">let</span> targetPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> jsonPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">,</span> <span class="token string">&quot;package.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>jsonPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u8BFB\u53D6\u5DF2\u4E0B\u8F7D\u6A21\u677F\u4E2Dpackage.json\u7684\u5185\u5BB9</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>jsonPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> json <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      json<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
      <span class="token comment">// \u8BA9\u7528\u6237\u8F93\u5165\u7684\u5185\u5BB9 \u66FF\u6362\u5230 package.json\u4E2D\u5BF9\u5E94\u7684\u5B57\u6BB5</span>
      Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ask<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        json<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ask<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//\u4FEE\u6539\u9879\u76EE\u6587\u4EF6\u5939\u4E2D package.json \u6587\u4EF6</span>
      fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>jsonPath<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;\\t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Generator<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFAhttp-js" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAhttp-js" aria-hidden="true">#</a> \u521B\u5EFA<code>http.js</code></h3><p>\u7528\u6765\u53D1\u9001\u63A5\u53E3\uFF0C\u83B7\u53D6 git \u4E0A\u7684\u6A21\u677F\u5217\u8868</p><p><strong><code>bin/http.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F15\u5165axios</span>
<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;axios&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u83B7\u53D6git\u4E0A\u7684\u9879\u76EE\u5217\u8868</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getRepolist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.github.com/orgs/yuan-cli/repos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  getRepolist<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6700\u7EC8\u7684\u76EE\u5F55\u7ED3\u6784</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a8ff4881ac046b699a36e3a82dec587~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="list.jpg"></p><h3 id="\u811A\u624B\u67B6\u6548\u679C\u6F14\u793A" tabindex="-1"><a class="header-anchor" href="#\u811A\u624B\u67B6\u6548\u679C\u6F14\u793A" aria-hidden="true">#</a> \u811A\u624B\u67B6\u6548\u679C\u6F14\u793A</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0deadf8fdff741fba443bb51f439b944~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="text8.gif"></p><h3 id="\u811A\u624B\u67B6\u53D1\u5E03\u5230-npm-\u5E93" tabindex="-1"><a class="header-anchor" href="#\u811A\u624B\u67B6\u53D1\u5E03\u5230-npm-\u5E93" aria-hidden="true">#</a> \u811A\u624B\u67B6\u53D1\u5E03\u5230 npm \u5E93</h3><p><strong>\u5B8C\u5584 package.json</strong></p><p>1\uFF09\u914D\u7F6E<code>main</code>\u5C5E\u6027\uFF0C\u6307\u5B9A\u5305\u7684\u5165\u53E3 <code>&quot;main&quot;: &quot;./bin/www.js&quot;</code></p><p>2\uFF09\u589E\u52A0<code>files</code>\u5C5E\u6027\uFF0Cfiles \u7528\u6765\u63CF\u8FF0\u5F53\u628A npm \u5305\uFF0C\u4F5C\u4E3A\u4F9D\u8D56\u5305\u5B89\u88C5\u7684\u6587\u4EF6\u5217\u8868\u3002\u5F53 npm \u5305\u53D1\u5E03\u65F6\uFF0Cfiles \u6307\u5B9A\u7684\u6587\u4EF6\u4F1A\u88AB\u63A8\u9001\u5230 npm \u670D\u52A1\u5668\u4E2D</p><p>3\uFF09\u589E\u52A0<code>description</code>\u3001<code>keywords</code>\u7B49\u63CF\u8FF0\u5B57\u6BB5</p><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token punctuation">{</span>
  <span class="token string-literal"><span class="token string">&quot;name&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;my-2022-cli&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;version&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;1.1.0&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;description&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;\u4E00\u4E2Amini\u7248\u7684\u811A\u624B\u67B6&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;main&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;./bin/www.js&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;bin&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;./bin/www.js&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;scripts&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string-literal"><span class="token string">&quot;test&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;files&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string-literal"><span class="token string">&quot;bin&quot;</span></span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;keywords&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string-literal"><span class="token string">&quot;my-yuan-cli&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;\u81EA\u5B9A\u4E49\u811A\u624B\u67B6&quot;</span></span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;author&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;\u6D77\u9614\u5929\u7A7A&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;license&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;ISC&quot;</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">&quot;dependencies&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string-literal"><span class="token string">&quot;axios&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^0.24.0&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;commander&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^8.3.0&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;download-git-repo&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^3.0.2&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;fs-extra&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^10.0.0&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;inquirer&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^8.2.0&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;ora&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^5.4.1&quot;</span></span><span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">&quot;util&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;^0.12.4&quot;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u589E\u52A0 README.md \u8BF4\u660E\u6587\u6863</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## my-2022-cli</span>

\u4E00\u4E2A mini \u7248\u7684\u81EA\u5B9A\u4E49\u811A\u624B\u67B6

<span class="token comment">### \u5B89\u88C5</span>

<span class="token function">npm</span> <span class="token function">install</span> my-2022-cli <span class="token parameter variable">-g</span>

<span class="token comment">### \u4F7F\u7528\u8BF4\u660E</span>

<span class="token number">1</span>\uFF09\u901A\u8FC7 my-2022-cli create appName \u521B\u5EFA\u9879\u76EE

<span class="token number">2</span>\uFF09author? \u8F93\u5165\u9879\u76EE\u4F5C\u8005

<span class="token number">3</span>\uFF09description? \u8F93\u5165\u9879\u76EE\u63CF\u8FF0

<span class="token number">4</span>\uFF09\u9009\u62E9\u9879\u76EE\u6A21\u5757 appDemo or pcDemo

<span class="token number">5</span>\uFF09\u5B89\u88C5\u9009\u62E9\u7684\u6A21\u677F

<span class="token comment">### \u6F14\u793A\u793A\u4F8B</span>

<span class="token operator">!</span><span class="token punctuation">[</span>Image text<span class="token punctuation">]</span><span class="token punctuation">(</span>https://wx1.sinaimg.cn/mw2000/927e36bfgy1h69k6ee9z1g20rs0jfwit.gif<span class="token punctuation">)</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u53D1\u5E03\u6210\u529F\u540E\uFF0C\u5728 npm \u7F51\u7AD9\u641C\u7D22<code>my-2022-cli</code></strong></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66b9c13e0604448b852dd896959659db~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="my-2022-cli.jpg"></p>`,72),V={href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fxy-sea%2Fblog%2Ftree%2Fdev%2Fmy-build-cli",target:"_blank",rel:"noopener noreferrer"},J={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fmy-2022-cli",target:"_blank",rel:"noopener noreferrer"},G=e(`<h2 id="\u6027\u80FD\u5206\u6790\u4E0E\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#\u6027\u80FD\u5206\u6790\u4E0E\u4F18\u5316" aria-hidden="true">#</a> \u6027\u80FD\u5206\u6790\u4E0E\u4F18\u5316</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u4E00\u767E\u7528\u6237\u4E0E\u4E00\u767E\u4E07\u7528\u6237\u7684\u7F51\u7AD9\u6709\u7740\u672C\u8D28\u533A\u522B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u968F\u7740\u7528\u6237\u7684\u589E\u957F\uFF0C\u4EFB\u4F55\u7EC6\u8282\u7684\u4F18\u5316\u90FD\u53D8\u5F97\u66F4\u4E3A\u91CD\u8981\uFF0C\u7F51\u7AD9\u7684\u6027\u80FD\u5DEE\u5F02\u76F4\u63A5\u5F71\u54CD\u7740\u7528\u6237\u7684\u4F53\u9A8C</p><p>\u8BD5\u60F3\uFF0C\u5982\u679C\u6211\u4EEC\u5728\u7F51\u4E0A\u8D2D\u7269\uFF0C\u5546\u57CE\u9875\u9762\u597D\u51E0\u79D2\u624D\u6253\u5F00\uFF0C\u6216\u56FE\u7247\u52A0\u8F7D\u4E0D\u51FA\u6765\uFF0C\u8D2D\u7269\u7684\u6B32\u671B\u77AC\u95F4\u6D88\u51CF\uFF0C\u62AC\u624B\u5C31\u53BB\u5176\u4ED6\u7ADE\u54C1\u5E73\u53F0\u4E86</p><p>\u6211\u66FE\u7ECF\u8D1F\u8D23\u8FC7\u51E0\u4E2A\u5927\u578B\u9879\u76EE\u7684\u6574\u4F53\u6027\u80FD\u4F18\u5316\uFF0C\u5C3D\u91CF\u4ECE\u5B9E\u6218\u7684\u89D2\u5EA6\u804A\u4E00\u804A\u81EA\u5DF1\u6240\u7406\u89E3\u7684\u6027\u80FD\u95EE\u9898</p><p><strong>\u6027\u80FD\u5206\u6790\u5DE5\u5177</strong></p><p>\u597D\u6BD4\u53BB\u533B\u9662\u770B\u75C5\u4E00\u6837\uFF0C\u5F97\u4E86\u4EC0\u4E48\u75C5\uFF0C\u901A\u8FC7\u68C0\u6D4B\u5316\u9A8C\u540E\u624D\u77E5\u9053\u3002\u7F51\u7AD9\u4E5F\u662F\u4E00\u6837\uFF0C\u9700\u8981\u501F\u52A9\u6027\u80FD\u5206\u6790\u5DE5\u5177\u6765\u68C0\u6D4B</p><h3 id="lighthouse-\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#lighthouse-\u5DE5\u5177" aria-hidden="true">#</a> Lighthouse \u5DE5\u5177</h3><p><code>Lighthouse</code>\u662F Chrome \u81EA\u5E26\u7684\u6027\u80FD\u5206\u6790\u5DE5\u5177\uFF0C\u5B83\u80FD\u591F\u751F\u6210\u4E00\u4E2A\u6709\u5173\u9875\u9762\u6027\u80FD\u7684\u62A5\u544A</p><p>\u901A\u8FC7\u62A5\u544A\u6211\u4EEC\u53EF\u4EE5\u77E5\u9053\u9700\u8981\u91C7\u53D6\u54EA\u4E9B\u63AA\u65BD\uFF0C\u6765\u6539\u8FDB\u5E94\u7528\u7684\u6027\u80FD\u548C\u4F53\u9A8C</p><p>\u5E76\u4E14 Lighthouse \u53EF\u4EE5\u5BF9\u9875\u9762\u591A\u65B9\u9762\u7684\u6548\u679C\u6307\u6807\u8FDB\u884C\u8BC4\u6D4B\uFF0C\u5E76\u7ED9\u51FA\u6700\u4F73\u5B9E\u8DF5\u7684\u5EFA\u8BAE\uFF0C\u4EE5\u5E2E\u52A9\u5F00\u53D1\u8005\u6539\u8FDB\u7F51\u7AD9\u7684\u8D28\u91CF</p><h4 id="lighthouse-\u62FF\u5230\u9875\u9762\u7684-\u75C5\u60C5-\u62A5\u544A" tabindex="-1"><a class="header-anchor" href="#lighthouse-\u62FF\u5230\u9875\u9762\u7684-\u75C5\u60C5-\u62A5\u544A" aria-hidden="true">#</a> Lighthouse \u62FF\u5230\u9875\u9762\u7684\u201C\u75C5\u60C5\u201D\u62A5\u544A</h4><p>\u901A\u8FC7 Lighthouse \u62FF\u5230\u7F51\u7AD9\u7684\u6574\u4F53\u5206\u6790\u62A5\u544A\uFF0C\u901A\u8FC7\u62A5\u544A\u6765\u8BCA\u65AD\u201C\u75C5\u60C5\u201D</p>`,13),U={href:"https://juejin.cn/",target:"_blank",rel:"noopener noreferrer"},$=n("code",null,"Lighthouse",-1),Y=n("code",null,"Generate report",-1),K=e(`<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a45f99f0e13343949f3e611f5e7b625d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="Lighthouse.jpg"></p><p><strong>Lighthouse \u80FD\u591F\u751F\u6210\u4E00\u4EFD\u8BE5\u7F51\u7AD9\u7684\u62A5\u544A\uFF0C\u6BD4\u5982\u4E0B\u56FE\uFF1A</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2257a3245dc401e8f5b7e2430007c41~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="performance.jpg"></p><p><strong>\u8FD9\u91CC\u91CD\u70B9\u5173\u6CE8<code>Performance\u6027\u80FD\u8BC4\u5206</code></strong></p><p>\u6027\u80FD\u8BC4\u5206\u7684\u5206\u503C\u533A\u95F4\u662F 0 \u5230 100\uFF0C\u5982\u679C\u51FA\u73B0 0 \u5206\uFF0C\u901A\u5E38\u662F\u5728\u8FD0\u884C Lighthouse \u65F6\u53D1\u751F\u4E86\u9519\u8BEF\uFF0C\u6EE1\u5206 100 \u5206\u4EE3\u8868\u4E86\u7F51\u7AD9\u5DF2\u7ECF\u8FBE\u5230\u4E86 98 \u5206\u4F4D\u503C\u7684\u6570\u636E\uFF0C\u800C 50 \u5206\u5219\u5BF9\u5E94 75 \u5206\u4F4D\u503C\u7684\u6570\u636E</p><p>\u5C0F\u4F19\u4F34\u770B\u770B\u81EA\u5DF1\u5F00\u53D1\u7684\u9879\u76EE\u5F97\u5206\u662F\u591A\u5C11\uFF0C\u5904\u4E8E\u4EC0\u4E48\u6837\u7684\u6C34\u5E73</p><h4 id="lighthouse-\u7ED9\u51FA-opportunities-\u4F18\u5316\u5EFA\u8BAE" tabindex="-1"><a class="header-anchor" href="#lighthouse-\u7ED9\u51FA-opportunities-\u4F18\u5316\u5EFA\u8BAE" aria-hidden="true">#</a> Lighthouse \u7ED9\u51FA Opportunities \u4F18\u5316\u5EFA\u8BAE</h4><p>Lighthouse \u4F1A\u9488\u5BF9\u5F53\u524D\u7F51\u7AD9\uFF0C\u7ED9\u51FA\u4E00\u4E9B<code>Opportunities</code>\u4F18\u5316\u5EFA\u8BAE</p><p><strong>Opportunities \u6307\u7684\u662F\u4F18\u5316\u673A\u4F1A\uFF0C\u5B83\u63D0\u4F9B\u4E86\u8BE6\u7EC6\u7684\u5EFA\u8BAE\u548C\u6587\u6863\uFF0C\u6765\u89E3\u91CA\u4F4E\u5206\u7684\u539F\u56E0\uFF0C\u5E2E\u52A9\u6211\u4EEC\u5177\u4F53\u8FDB\u884C\u5B9E\u73B0\u548C\u6539\u8FDB</strong></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7de10b4870824a61b81780cf46ed1a02~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="opportunity.jpg"></p><p>\u4E3E\u4E00\u4E2A\u6211\u66FE\u5F00\u53D1\u8FC7\u7684\u4E00\u4E2A\u9879\u76EE\uFF0C\u4EE5\u4E0B\u662F</p><p><strong>Opportunities \u7ED9\u51FA\u4F18\u5316\u5EFA\u8BAE\u5217\u8868</strong></p><table><thead><tr><th>\u95EE\u9898</th><th>\u5EFA\u8BAE</th></tr></thead><tbody><tr><td>Remove unused JavaScript</td><td>\u53BB\u6389\u65E0\u7528 js \u4EE3\u7801</td></tr><tr><td>Preload key requests</td><td>\u9996\u9875\u8D44\u6E90 preload \u9884\u52A0\u8F7D</td></tr><tr><td>Remove unused CSS</td><td>\u53BB\u6389\u65E0\u7528 css \u4EE3\u7801</td></tr><tr><td>Serve images in next-gen formats</td><td>\u4F7F\u7528\u65B0\u7684\u56FE\u7247\u683C\u5F0F\uFF0C\u6BD4\u5982 webp \u76F8\u5BF9 png jpg \u683C\u5F0F\u4F53\u79EF\u66F4\u5C0F</td></tr><tr><td>Efficiently encode images</td><td>\u6BD4\u5982\u538B\u7F29\u56FE\u7247\u5927\u5C0F</td></tr><tr><td>Preconnect to required origins</td><td>\u4F7F\u7528 preconnect or dns-prefetch DNS \u9884\u89E3\u6790</td></tr></tbody></table><h4 id="lighthouse-\u7ED9\u51FA-diagnostics-\u8BCA\u65AD\u95EE\u9898\u5217\u8868" tabindex="-1"><a class="header-anchor" href="#lighthouse-\u7ED9\u51FA-diagnostics-\u8BCA\u65AD\u95EE\u9898\u5217\u8868" aria-hidden="true">#</a> Lighthouse \u7ED9\u51FA Diagnostics \u8BCA\u65AD\u95EE\u9898\u5217\u8868</h4><p><strong><code>Diagnostics</code> \u6307\u7684\u662F\u73B0\u5728\u5B58\u5728\u7684\u95EE\u9898\uFF0C\u4E3A\u8FDB\u4E00\u6B65\u6539\u5584\u6027\u80FD\u7684\u9A8C\u8BC1\u548C\u8C03\u6574\u7ED9\u51FA\u4E86\u6307\u5BFC</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b808a0335cdd4eb7a43b20b00b16e68a~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="DiagNo.jpg"></p><p><strong>Diagnostics \u8BCA\u65AD\u95EE\u9898\u5217\u8868</strong></p><table><thead><tr><th>\u95EE\u9898</th><th>\u5F71\u54CD</th></tr></thead><tbody><tr><td>A long cache lifetime can speed up repeat visits to your page</td><td>\u8FD9\u4E9B\u8D44\u6E90\u9700\u8981\u63D0\u4F9B\u957F\u7684\u7F13\u5B58\u671F\uFF0C\u73B0\u53D1\u73B0\u56FE\u7247\u90FD\u662F\u7528\u7684\u534F\u5546\u7F13\u5B58\uFF0C\u663E\u7136\u4E0D\u5408\u7406</td></tr><tr><td>Image elements do not have explicit width and height</td><td>\u7ED9\u56FE\u7247\u8BBE\u7F6E\u5177\u4F53\u7684\u5BBD\u9AD8\uFF0C\u51CF\u5C11 cls \u7684\u503C</td></tr><tr><td>Avoid enormous network payloads</td><td>\u8D44\u6E90\u592A\u5927\u589E\u52A0\u7F51\u7EDC\u8D1F\u8F7D</td></tr><tr><td>Minimize main-thread work</td><td>\u6700\u5C0F\u5316\u4E3B\u7EBF\u7A0B \u8FD9\u91CC\u4F1A\u6267\u884C\u89E3\u6790 Html\u3001\u6837\u5F0F\u8BA1\u7B97\u3001\u5E03\u5C40\u3001\u7ED8\u5236\u3001\u5408\u6210\u7B49\u52A8\u4F5C</td></tr><tr><td>Reduce JavaScript execution time</td><td>\u51CF\u5C11\u975E\u5FC5\u8981 js \u8D44\u6E90\u7684\u52A0\u8F7D\uFF0C\u51CF\u5C11\u5FC5\u8981 js \u8D44\u6E90\u7684\u5927\u5C0F</td></tr><tr><td>Avoid large layout shifts</td><td>\u907F\u514D\u5927\u7684\u5E03\u5C40\u53D8\u5316\uFF0C\u4ECE\u4E2D\u53EF\u4EE5\u770B\u5230\u5F71\u54CD\u5E03\u5C40\u53D8\u5316\u6700\u5927\u7684\u5143\u7D20</td></tr></tbody></table><p><strong><code>\u8FD9\u4E9BOpportunities\u5EFA\u8BAE\u548CDiagnostics\u8BCA\u65AD\u95EE\u9898\u662F\u975E\u5E38\u5177\u4F53\u4E14\u6709\u6548\u7684\uFF08\u4EB2\u6D4B\uFF09\uFF0C\u5F00\u53D1\u8005\u53EF\u4EE5\u6839\u636E\u8FD9\u4E9B\u5EFA\u8BAE\uFF0C\u4E00\u6761\u6761\u53BB\u4FEE\u6539\u6216\u4F18\u5316</code></strong></p><h4 id="lighthouse-\u5217\u51FA-performance-\u5404\u6307\u6807\u5F97\u5206" tabindex="-1"><a class="header-anchor" href="#lighthouse-\u5217\u51FA-performance-\u5404\u6307\u6807\u5F97\u5206" aria-hidden="true">#</a> Lighthouse \u5217\u51FA Performance \u5404\u6307\u6807\u5F97\u5206</h4><p>Performance \u5217\u51FA\u4E86<code>FCP\u3001SP\u3001LCP\u3001TTI\u3001TBI\u3001CLS</code> \u516D\u4E2A\u6307\u6807\u7684\u7528\u65F6\u548C\u5F97\u5206\u60C5\u51B5</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u4E0B\u6587\u4F1A\u804A\u4E00\u804A\u8FD9\u4E9B\u6307\u6807\u7684\u7528\u6CD5\u4E0E\u4F5C\u7528
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af0472178da940eba7dd95bb6ef7c597~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="performance1.jpg"></p>`,23),Q={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.cnblogs.com%2Fwenxuehai%2Fp%2F14236426.html",target:"_blank",rel:"noopener noreferrer"},X=n("h3",{id:"web-vitals-\u5B98\u65B9\u6807\u51C6",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#web-vitals-\u5B98\u65B9\u6807\u51C6","aria-hidden":"true"},"#"),s(" Web-vitals \u5B98\u65B9\u6807\u51C6")],-1),Z={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fweb-vitals",target:"_blank",rel:"noopener noreferrer"},nn=n("strong",null,"\u826F\u597D\u7F51\u7AD9\u7684\u57FA\u672C\u6307\u6807",-1),sn=e(`<p>\u8FC7\u53BB\u8981\u8861\u91CF\u4E00\u4E2A\u7F51\u7AD9\u7684\u597D\u574F\uFF0C\u9700\u8981\u4F7F\u7528\u7684\u6307\u6807\u592A\u591A\u4E86\uFF0C\u73B0\u5728\u6211\u4EEC\u53EF\u4EE5\u5C06\u91CD\u70B9\u805A\u7126\u4E8E Web Vitals \u6307\u6807\u7684\u8868\u73B0\u5373\u53EF</p><p><strong>\u5B98\u65B9\u6307\u6807\u6807\u51C6</strong></p><table><thead><tr><th>\u6307\u6807</th><th>\u4F5C\u7528</th><th>\u6807\u51C6</th></tr></thead><tbody><tr><td>FCP(First Contentful Paint)</td><td>\u9996\u6B21\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4</td><td>\u6807\u51C6 \u22641s</td></tr><tr><td>LCP(Largest Contentful Paint)</td><td>\u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4</td><td>\u6807\u51C6 \u22642 \u79D2</td></tr><tr><td>FID(first input delay)</td><td>\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF\uFF0C\u6807\u51C6\u662F\u7528\u6237\u89E6\u53D1\u540E\uFF0C\u5230\u6D4F\u89C8\u5668\u54CD\u5E94\u65F6\u95F4</td><td>\u6807\u51C6 \u2264100ms</td></tr><tr><td>CLS(Cumulative Layout Shift)</td><td>\u7D2F\u79EF\u5E03\u5C40\u504F\u79FB</td><td>\u6807\u51C6 \u22640.1</td></tr><tr><td>TTFB(Time to First Byte)</td><td>\u9875\u9762\u53D1\u51FA\u8BF7\u6C42\uFF0C\u5230\u63A5\u6536\u7B2C\u4E00\u4E2A\u5B57\u8282\u6240\u82B1\u8D39\u7684\u6BEB\u79D2\u6570(\u9996\u5B57\u8282\u65F6\u95F4)</td><td>\u6807\u51C6&lt;= 100 \u6BEB\u79D2</td></tr></tbody></table><p><strong>\u6211\u4EEC\u5C06 Lighthouse \u4E2D Performance \u5217\u51FA\u7684\u6307\u6807\u8868\u73B0\uFF0C\u4E0E\u5B98\u65B9\u6307\u6807\u6807\u51C6\u505A\u5BF9\u6BD4\uFF0C\u53EF\u4EE5\u53D1\u73B0\u9875\u9762\u54EA\u4E9B\u6307\u6807\u8D85\u51FA\u4E86\u8303\u56F4</strong></p><h3 id="performance-\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#performance-\u5DE5\u5177" aria-hidden="true">#</a> Performance \u5DE5\u5177</h3><p>\u901A\u8FC7 Lighthouse \u6211\u4EEC\u77E5\u9053\u4E86\u9875\u9762\u6574\u4F53\u7684\u6027\u80FD\u5F97\u5206\uFF0C\u4F46\u662F\u9875\u9762\u6253\u5F00\u6162\u6216\u8005\u5361\u987F\u7684\u74F6\u9888\u5728\u54EA\u91CC\uFF1F</p><p>\u5177\u4F53\u662F<code>\u52A0\u8F7D\u8D44\u6E90\u6162</code>\u3001<code>dom\u6E32\u67D3\u6162</code>\u3001\u8FD8\u662F<code>js\u6267\u884C\u6162</code>\u5462\uFF1F</p><p>chrome \u6D4F\u89C8\u5668\u63D0\u4F9B\u7684<code>performance</code>\u662F\u5E38\u7528\u6765\u67E5\u770B\u7F51\u9875\u6027\u80FD\u7684\u5DE5\u5177\uFF0C\u901A\u8FC7\u8BE5\u5DE5\u5177\uFF0C\u6211\u4EEC\u53EF\u4EE5\u77E5\u9053\u9875\u9762\u5728\u6D4F\u89C8\u5668\u8FD0\u884C\u65F6\u7684\u6027\u80FD\u8868\u73B0</p><h4 id="performance-\u5BFB\u627E\u6027\u80FD\u74F6\u9888" tabindex="-1"><a class="header-anchor" href="#performance-\u5BFB\u627E\u6027\u80FD\u74F6\u9888" aria-hidden="true">#</a> Performance \u5BFB\u627E\u6027\u80FD\u74F6\u9888</h4><p>\u6253\u5F00 Chrome \u6D4F\u89C8\u5668\u63A7\u5236\u53F0\uFF0C\u9009\u62E9<code>Performance</code>\u9009\u9879\uFF0C\u70B9\u51FB\u5DE6\u4FA7<code>reload\u56FE\u6807</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ad95e570f854f62a5affae73899dfaf~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="perfromance1.gif"></p><p><strong>Performance \u9762\u677F\u53EF\u4EE5\u8BB0\u5F55\u548C\u5206\u6790\u9875\u9762\u5728\u8FD0\u884C\u65F6\u7684\u6240\u6709\u6D3B\u52A8\uFF0C\u5927\u81F4\u5206\u4E3A\u4EE5\u4E0B 4 \u4E2A\u533A\u57DF</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/733069bb8c6d4d4c90b3df24230b0e92~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="performance2.png"></p><h4 id="performance-\u5404\u533A\u57DF\u529F\u80FD\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#performance-\u5404\u533A\u57DF\u529F\u80FD\u4ECB\u7ECD" aria-hidden="true">#</a> Performance \u5404\u533A\u57DF\u529F\u80FD\u4ECB\u7ECD</h4><p><strong>1\uFF09FPS</strong></p><p><strong>FPS(Frames Per Second)\uFF0C\u8868\u793A\u6BCF\u79D2\u4F20\u8F93\u5E27\u6570\uFF0C\u662F\u7528\u6765\u5206\u6790<code>\u9875\u9762\u662F\u5426\u5361\u987F</code>\u7684\u4E00\u4E2A\u4E3B\u8981\u6027\u80FD\u6307\u6807</strong></p><p>\u5982\u4E0B\u56FE\u6240\u793A\uFF0C<code>\u7EFF\u8272\u7684\u957F\u6761\u8D8A\u9AD8\uFF0C\u8BF4\u660EFPS\u8D8A\u9AD8\uFF0C\u7528\u6237\u4F53\u9A8C\u8D8A\u597D</code></p><p>\u5982\u679C\u53D1\u73B0\u4E86<code>\u4E00\u4E2A\u7EA2\u8272\u7684\u957F\u6761\uFF0C\u90A3\u4E48\u5C31\u8BF4\u660E\u8FD9\u4E9B\u5E27\u5B58\u5728\u4E25\u91CD\u95EE\u9898</code>\uFF0C\u53EF\u80FD\u4F1A\u9020\u6210\u9875\u9762\u5361\u987F</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/daa866b933004dafa5c06c2cc915a35d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="FPS.png"></p><p><strong>2\uFF09NET</strong></p><p><strong>NET \u8BB0\u5F55\u8D44\u6E90\u7684\u7B49\u5F85\u3001\u4E0B\u8F7D\u3001\u6267\u884C\u65F6\u95F4\uFF0C\u6BCF\u6761\u5F69\u8272\u6A2A\u6760\u8868\u793A\u4E00\u79CD\u8D44\u6E90</strong></p><p>\u6A2A\u6760\u8D8A\u957F\uFF0C\u68C0\u7D22\u8D44\u6E90\u6240\u9700\u7684\u65F6\u95F4\u8D8A\u957F\u3002\u6BCF\u4E2A\u6A2A\u6760\u7684\u6D45\u8272\u90E8\u5206\u8868\u793A\u7B49\u5F85\u65F6\u95F4\uFF08\u4ECE\u8BF7\u6C42\u8D44\u6E90\u5230\u7B2C\u4E00\u4E2A\u5B57\u8282\u4E0B\u8F7D\u5B8C\u6210\u7684\u65F6\u95F4\uFF09</p><p>Network \u7684\u989C\u8272\u8BF4\u660E\uFF1A\u767D\u8272\u8868\u793A\u7B49\u5F85\u7684\u989C\u8272\u3001\u6D45\u9EC4\u8272\u8868\u793A\u8BF7\u6C42\u7684\u65F6\u95F4\u3001\u6DF1\u9EC4\u8272\u8868\u793A\u4E0B\u8F7D\u7684\u65F6\u95F4</p><p><strong>\u5728\u8FD9\u91CC\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u6240\u6709\u8D44\u6E90\u7684\u52A0\u8F7D\u8FC7\u7A0B\uFF0C\u6709\u4E24\u4E2A\u5730\u65B9\u91CD\u70B9\u5173\u6CE8\uFF1A</strong></p><p>1\uFF09\u8D44\u6E90\u7B49\u5F85\u7684\u65F6\u95F4\u662F\u5426\u8FC7\u957F\uFF08\u6807\u51C6 \u2264100ms\uFF09</p><p>2\uFF09\u8D44\u6E90\u6587\u4EF6\u4F53\u79EF\u662F\u5426\u8FC7\u5927\uFF0C\u9020\u6210\u52A0\u8F7D\u5F88\u6162\uFF08\u5C31\u8981\u8003\u8651\u5982\u4F55\u62C6\u5206\u8BE5\u8D44\u6E90\uFF09</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4f36cb8f3634b109b4737a48cb61429~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="net.png"></p><p><strong>3\uFF09\u706B\u7130\u56FE</strong></p><p><strong>\u706B\u7130\u56FE\uFF08Flame Chart\uFF09\u7528\u6765\u53EF\u89C6\u5316 CPU \u5806\u6808\u4FE1\u606F\u8BB0\u5F55</strong></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2b5e759df83476f8f8238cbe66be66b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="fire.png"> 1\uFF09Network: \u8868\u793A\u52A0\u8F7D\u4E86\u54EA\u4E9B\u8D44\u6E90 2\uFF09Frames\uFF1A\u8868\u793A\u6BCF\u5E45\u5E27\u7684\u8FD0\u884C\u60C5\u51B5 3\uFF09Timings: \u8BB0\u5F55\u9875\u9762\u4E2D\u5173\u952E\u6307\u6807\u7684\u65F6\u95F4 4\uFF09<code>Main:\u8868\u793A\u4E3B\u7EBF\u7A0B\uFF08\u91CD\u70B9\uFF0C\u4E0B\u6587\u4F1A\u8BE6\u7EC6\u4ECB\u7ECD\uFF09</code> 5\uFF09GPU:\u8868\u793A GPU \u5360\u7528\u60C5\u51B5</p><p><strong>4\uFF09\u7EDF\u8BA1\u6C47\u603B</strong></p><p>Summary: \u8868\u793A\u5404\u6307\u6807\u65F6\u95F4\u5360\u7528\u7EDF\u8BA1\u62A5\u8868</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token target symbol">1\uFF09Loading</span><span class="token punctuation">:</span> \u52A0\u8F7D\u65F6\u95F4
<span class="token target symbol">2\uFF09Scripting</span><span class="token punctuation">:</span> js\u8BA1\u7B97\u65F6\u95F4
<span class="token target symbol">3\uFF09Rendering</span><span class="token punctuation">:</span> \u6E32\u67D3\u65F6\u95F4
<span class="token target symbol">4\uFF09Painting</span><span class="token punctuation">:</span> \u7ED8\u5236\u65F6\u95F4
<span class="token target symbol">5\uFF09Other</span><span class="token punctuation">:</span> \u5176\u4ED6\u65F6\u95F4
<span class="token target symbol">6\uFF09Idle</span><span class="token punctuation">:</span> \u6D4F\u89C8\u5668\u95F2\u7F6E\u65F6\u95F4

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b034f036bde34c9f9667acaaa2db0b26~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="sum.jpg"></p><h4 id="performance-main-\u6027\u80FD\u74F6\u9888\u7684\u7A81\u7834\u53E3" tabindex="-1"><a class="header-anchor" href="#performance-main-\u6027\u80FD\u74F6\u9888\u7684\u7A81\u7834\u53E3" aria-hidden="true">#</a> Performance Main \u6027\u80FD\u74F6\u9888\u7684\u7A81\u7834\u53E3</h4><p><strong>Main \u8868\u793A\u4E3B\u7EBF\u7A0B\uFF0C\u4E3B\u8981\u8D1F\u8D23</strong></p><p>1\uFF09Javascript \u7684\u8BA1\u7B97\u4E0E\u6267\u884C 2\uFF09CSS \u6837\u5F0F\u8BA1\u7B97 3\uFF09Layout \u5E03\u5C40\u8BA1\u7B97 4\uFF09\u5C06\u9875\u9762\u5143\u7D20\u7ED8\u5236\u6210\u4F4D\u56FE\uFF08paint\uFF09\uFF0C\u4E5F\u5C31\u662F\u5149\u6805\u5316\uFF08Raster\uFF09</p><p><strong>\u5C55\u5F00 Main,\u53EF\u4EE5\u53D1\u73B0\u5F88\u591A<code>\u7EA2\u8272\u4E09\u89D2\uFF08long task\uFF09</code>\uFF0C\u8FD9\u4E9B\u6267\u884C\u65F6\u95F4\u8D85\u8FC7 <code>50ms</code>\u5C31\u5C5E\u4E8E<code>\u957F\u4EFB\u52A1</code>\uFF0C\u4F1A\u9020\u6210\u9875\u9762\u5361\u987F\uFF0C\u4E25\u91CD\u65F6\u4F1A\u9020\u6210\u9875\u9762\u5361\u6B7B</strong></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3fff398aabc3492589d35bec1d095ab2~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="main.jpg"></p><p>\u5C55\u5F00\u5176\u4E2D\u4E00\u4E2A\u7EA2\u8272\u4E09\u89D2\uFF0CDevtools \u5728<code>Summary</code>\u9762\u677F\u91CC\u5C55\u793A\u4E86\u66F4\u591A\u5173\u4E8E\u8FD9\u4E2A\u4E8B\u4EF6\u7684\u4FE1\u606F</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1c5aeed2a25b426f94747c370329fb97~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="app.jpg"></p><p><strong>\u5728 summary \u9762\u677F\u91CC\u70B9\u51FB<code>app.js</code>\u94FE\u63A5\uFF0CDevtools \u53EF\u4EE5\u8DF3\u8F6C\u5230\u9700\u8981\u4F18\u5316\u7684\u4EE3\u7801\u5904</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5777d8ab909943e18b960bf89adfc6e1~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="source.jpg"></p><p>\u4E0B\u9762\u6211\u4EEC\u9700\u8981\u7ED3\u5408\u81EA\u5DF1\u7684\u4EE3\u7801\u903B\u8F91\uFF0C\u53BB\u5224\u65AD\u8FD9\u5757\u4EE3\u7801\u4E3A\u4EC0\u4E48\u6267\u884C\u65F6\u95F4\u8D85\u957F\uFF1F</p><p><strong>\u5982\u4F55\u53BB\u89E3\u51B3\u6216\u4F18\u5316\u8FD9\u4E9B<code>long task</code>\uFF0C\u4ECE\u800C\u89E3\u51B3\u53BB\u9875\u9762\u7684\u6027\u80FD\u74F6\u9888</strong></p>`,45),an={href:"https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F29879682",target:"_blank",rel:"noopener noreferrer"},tn={href:"https://juejin.cn/post/6892003555818143752#heading-26",target:"_blank",rel:"noopener noreferrer"},en={href:"https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fqq_38128179%2Farticle%2Fdetails%2F104491149",target:"_blank",rel:"noopener noreferrer"},pn=e(`<h2 id="\u6027\u80FD\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#\u6027\u80FD\u76D1\u63A7" aria-hidden="true">#</a> \u6027\u80FD\u76D1\u63A7</h2><p>\u9879\u76EE\u53D1\u5E03\u751F\u4EA7\u540E\uFF0C\u7528\u6237\u4F7F\u7528\u65F6\u7684\u6027\u80FD\u5982\u4F55\uFF0C\u9875\u9762\u6574\u4F53\u7684\u6253\u5F00\u901F\u5EA6\u662F\u591A\u5C11\u3001\u767D\u5C4F\u65F6\u95F4\u591A\u5C11\uFF0CFP\u3001FCP\u3001LCP\u3001FID\u3001CLS \u7B49\u6307\u6807\uFF0C\u8981\u8BBE\u7F6E\u591A\u5927\u7684\u9600\u503C\u5462\uFF0C\u624D\u80FD\u6EE1\u8DB3<code>TP50\u3001TP90\u3001TP99</code>\u7684\u8981\u6C42\u5462\uFF1F</p><blockquote><p>TP \u6307\u6807: \u603B\u6B21\u6570 * \u6307\u6807\u6570 = \u5BF9\u5E94 TP \u6307\u6807\u7684\u503C\u3002</p><p>\u8BBE\u7F6E\u6BCF\u4E2A\u6307\u6807\u7684\u9600\u503C\uFF0C\u6BD4\u5982 FP \u6307\u6807\uFF0C\u8BBE\u7F6E\u9600\u503C\u4E3A 1s\uFF0C\u8981\u6C42 Tp95\uFF0C\u5373 95%\u7684 FP \u6307\u6807\uFF0C\u8981\u5728 1s \u4EE5\u4E0B\uFF0C\u5269\u4F59 5%\u7684\u6307\u6807\u8D85\u8FC7 1s</p><p>TP50 \u76F8\u5BF9\u8F83\u4F4E\uFF0CTP90 \u5219\u6BD4\u8F83\u9AD8\uFF0CTP99\uFF0CTP999 \u5219\u5BF9\u6027\u80FD\u8981\u6C42\u5F88\u9AD8</p></blockquote><p>\u8FD9\u91CC\u5C31\u9700\u8981\u6027\u80FD\u76D1\u63A7\uFF0C\u91C7\u96C6\u5230\u7528\u6237\u7684\u9875\u9762\u6570\u636E</p><h3 id="\u6027\u80FD\u6307\u6807\u7684\u8BA1\u7B97" tabindex="-1"><a class="header-anchor" href="#\u6027\u80FD\u6307\u6807\u7684\u8BA1\u7B97" aria-hidden="true">#</a> \u6027\u80FD\u6307\u6807\u7684\u8BA1\u7B97</h3><p>\u5E38\u7528\u7684\u4E24\u79CD\u65B9\u5F0F\uFF1A</p><p><strong>\u65B9\u5F0F\u4E00\uFF1A\u901A\u8FC7 web-vitals \u5B98\u65B9\u5E93\u8FDB\u884C\u8BA1\u7B97</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> onLCP<span class="token punctuation">,</span> onFID<span class="token punctuation">,</span> onCLS <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;web-vitals&quot;</span><span class="token punctuation">;</span>

<span class="token function">onCLS</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">onFID</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">onLCP</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u65B9\u5F0F\u4E8C\uFF1A\u901A\u8FC7<code>performance api</code>\u8FDB\u884C\u8BA1\u7B97</strong></p><p>\u4E0B\u9762\u804A\u4E00\u4E0B performance api \u6765\u8BA1\u7B97\u5404\u79CD\u6307\u6807</p><p>\u6253\u5F00\u4EFB\u610F\u7F51\u9875\uFF0C\u5728\u63A7\u5236\u53F0\u4E2D\u8F93\u5165 performance \u56DE\u8F66\uFF0C\u53EF\u4EE5\u770B\u5230\u4E00\u7CFB\u5217\u7684\u53C2\u6570\uFF0C</p><h3 id="performance-timing" tabindex="-1"><a class="header-anchor" href="#performance-timing" aria-hidden="true">#</a> performance.timing</h3><p>\u91CD\u70B9\u770B\u4E0B<code>performance.timing</code>\uFF0C\u8BB0\u5F55\u4E86\u9875\u9762\u7684\u5404\u4E2A\u5173\u952E\u65F6\u95F4\u70B9</p><table><thead><tr><th>\u65F6\u95F4</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td><code>navigationStart</code></td><td>\uFF08\u53EF\u4EE5\u7406\u89E3\u4E3A\u8BE5\u9875\u9762\u7684\u8D77\u59CB\u65F6\u95F4\uFF09\u540C\u4E00\u4E2A\u6D4F\u89C8\u5668\u4E0A\u4E0B\u6587\u7684\u4E0A\u4E00\u4E2A\u6587\u6863\u5378\u8F7D\u7ED3\u675F\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u6CA1\u6709\u4E0A\u4E00\u4E2A\u6587\u6863\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u548C fetchStart \u76F8\u540C</td></tr><tr><td>unloadEventStart</td><td>unload \u4E8B\u4EF6\u629B\u51FA\u65F6\u7684\u65F6\u95F4\u6233,\u5982\u679C\u6CA1\u6709\u4E0A\u4E00\u4E2A\u6587\u6863\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u662F 0</td></tr><tr><td>unloadEventEnd</td><td>unload \u4E8B\u4EF6\u5904\u7406\u5B8C\u6210\u7684\u65F6\u95F4\u6233,\u5982\u679C\u6CA1\u6709\u4E0A\u4E00\u4E2A\u6587\u6863\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u662F 0</td></tr><tr><td>redirectStart</td><td>\u7B2C\u4E00\u4E2A HTTP \u91CD\u5B9A\u5411\u5F00\u59CB\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u6CA1\u6709\u91CD\u5B9A\u5411\u6216\u8005\u91CD\u5B9A\u5411\u4E2D\u7684\u4E0D\u540C\u6E90\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u662F 0</td></tr><tr><td>redirectEnd</td><td>\u6700\u540E\u4E00\u4E2A HTTP \u91CD\u5B9A\u5411\u5F00\u59CB\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u6CA1\u6709\u91CD\u5B9A\u5411\u6216\u8005\u91CD\u5B9A\u5411\u4E2D\u7684\u4E0D\u540C\u6E90\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u662F 0</td></tr><tr><td>fetchStart</td><td>\u6D4F\u89C8\u5668\u51C6\u5907\u597D\u4F7F\u7528 HTTP \u8BF7\u6C42\u6765\u83B7\u53D6\u6587\u6863\u7684\u65F6\u95F4\u6233\u3002\u53D1\u9001\u5728\u68C0\u67E5\u7F13\u5B58\u4E4B\u524D</td></tr><tr><td>domainLookupStart</td><td>\u57DF\u540D\u67E5\u8BE2\u5F00\u59CB\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u4F7F\u7528\u4E86\u6301\u7EED\u8FDE\u63A5\u6216\u8005\u7F13\u5B58\uFF0C\u5219\u4E0E fetchStart \u4E00\u81F4</td></tr><tr><td>domainLookupEnd</td><td>\u57DF\u540D\u67E5\u8BE2\u7ED3\u675F\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u4F7F\u7528\u4E86\u6301\u7EED\u8FDE\u63A5\u6216\u8005\u7F13\u5B58\uFF0C\u5219\u4E0E fetchStart \u4E00\u81F4</td></tr><tr><td>connectStart</td><td>HTTP \u8BF7\u6C42\u5F00\u59CB\u5411\u670D\u52A1\u5668\u53D1\u9001\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u4F7F\u7528\u4E86\u6301\u7EED\u8FDE\u63A5\uFF0C\u5219\u4E0E fetchStart \u4E00\u81F4</td></tr><tr><td>connectEnd</td><td>\u6D4F\u89C8\u5668\u4E0E\u670D\u52A1\u5668\u4E4B\u95F4\u8FDE\u63A5\u5EFA\u7ACB\uFF08\u6240\u6709\u63E1\u624B\u548C\u8BA4\u8BC1\u8FC7\u7A0B\u5168\u90E8\u7ED3\u675F\uFF09\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u4F7F\u7528\u4E86\u6301\u7EED\u8FDE\u63A5\uFF0C\u5219\u4E0E fetchStart \u4E00\u81F4</td></tr><tr><td>secureConnectionStart</td><td>\u6D4F\u89C8\u5668\u4E0E\u670D\u52A1\u5668\u5F00\u59CB\u5B89\u5168\u8FDE\u63A5\u63E1\u624B\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u5F53\u524D\u7F51\u9875\u4E0D\u9700\u8981\u5B89\u5168\u8FDE\u63A5\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u662F 0</td></tr><tr><td><code>requestStart</code></td><td>\u6D4F\u89C8\u5668\u5411\u670D\u52A1\u5668\u53D1\u51FA HTTP \u8BF7\u6C42\u7684\u65F6\u95F4\u6233</td></tr><tr><td><code>responseStart</code></td><td>\u6D4F\u89C8\u5668\u4ECE\u670D\u52A1\u5668\u6536\u5230\uFF08\u6216\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6\uFF09\u7B2C\u4E00\u4E2A\u5B57\u8282\u65F6\u7684\u65F6\u95F4\u6233</td></tr><tr><td>responseEnd</td><td>\u6D4F\u89C8\u5668\u4ECE\u670D\u52A1\u5668\u6536\u5230\uFF08\u6216\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6\uFF09\u6700\u540E\u4E00\u4E2A\u5B57\u8282\u65F6\uFF08\u5982\u679C\u5728\u6B64\u4E4B\u524D HTTP \u8FDE\u63A5\u5DF2\u7ECF\u5173\u95ED\uFF0C\u5219\u8FD4\u56DE\u5173\u95ED\u65F6\uFF09\u7684\u65F6\u95F4\u6233</td></tr><tr><td><code>domLoading</code></td><td>\u5F53\u524D\u7F51\u9875 DOM \u7ED3\u6784\u5F00\u59CB\u89E3\u6790\u65F6\u7684\u65F6\u95F4\u6233</td></tr><tr><td>domInteractive</td><td>\u5F53\u524D\u7F51\u9875 DOM \u7ED3\u6784\u89E3\u6790\u5B8C\u6210\uFF0C\u5F00\u59CB\u52A0\u8F7D\u5185\u5D4C\u8D44\u6E90\u65F6\u7684\u65F6\u95F4\u6233</td></tr><tr><td>domContentLoadedEventStart</td><td>\u9700\u8981\u88AB\u6267\u884C\u7684\u811A\u672C\u5DF2\u7ECF\u88AB\u89E3\u6790\u7684\u65F6\u95F4\u6233</td></tr><tr><td>domContentLoadedEventEnd</td><td>\u9700\u8981\u7ACB\u5373\u6267\u884C\u7684\u811A\u672C\u5DF2\u7ECF\u88AB\u6267\u884C\u7684\u65F6\u95F4\u6233</td></tr><tr><td><code>domComplete</code></td><td>\u5F53\u524D\u6587\u6863\u89E3\u6790\u5B8C\u6210\u7684\u65F6\u95F4\u6233</td></tr><tr><td>loadEventStart</td><td>load \u4E8B\u4EF6\u88AB\u53D1\u9001\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u8FD9\u4E2A\u4E8B\u4EF6\u8FD8\u672A\u88AB\u53D1\u9001\uFF0C\u5B83\u7684\u503C\u5C06\u4F1A\u662F 0</td></tr><tr><td><code>loadEventEnd</code></td><td>load \u4E8B\u4EF6\u7ED3\u675F\u65F6\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u8FD9\u4E2A\u4E8B\u4EF6\u8FD8\u672A\u88AB\u53D1\u9001\uFF0C\u5B83\u7684\u503C\u5C06\u4F1A\u662F 0</td></tr></tbody></table><h3 id="\u767D\u5C4F\u65F6\u95F4-fp" tabindex="-1"><a class="header-anchor" href="#\u767D\u5C4F\u65F6\u95F4-fp" aria-hidden="true">#</a> \u767D\u5C4F\u65F6\u95F4 FP</h3><p>\u767D\u5C4F\u65F6\u95F4 FP\uFF08First Paint\uFF09\u6307\u7684\u662F\u4ECE\u7528\u6237\u8F93\u5165 url \u7684\u65F6\u523B\u5F00\u59CB\u8BA1\u7B97\uFF0C\u4E00\u76F4\u5230\u9875\u9762\u6709\u5185\u5BB9\u5C55\u793A\u51FA\u6765\u7684\u65F6\u95F4\u8282\u70B9\uFF0C<code>\u6807\u51C6\u22642s</code></p><p><strong>\u8FD9\u4E2A\u8FC7\u7A0B\u5305\u62EC dns \u67E5\u8BE2\u3001\u5EFA\u7ACB tcp \u8FDE\u63A5\u3001\u53D1\u9001 http \u8BF7\u6C42\u3001\u8FD4\u56DE html \u6587\u6863\u3001html \u6587\u6863\u89E3\u6790</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">entryHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&#39;first-paint&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
       <span class="token comment">// \u5176\u4E2DstartTime \u5C31\u662F\u767D\u5C4F\u65F6\u95F4</span>
       <span class="token keyword">let</span> <span class="token constant">FP</span> <span class="token operator">=</span> entry<span class="token punctuation">.</span>startTime<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span>entryHandler<span class="token punctuation">)</span>
<span class="token comment">// buffered \u5C5E\u6027\u8868\u793A\u662F\u5426\u89C2\u5BDF\u7F13\u5B58\u6570\u636E\uFF0C\u4E5F\u5C31\u662F\u8BF4\u89C2\u5BDF\u4EE3\u7801\u6DFB\u52A0\u65F6\u673A\u6BD4\u4E8B\u4EF6\u89E6\u53D1\u65F6\u673A\u665A\u4E5F\u6CA1\u5173\u7CFB\u3002</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;paint&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u9996\u6B21\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4-fcp" tabindex="-1"><a class="header-anchor" href="#\u9996\u6B21\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4-fcp" aria-hidden="true">#</a> \u9996\u6B21\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4 FCP</h3><p>FCP(First Contentful Paint) \u8868\u793A\u9875\u9762\u4EFB\u4E00\u90E8\u5206\u6E32\u67D3\u5B8C\u6210\u7684\u65F6\u95F4\uFF0C<code>\u6807\u51C6\u22641s</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8BA1\u7B97\u65B9\u5F0F\uFF1A</span>
<span class="token keyword">const</span> <span class="token function-variable function">entryHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;first-contentful-paint&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u8BA1\u7B97\u9996\u6B21\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4</span>
    <span class="token keyword">let</span> <span class="token constant">FCP</span> <span class="token operator">=</span> entry<span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span>entryHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;paint&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4-lcp" tabindex="-1"><a class="header-anchor" href="#\u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4-lcp" aria-hidden="true">#</a> \u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4 LCP</h3><p>LCP(Largest Contentful Paint)\u8868\u793A\u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4\uFF0C<code>\u6807\u51C6\u22642 \u79D2</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8BA1\u7B97\u65B9\u5F0F\uFF1A</span>
<span class="token keyword">const</span> <span class="token function-variable function">entryHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u6700\u5927\u5185\u5BB9\u7ED8\u5236\u65F6\u95F4</span>
    <span class="token keyword">let</span> <span class="token constant">LCP</span> <span class="token operator">=</span> entry<span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span>entryHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;largest-contentful-paint&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7D2F\u79EF\u5E03\u5C40\u504F\u79FB\u503C-cls" tabindex="-1"><a class="header-anchor" href="#\u7D2F\u79EF\u5E03\u5C40\u504F\u79FB\u503C-cls" aria-hidden="true">#</a> \u7D2F\u79EF\u5E03\u5C40\u504F\u79FB\u503C CLS</h3><p>CLS(Cumulative Layout Shift) \u8868\u793A\u7D2F\u79EF\u5E03\u5C40\u504F\u79FB\uFF0C<code>\u6807\u51C6\u22640.1</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// cls\u4E3A\u7D2F\u79EF\u5E03\u5C40\u504F\u79FB\u503C</span>
<span class="token keyword">let</span> cls <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entryList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> entryList<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>entry<span class="token punctuation">.</span>hadRecentInput<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cls <span class="token operator">+=</span> entry<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;layout-shift&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u9996\u5B57\u8282\u65F6\u95F4-ttfb" tabindex="-1"><a class="header-anchor" href="#\u9996\u5B57\u8282\u65F6\u95F4-ttfb" aria-hidden="true">#</a> \u9996\u5B57\u8282\u65F6\u95F4 TTFB</h3><p>\u5E73\u5E38\u6240\u8BF4\u7684<code>TTFB</code>\uFF0C\u9ED8\u8BA4\u6307\u5BFC\u822A\u8BF7\u6C42\u7684<code>TTFB</code></p><p>\u5BFC\u822A\u8BF7\u6C42\uFF1A\u5728\u6D4F\u89C8\u5668\u5207\u6362\u9875\u9762\u65F6\u521B\u5EFA\uFF0C\u4ECE\u5BFC\u822A\u5F00\u59CB\u5230\u8BE5\u8BF7\u6C42\u8FD4\u56DE HTML</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">window.onload</span> <span class="token punctuation">=</span> <span class="token value attr-value">function () {</span>
  // \u9996\u5B57\u8282\u65F6\u95F4
  <span class="token key attr-name">let TTFB</span> <span class="token punctuation">=</span> <span class="token value attr-value">responseStart - navigationStart;</span>
};

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF-fid" tabindex="-1"><a class="header-anchor" href="#\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF-fid" aria-hidden="true">#</a> \u9996\u6B21\u8F93\u5165\u5EF6\u8FDF FID</h3><p>FID\uFF08first input delay\uFF09\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF\uFF0C\u6807\u51C6\u662F\u7528\u6237\u89E6\u53D1\u540E\uFF0C\u6D4F\u89C8\u5668\u7684\u54CD\u5E94\u65F6\u95F4\uFF0C <code>\u6807\u51C6\u2264100ms</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entryList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> entryList<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8BA1\u7B97\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF\u65F6\u95F4</span>
    <span class="token keyword">const</span> <span class="token constant">FID</span> <span class="token operator">=</span> entry<span class="token punctuation">.</span>processingStart <span class="token operator">-</span> entry<span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;first-input&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>FID \u63A8\u8350\u4F7F\u7528 web-vitals \u5E93\uFF0C\u56E0\u4E3A\u5B98\u65B9\u517C\u5BB9\u4E86\u5F88\u591A\u573A\u666F</p><h3 id="\u9996\u9875\u52A0\u8F7D\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#\u9996\u9875\u52A0\u8F7D\u65F6\u95F4" aria-hidden="true">#</a> \u9996\u9875\u52A0\u8F7D\u65F6\u95F4</h3><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">window.onload</span> <span class="token punctuation">=</span> <span class="token value attr-value">function () {</span>
  // \u9996\u9875\u52A0\u8F7D\u65F6\u95F4
  <span class="token key attr-name">// domComplete \u662Fdocument\u7684readyState</span> <span class="token punctuation">=</span> <span class="token value attr-value">complete\uFF08\u5B8C\u6210\uFF09\u7684\u72B6\u6001</span>
  <span class="token key attr-name">let firstScreenTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">performance.timing.domComplete - performance.timing.navigationStart;</span>
};

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4" aria-hidden="true">#</a> \u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4</h3><p><strong>\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4\u548C\u9996\u9875\u52A0\u8F7D\u65F6\u95F4\u4E0D\u4E00\u6837</strong>\uFF0C\u9996\u5C4F\u6307\u7684\u662F\u7528\u6237\u770B\u5230\u5C4F\u5E55\u5185\u9875\u9762\u6E32\u67D3\u5B8C\u6210\u7684\u65F6\u95F4</p><p>\u6BD4\u5982\u9996\u9875\u5F88\u957F\u9700\u8981\u597D\u51E0\u5C4F\u5C55\u793A\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E0B\u5C4F\u5E55\u4EE5\u5916\u7684\u5143\u7D20\u4E0D\u8003\u8651\u5728\u5185</p><p><strong>\u8BA1\u7B97\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4\u6D41\u7A0B</strong></p><p>1\uFF09\u5229\u7528<code>MutationObserver</code>\u76D1\u542C<code>document</code>\u5BF9\u8C61\uFF0C\u6BCF\u5F53 dom \u53D8\u5316\u65F6\u89E6\u53D1\u8BE5\u4E8B\u4EF6</p><p>2\uFF09\u5224\u65AD\u76D1\u542C\u7684 dom \u662F\u5426\u5728\u9996\u5C4F\u5185\uFF0C\u5982\u679C\u5728\u9996\u5C4F\u5185\uFF0C\u5C06\u8BE5 dom \u653E\u5230\u6307\u5B9A\u7684\u6570\u7EC4\u4E2D\uFF0C\u8BB0\u5F55\u4E0B\u5F53\u524D dom \u53D8\u5316\u7684\u65F6\u95F4\u70B9</p><p>3\uFF09\u5728 MutationObserver \u7684 callback \u51FD\u6570\u4E2D\uFF0C\u901A\u8FC7\u9632\u6296\u51FD\u6570\uFF0C\u76D1\u542C<code>document.readyState</code>\u72B6\u6001\u7684\u53D8\u5316</p><p>4\uFF09\u5F53<code>document.readyState === &#39;complete&#39;</code>\uFF0C\u505C\u6B62\u5B9A\u65F6\u5668\u548C \u53D6\u6D88\u5BF9 document \u7684\u76D1\u542C</p><p>5\uFF09\u904D\u5386\u5B58\u653E dom \u7684\u6570\u7EC4\uFF0C\u627E\u51FA\u6700\u540E\u53D8\u5316\u8282\u70B9\u7684\u65F6\u95F4\uFF0C\u7528\u8BE5\u65F6\u95F4\u70B9\u51CF\u53BB<code>performance.timing.navigationStart</code> \u5F97\u51FA\u9996\u5C4F\u7684\u52A0\u8F7D\u65F6\u95F4</p><p><strong>\u5B9A\u4E49 performance.js</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>// firstScreenPaint\u4E3A\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4\u7684\u53D8\u91CF
<span class="token key attr-name">let firstScreenPaint</span> <span class="token punctuation">=</span> <span class="token value attr-value">0;</span>
// \u9875\u9762\u662F\u5426\u6E32\u67D3\u5B8C\u6210
<span class="token key attr-name">let isOnLoaded</span> <span class="token punctuation">=</span> <span class="token value attr-value">false;</span>
let timer;
let observer;

<span class="token key attr-name">// \u5B9A\u65F6\u5668\u5FAA\u73AF\u76D1\u542Cdom\u7684\u53D8\u5316\uFF0C\u5F53document.readyState</span> <span class="token punctuation">=</span><span class="token value attr-value">== &#39;complete&#39;\u65F6\uFF0C\u505C\u6B62\u76D1\u542C</span>
function checkDOMChange(callback) {
  cancelAnimationFrame(timer);
  <span class="token key attr-name">timer</span> <span class="token punctuation">=</span> <span class="token value attr-value">requestAnimationFrame(() =&gt; {</span>
    <span class="token key attr-name">if (document.readyState</span> <span class="token punctuation">=</span><span class="token value attr-value">== &#39;complete&#39;) {</span>
      <span class="token key attr-name">isOnLoaded</span> <span class="token punctuation">=</span> <span class="token value attr-value">true;</span>
    }
    if (isOnLoaded) {
      // \u53D6\u6D88\u76D1\u542C
      observer &amp;&amp; observer.disconnect();

      <span class="token key attr-name">// document.readyState</span> <span class="token punctuation">=</span><span class="token value attr-value">== &#39;complete&#39;\u65F6\uFF0C\u8BA1\u7B97\u9996\u5C4F\u6E32\u67D3\u65F6\u95F4</span>
      <span class="token key attr-name">firstScreenPaint</span> <span class="token punctuation">=</span> <span class="token value attr-value">getRenderTime();</span>
      <span class="token key attr-name">entries</span> <span class="token punctuation">=</span> <span class="token value attr-value">null;</span>

      // \u6267\u884C\u7528\u6237\u4F20\u5165\u7684callback\u51FD\u6570
      callback &amp;&amp; callback(firstScreenPaint);
    } else {
      checkDOMChange();
    }
  });
}
function getRenderTime() {
  <span class="token key attr-name">let startTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">0;</span>
  <span class="token key attr-name">entries.forEach((entry)</span> <span class="token punctuation">=</span><span class="token value attr-value">&gt; {</span>
    if (entry.startTime &gt; startTime) {
      <span class="token key attr-name">startTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">entry.startTime;</span>
    }
  });
  // performance.timing.navigationStart \u9875\u9762\u7684\u8D77\u59CB\u65F6\u95F4
  return startTime - performance.timing.navigationStart;
}
<span class="token key attr-name">const viewportWidth</span> <span class="token punctuation">=</span> <span class="token value attr-value">window.innerWidth;</span>
<span class="token key attr-name">const viewportHeight</span> <span class="token punctuation">=</span> <span class="token value attr-value">window.innerHeight;</span>
// dom \u5BF9\u8C61\u662F\u5426\u5728\u5C4F\u5E55\u5185
function isInScreen(dom) {
  <span class="token key attr-name">const rectInfo</span> <span class="token punctuation">=</span> <span class="token value attr-value">dom.getBoundingClientRect();</span>
  if (rectInfo.left &lt; viewportWidth &amp;&amp; rectInfo.top &lt; viewportHeight) {
    return true;
  }
  return false;
}
<span class="token key attr-name">let entries</span> <span class="token punctuation">=</span> <span class="token value attr-value">[];</span>

// \u5916\u90E8\u901A\u8FC7callback \u62FF\u5230\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4
export default function observeFirstScreenPaint(callback) {
  <span class="token key attr-name">const ignoreDOMList</span> <span class="token punctuation">=</span> <span class="token value attr-value">[&#39;STYLE&#39;, &#39;SCRIPT&#39;, &#39;LINK&#39;];</span>
  <span class="token key attr-name">observer</span> <span class="token punctuation">=</span> <span class="token value attr-value">new window.MutationObserver((mutationList) =&gt; {</span>
    checkDOMChange(callback);
    <span class="token key attr-name">const entry</span> <span class="token punctuation">=</span> <span class="token value attr-value">{ children: [] };</span>
    for (const mutation of mutationList) {
      if (mutation.addedNodes.length &amp;&amp; isInScreen(mutation.target)) {
        for (const node of mutation.addedNodes) {
          // \u5FFD\u7565\u6389\u4EE5\u4E0A\u6807\u7B7E\u7684\u53D8\u5316
          <span class="token key attr-name">if (node.nodeType</span> <span class="token punctuation">=</span><span class="token value attr-value">== 1 &amp;&amp; !ignoreDOMList.includes(node.tagName) &amp;&amp; isInScreen(node)) {</span>
            entry.children.push(node);
          }
        }
      }
    }

    if (entry.children.length) {
      entries.push(entry);
      <span class="token key attr-name">entry.startTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">new Date().getTime();</span>
    }
  });
  observer.observe(document, {
    childList: true, // \u76D1\u542C\u6DFB\u52A0\u6216\u5220\u9664\u5B50\u8282\u70B9
    subtree: true, // \u76D1\u542C\u6574\u4E2A\u5B50\u6811
    characterData: true, // \u76D1\u542C\u5143\u7D20\u7684\u6587\u672C\u662F\u5426\u53D8\u5316
    attributes: true // \u76D1\u542C\u5143\u7D20\u7684\u5C5E\u6027\u662F\u5426\u53D8\u5316
  });
}


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5916\u90E8\u5F15\u5165\u4F7F\u7528</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> observeFirstScreenPaint <span class="token keyword">from</span> <span class="token string">&quot;./performance&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// \u901A\u8FC7\u56DE\u8C03\u51FD\u6570\uFF0C\u62FF\u5230\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4</span>
<span class="token function">observeFirstScreenPaint</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&quot;\u9996\u5C4F\u52A0\u8F7D\u65F6\u95F4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="dom-\u6E32\u67D3\u65F6\u95F4\u548C-window-onload-\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#dom-\u6E32\u67D3\u65F6\u95F4\u548C-window-onload-\u65F6\u95F4" aria-hidden="true">#</a> DOM \u6E32\u67D3\u65F6\u95F4\u548C window.onload \u65F6\u95F4</h3><p>DOM \u7684\u6E32\u67D3\u7684\u65F6\u95F4\u548C window.onload \u6267\u884C\u7684\u65F6\u95F4\u4E0D\u662F\u4E00\u56DE\u4E8B</p><p><strong>DOM \u6E32\u67D3\u7684\u65F6\u95F4</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DOM\u6E32\u67D3\u7684\u65F6\u95F4 =  performance.timing.domComplete - performance.timing.domLoading

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>window.onload \u8981\u665A\u4E8E DOM \u7684\u6E32\u67D3\uFF0Cwindow.onload \u662F\u9875\u9762\u4E2D\u6240\u6709\u7684\u8D44\u6E90\u90FD\u52A0\u8F7D\u540E\u624D\u6267\u884C\uFF08\u5305\u62EC\u56FE\u7247\u7684\u52A0\u8F7D\uFF09</p><p><strong>window.onload \u7684\u65F6\u95F4</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>onload\u7684\u65F6\u95F4 <span class="token operator">=</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>loadEventEnd<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u8BA1\u7B97\u8D44\u6E90\u7684\u7F13\u5B58\u547D\u4E2D\u7387" tabindex="-1"><a class="header-anchor" href="#\u8BA1\u7B97\u8D44\u6E90\u7684\u7F13\u5B58\u547D\u4E2D\u7387" aria-hidden="true">#</a> \u8BA1\u7B97\u8D44\u6E90\u7684\u7F13\u5B58\u547D\u4E2D\u7387</h3><p><strong>\u7F13\u5B58\u547D\u4E2D\u7387\uFF1A\u4ECE\u7F13\u5B58\u4E2D\u5F97\u5230\u6570\u636E\u7684\u8BF7\u6C42\u6570\u4E0E\u6240\u6709\u8BF7\u6C42\u6570\u7684\u6BD4\u7387</strong></p><p>\u7406\u60F3\u72B6\u6001\u662F\u7F13\u5B58\u547D\u4E2D\u7387\u8D8A\u9AD8\u8D8A\u597D\uFF0C\u7F13\u5B58\u547D\u4E2D\u7387\u8D8A\u9AD8\u8BF4\u660E\u7F51\u7AD9\u7684\u7F13\u5B58\u7B56\u7565\u8D8A\u6709\u6548\uFF0C\u7528\u6237\u6253\u5F00\u9875\u9762\u7684\u901F\u5EA6\u4E5F\u4F1A\u76F8\u5E94\u63D0\u9AD8</p><p><strong>\u5982\u4F55\u5224\u65AD\u8BE5\u8D44\u6E90\u662F\u5426\u547D\u4E2D\u7F13\u5B58\uFF1F</strong></p><p>1\uFF09\u901A\u8FC7<code>performance.getEntries()</code>\u627E\u5230\u6240\u6709\u8D44\u6E90\u7684\u4FE1\u606F</p><p>2\uFF09\u5728\u8FD9\u4E9B\u8D44\u6E90\u5BF9\u8C61\u4E2D\u6709\u4E00\u4E2A<code>transferSize</code> \u5B57\u6BB5\uFF0C\u5B83\u8868\u793A\u83B7\u53D6\u8D44\u6E90\u7684\u5927\u5C0F\uFF0C\u5305\u62EC\u54CD\u5E94\u5934\u5B57\u6BB5\u548C\u54CD\u5E94\u6570\u636E\u7684\u5927\u5C0F</p><p>3\uFF09\u5982\u679C\u8FD9\u4E2A\u503C\u4E3A 0\uFF0C\u8BF4\u660E\u662F\u4ECE\u7F13\u5B58\u4E2D\u76F4\u63A5\u8BFB\u53D6\u7684\uFF08\u5F3A\u5236\u7F13\u5B58\uFF09</p><p>4\uFF09\u5982\u679C\u8FD9\u4E2A\u503C\u4E0D\u4E3A 0\uFF0C\u4F46\u662F<code>encodedBodySize</code> \u5B57\u6BB5\u4E3A 0\uFF0C\u8BF4\u660E\u5B83\u8D70\u7684\u662F\u534F\u5546\u7F13\u5B58\uFF08<code>encodedBodySize \u8868\u793A\u8BF7\u6C42\u54CD\u5E94\u6570\u636E body \u7684\u5927\u5C0F</code>\uFF09</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isCache</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u76F4\u63A5\u4ECE\u7F13\u5B58\u8BFB\u53D6\u6216 304</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    entry<span class="token punctuation">.</span>transferSize <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>transferSize <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> entry<span class="token punctuation">.</span>encodedBodySize <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5C06<code>\u6240\u6709\u547D\u4E2D\u7F13\u5B58\u7684\u6570\u636E / \u603B\u6570\u636E</code> \u5C31\u80FD\u5F97\u51FA<code>\u7F13\u5B58\u547D\u4E2D\u7387</code></strong></p><h3 id="\u6027\u80FD\u6570\u636E\u4E0A\u62A5" tabindex="-1"><a class="header-anchor" href="#\u6027\u80FD\u6570\u636E\u4E0A\u62A5" aria-hidden="true">#</a> \u6027\u80FD\u6570\u636E\u4E0A\u62A5</h3><p><strong>\u4E0A\u62A5\u65B9\u5F0F</strong></p><p>\u4E00\u822C\u4F7F\u7528<code>\u56FE\u7247\u6253\u70B9</code>\u7684\u65B9\u5F0F\uFF0C\u901A\u8FC7\u52A8\u6001\u521B\u5EFA img \u6807\u7B7E\u7684\u65B9\u5F0F\uFF0Cnew \u51FA\u50CF\u7D20\u4E3A<code>1x1 px</code>\u7684<code>gif Image</code>\uFF08gif \u4F53\u79EF\u6700\u5C0F\uFF09\u5BF9\u8C61\u5C31\u80FD\u53D1\u8D77\u8BF7\u6C42\uFF0C\u53EF\u4EE5\u8DE8\u57DF\u3001\u4E0D\u9700\u8981\u7B49\u5F85\u670D\u52A1\u5668\u8FD4\u56DE\u6570\u636E</p><p><strong>\u4E0A\u62A5\u65F6\u673A</strong></p><p>\u53EF\u4EE5\u5229\u7528<code>requestIdleCallback</code>\uFF0C\u6D4F\u89C8\u5668\u7A7A\u95F2\u7684\u65F6\u5019\u4E0A\u62A5\uFF0C\u597D\u5904\u662F\uFF1A\u4E0D\u963B\u585E\u5176\u4ED6\u6D41\u7A0B\u7684\u8FDB\u884C</p><p>\u5982\u679C\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u8BE5<code>requestIdleCallback</code>\uFF0C\u5C31\u4F7F\u7528<code>setTimeout</code>\u4E0A\u62A5</p><div class="language-scss ext-scss line-numbers-mode"><pre class="language-scss"><code><span class="token comment">// \u4F18\u5148\u4F7F\u7528requestIdleCallback</span>
if <span class="token punctuation">(</span>window.requestIdleCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window.<span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token selector">=&gt; </span><span class="token punctuation">{</span>
      <span class="token comment">// \u83B7\u53D6\u6D4F\u89C8\u5668\u7684\u5269\u4F59\u7A7A\u95F2\u65F6\u95F4</span>
      console.<span class="token function">log</span><span class="token punctuation">(</span>deadline.<span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">report</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u4E0A\u62A5\u6570\u636E</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// timeout\u8BBE\u7F6E\u4E3A1000\uFF0C\u5982\u679C\u57281000ms\u5185\u6CA1\u6709\u6267\u884C\u8BE5\u540E\u8C03\uFF0C\u5728\u4E0B\u6B21\u7A7A\u95F2\u65F6\u95F4\u65F6\uFF0Ccallback\u4F1A\u5F3A\u5236\u6267\u884C</span>
    <span class="token punctuation">{</span> <span class="token property">timeout</span><span class="token punctuation">:</span> 1000 <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token selector">else </span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token selector">=&gt; </span><span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u4E0A\u62A5\u6570\u636E</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5185\u5B58\u5206\u6790\u4E0E\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u5206\u6790\u4E0E\u4F18\u5316" aria-hidden="true">#</a> \u5185\u5B58\u5206\u6790\u4E0E\u4F18\u5316</h2><p>\u6027\u80FD\u5206\u6790\u5F88\u706B\uFF0C\u4F46\u5185\u5B58\u5206\u6790\u76F8\u6BD4\u5C31\u4F4E\u8C03\u5F88\u591A\u4E86</p><p>\u4E3E\u4E00\u4E2A\u6211\u4E4B\u524D\u9047\u5230\u7684\u60C5\u51B5\uFF0C\u5BA2\u6237\u7535\u8111\u914D\u7F6E\u4F4E\uFF0C\u6253\u5F00\u516C\u53F8\u5F00\u53D1\u7684\u9875\u9762\uFF0C\u7ECF\u5E38\u51FA\u73B0\u9875\u9762\u5D29\u6E83</p><p>\u8C03\u67E5\u539F\u56E0\uFF0C\u5C31\u662F\u56E0\u4E3A\u9875\u9762\u5185\u5B58\u5360\u7528\u592A\u5927\uFF0C\u5BA2\u6237\u6253\u5F00\u51E0\u4E2A\u9875\u9762\u540E\uFF0C\u5185\u5B58\u76F4\u63A5\u62C9\u6EE1\uFF0C\u4E5F\u662F\u7ECF\u8FC7\u8FD9\u4EF6\u4E8B\uFF0C\u6211\u5F00\u59CB\u91CD\u89C6\u5185\u5B58\u5206\u6790\u4E0E\u4F18\u5316</p><p>\u4E0B\u9762\uFF0C\u804A\u4E00\u804A\u5185\u5B58\u8FD9\u5757\u6709\u54EA\u4E9B\u77E5\u8BC6</p><h3 id="memory-\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#memory-\u5DE5\u5177" aria-hidden="true">#</a> Memory \u5DE5\u5177</h3><p>Memory \u5DE5\u5177\uFF0C\u901A\u8FC7<code>\u5185\u5B58\u5FEB\u7167</code>\u7684\u65B9\u5F0F\uFF0C\u5206\u6790\u5F53\u524D\u9875\u9762\u7684\u5185\u5B58\u4F7F\u7528\u60C5\u51B5</p><p><strong>Memory \u5DE5\u5177\u4F7F\u7528\u6D41\u7A0B</strong></p><p>1\uFF09\u6253\u5F00 chrome \u6D4F\u89C8\u5668\u63A7\u5236\u53F0\uFF0C\u9009\u62E9<code>Memory</code>\u5DE5\u5177</p><p>2\uFF09\u70B9\u51FB\u5DE6\u4FA7<code>start\u6309\u94AE</code>\uFF0C\u5237\u65B0\u9875\u9762\uFF0C\u5F00\u59CB\u5F55\u5236\u7684<code>JS\u5806\u52A8\u6001\u5206\u914D\u65F6\u95F4\u7EBF</code>\uFF0C\u4F1A\u751F\u6210\u9875\u9762\u52A0\u8F7D\u8FC7\u7A0B\u5185\u5B58\u53D8\u5316\u7684\u67F1\u72B6\u7EDF\u8BA1\u56FE\uFF08\u84DD\u8272\u8868\u793A\u672A\u56DE\u6536\uFF0C\u7070\u8272\u8868\u793A\u5DF2\u56DE\u6536\uFF09</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aab5505602aa45498105fed8b8b20806~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="memory.jpg"></p><p><strong>Memory \u5DE5\u5177\u4E2D\u7684\u5173\u952E\u9879</strong></p><p><strong>\u5173\u952E\u9879</strong></p><p>Constructor\uFF1A\u5BF9\u8C61\u7684\u7C7B\u540D\uFF1B Distance\uFF1A\u5BF9\u8C61\u5230\u6839\u7684\u5F15\u7528\u5C42\u7EA7\uFF1B Objects Count\uFF1A\u5BF9\u8C61\u7684\u6570\u91CF\uFF1B Shallow Size\uFF1A \u5BF9\u8C61\u672C\u8EAB\u5360\u7528\u7684\u5185\u5B58\uFF0C\u4E0D\u5305\u62EC\u5F15\u7528\u7684\u5BF9\u8C61\u6240\u5360\u5185\u5B58\uFF1B Retained Size\uFF1A \u5BF9\u8C61\u6240\u5360\u603B\u5185\u5B58\uFF0C\u5305\u542B\u5F15\u7528\u7684\u5176\u4ED6\u5BF9\u8C61\u6240\u5360\u5185\u5B58\uFF1B Retainers\uFF1A\u5BF9\u8C61\u7684\u5F15\u7528\u5C42\u7EA7\u5173\u7CFB</p><p><strong>\u901A\u8FC7\u4E00\u6BB5\u6D4B\u8BD5\u4EE3\u7801\u6765\u4E86\u89E3 Memory \u5DE5\u5177\u5404\u5173\u952E\u6027\u7684\u5173\u7CFB</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u6D4B\u8BD5\u4EE3\u7801</span>
<span class="token keyword">class</span> <span class="token class-name">Jane</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Tom</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>jane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Tom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a05c8093ada4d19a71a78c225b7e013~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="cpudemo.jpg"></p><p>shallow size \u548C retained size \u7684\u533A\u522B\uFF0C\u4EE5\u7528\u7EA2\u6846\u91CC\u7684 <code>Tom</code> \u548C <code>Jane</code> \u66F4\u76F4\u89C2\u7684\u5C55\u793A</p><p>Tom \u7684 shallow \u5360\u4E86 32M\uFF0Cretained \u5360\u7528\u4E86 56M\uFF0C\u8FD9\u662F\u56E0\u4E3A retained \u5305\u62EC\u4E86\u5F15\u7528\u7684\u6307\u9488\u5BF9\u5E94\u7684\u5185\u5B58\u5927\u5C0F\uFF0C\u5373 <code>tom.jane</code> \u6240\u5360\u7528\u7684\u5185\u5B58</p><p>\u6240\u4EE5 Tom \u7684 retained \u603B\u548C\u6BD4 shallow \u591A\u51FA\u6765\u7684 24M\uFF0C\u6B63\u597D\u8DDF Jane \u5360\u7528\u7684 24M \u76F8\u540C</p><p>retained size \u53EF\u4EE5\u7406\u89E3\u4E3A\u5F53\u56DE\u6536\u6389\u8BE5\u5BF9\u8C61\u65F6\u53EF\u4EE5\u91CA\u653E\u7684\u5185\u5B58\u5927\u5C0F\uFF0C\u5728\u5185\u5B58\u8C03\u4F18\u4E2D\u5177\u6709\u91CD\u8981\u53C2\u8003\u610F\u4E49</p><h3 id="\u5185\u5B58\u5206\u6790\u7684\u5173\u952E\u70B9" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u5206\u6790\u7684\u5173\u952E\u70B9" aria-hidden="true">#</a> \u5185\u5B58\u5206\u6790\u7684\u5173\u952E\u70B9</h3><p>\u627E\u5230\u5185\u5B58\u6700\u9AD8\u7684\u8282\u70B9\uFF0C\u5206\u6790\u8FD9\u4E9B\u65F6\u523B\u6267\u884C\u4E86\u54EA\u4E9B\u4EE3\u7801\uFF0C\u53D1\u751F\u4E86\u4EC0\u4E48\u64CD\u4F5C\uFF0C\u5C3D\u53EF\u80FD\u53BB\u4F18\u5316\u5B83\u4EEC</p><p>1\uFF09\u4ECE\u67F1\u72B6\u56FE\u4E2D\u627E\u5230\u6700\u9AD8\u7684\u70B9\uFF0C\u91CD\u70B9\u5206\u6790\u8BE5\u65F6\u95F4\u5185\u9020\u6210\u5185\u5B58\u53D8\u5927\u7684\u539F\u56E0</p><p>2\uFF09\u6309\u7167<code>Retainers size</code>\uFF08\u603B\u5185\u5B58\u5927\u5C0F\uFF09\u6392\u5E8F\uFF0C\u70B9\u51FB\u5C55\u5F00\u5185\u5B58\u6700\u9AD8\u7684\u54EA\u4E00\u9879\uFF0C\u70B9\u51FB\u5C55\u5F00\u6784\u9020\u51FD\u6570\uFF0C\u53EF\u4EE5\u770B\u5230\u6240\u6709\u6784\u9020\u51FD\u6570\u76F8\u5173\u7684\u5BF9\u8C61\u5B9E\u4F8B</p><p>3\uFF09\u9009\u4E2D\u6784\u9020\u51FD\u6570\uFF0C\u5E95\u90E8\u4F1A\u663E\u793A\u5BF9\u5E94\u6E90\u7801\u6587\u4EF6\uFF0C\u70B9\u51FB\u6E90\u7801\u6587\u4EF6\uFF0C\u53EF\u4EE5\u8DF3\u8F6C\u5230\u5177\u4F53\u7684\u4EE3\u7801\uFF0C\u8FD9\u6837\u6211\u4EEC\u5C31\u77E5\u9053\u662F\u54EA\u91CC\u7684\u4EE3\u7801\u9020\u6210\u5185\u5B58\u8FC7\u5927</p><p>4\uFF09\u7ED3\u5408\u5177\u4F53\u7684\u4EE3\u7801\u903B\u8F91\uFF0C\u6765\u5224\u65AD\u8FD9\u5757\u5185\u5B58\u53D8\u5927\u7684\u539F\u56E0\uFF0C\u91CD\u70B9\u662F\u5982\u4F55\u53BB\u4F18\u5316\u5B83\u4EEC\uFF0C\u964D\u4F4E\u5185\u5B58\u7684\u4F7F\u7528\u5927\u5C0F</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f4655f8d064457ba2624c9806d7a094~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="retainedSize.jpg"></p><p><strong>\u70B9\u51FB<code>keyghost.js</code>\u53EF\u4EE5\u8DF3\u8F6C\u5230\u5177\u4F53\u7684\u6E90\u7801</strong></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/080b6071cd4946729a3bc68c22a588e8~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="localkey.png"></p><h3 id="\u5185\u5B58\u6CC4\u9732\u7684\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u6CC4\u9732\u7684\u60C5\u51B5" aria-hidden="true">#</a> \u5185\u5B58\u6CC4\u9732\u7684\u60C5\u51B5</h3><p>1\uFF09\u610F\u5916\u7684\u5168\u5C40\u53D8\u91CF\uFF0C \u6302\u8F7D\u5230 window \u4E0A\u5168\u5C40\u53D8\u91CF 2\uFF09\u9057\u5FD8\u7684\u5B9A\u65F6\u5668\uFF0C\u5B9A\u65F6\u5668\u6CA1\u6709\u6E05\u9664 3\uFF09\u95ED\u5305\u4E0D\u5F53\u7684\u4F7F\u7528</p><h3 id="\u5185\u5B58\u5206\u6790\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u5206\u6790\u603B\u7ED3" aria-hidden="true">#</a> \u5185\u5B58\u5206\u6790\u603B\u7ED3</h3><p>1\uFF09\u5229\u7528 Memory \u5DE5\u5177\uFF0C\u4E86\u89E3\u9875\u9762\u6574\u4F53\u7684\u5185\u5B58\u4F7F\u7528\u60C5\u51B5</p><p>2\uFF09\u901A\u8FC7 JS \u5806\u52A8\u6001\u5206\u914D\u65F6\u95F4\u7EBF\uFF0C\u627E\u5230\u5185\u5B58\u6700\u9AD8\u7684\u65F6\u523B</p><p>3\uFF09\u6309\u7167 Retainers size\uFF08\u603B\u5185\u5B58\u5927\u5C0F\uFF09\u6392\u5E8F\uFF0C\u70B9\u51FB\u5C55\u5F00\u5185\u5B58\u6700\u9AD8\u7684\u524D\u51E0\u9879\uFF0C\u5206\u6790\u7531\u4E8E\u54EA\u4E2A\u51FD\u6570\u64CD\u4F5C\u5BFC\u81F4\u4E86\u5185\u5B58\u8FC7\u5927\uFF0C\u751A\u81F3\u662F\u5185\u5B58\u6CC4\u9732</p><p>4\uFF09\u7ED3\u5408\u5177\u4F53\u7684\u4EE3\u7801\uFF0C\u53BB\u89E3\u51B3\u6216\u4F18\u5316\u5185\u5B58\u53D8\u5927\u7684\u60C5\u51B5</p>`,111),on={href:"https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fc11073138%2Farticle%2Fdetails%2F84700482",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fc11073138%2Farticle%2Fdetails%2F84728132%3Fspm%3D1001.2014.3001.5502",target:"_blank",rel:"noopener noreferrer"},ln={href:"https://juejin.cn/post/6844904038064979981",target:"_blank",rel:"noopener noreferrer"},un=e('<h2 id="\u9879\u76EE\u4F18\u5316\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u9879\u76EE\u4F18\u5316\u603B\u7ED3" aria-hidden="true">#</a> \u9879\u76EE\u4F18\u5316\u603B\u7ED3</h2><p><strong>\u4F18\u5316\u7684\u672C\u8D28\uFF1A\u54CD\u5E94\u66F4\u5FEB\uFF0C\u5C55\u793A\u66F4\u5FEB</strong></p><p>\u66F4\u8BE6\u7EC6\u7684\u8BF4\uFF0C\u662F\u6307\u5728\u7528\u6237\u8F93\u5165 url\uFF0C\u5230\u9875\u9762\u5B8C\u6574\u5C55\u793A\u51FA\u6765\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u901A\u8FC7\u5404\u79CD\u4F18\u5316\u7B56\u7565\u548C\u65B9\u6CD5\uFF0C\u8BA9\u9875\u9762\u52A0\u8F7D\u66F4\u5FEB\uFF1B\u5728\u7528\u6237\u4F7F\u7528\u8FC7\u7A0B\u4E2D\uFF0C\u8BA9\u7528\u6237\u7684\u64CD\u4F5C\u54CD\u5E94\u66F4\u53CA\u65F6\uFF0C\u6709\u66F4\u597D\u7684\u7528\u6237\u4F53\u9A8C</p><h3 id="\u7ECF\u5178-\u96C5\u864E\u519B\u89C4" tabindex="-1"><a class="header-anchor" href="#\u7ECF\u5178-\u96C5\u864E\u519B\u89C4" aria-hidden="true">#</a> \u7ECF\u5178\uFF1A\u96C5\u864E\u519B\u89C4</h3><p>\u5F88\u591A\u524D\u7AEF\u4F18\u5316\u51C6\u5219\u90FD\u662F\u56F4\u7ED5\u7740\u8FD9\u4E2A\u5C55\u5F00</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f752944cbfe742449b12fef3056c4b43~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="\u96C5\u864E35\u6761\u519B\u89C4.jpg"></p><h3 id="\u4F18\u5316\u5EFA\u8BAE" tabindex="-1"><a class="header-anchor" href="#\u4F18\u5316\u5EFA\u8BAE" aria-hidden="true">#</a> \u4F18\u5316\u5EFA\u8BAE</h3><p>\u7ED3\u5408\u6211\u66FE\u7ECF\u8D1F\u8D23\u4F18\u5316\u7684\u9879\u76EE\u5B9E\u8DF5\uFF0C\u5728\u4E0B\u9762\u603B\u7ED3\u4E86\u4E00\u4E9B\u7ECF\u9A8C\u4E0E\u65B9\u6CD5\uFF0C\u63D0\u4F9B\u7ED9\u5927\u5BB6\u53C2\u8003</p><h4 id="_1\u3001\u5206\u6790\u6253\u5305\u540E\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u5206\u6790\u6253\u5305\u540E\u7684\u6587\u4EF6" aria-hidden="true">#</a> 1\u3001\u5206\u6790\u6253\u5305\u540E\u7684\u6587\u4EF6</h4>',9),rn={href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fwebpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"},dn=e(`<p>\u6211\u4EEC\u8981\u6E05\u695A\u7684\u77E5\u9053\u9879\u76EE\u4E2D\u4F7F\u7528\u4E86\u54EA\u4E9B\u4E09\u65B9\u4F9D\u8D56\uFF0C\u4EE5\u53CA\u4F9D\u8D56\u7684\u4F5C\u7528\u3002\u7279\u522B\u5BF9\u4E8E\u4F53\u79EF\u5927\u7684\u4F9D\u8D56\uFF0C\u5206\u6790\u662F\u5426\u80FD\u4F18\u5316</p><p>\u6BD4\u5982\uFF1A\u7EC4\u4EF6\u5E93\u5982<code>elementUI</code>\u7684\u6309\u9700\u5F15\u5165\u3001<code>Swiper\u8F6E\u64AD\u56FE</code>\u7EC4\u4EF6\u6253\u5305\u540E\u7684\u4F53\u79EF\u7EA6 200k\uFF0C\u770B\u662F\u5426\u80FD\u66FF\u6362\u6210\u4F53\u79EF\u66F4\u5C0F\u7684\u63D2\u4EF6\u3001<code>momentjs</code>\u53BB\u6389\u65E0\u7528\u7684\u8BED\u8A00\u5305\u7B49</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ee7ed860fbd435187629e41cafb4ca6~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="vendors.png"></p><h4 id="_2\u3001\u5408\u7406\u5904\u7406\u516C\u5171\u8D44\u6E90" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u5408\u7406\u5904\u7406\u516C\u5171\u8D44\u6E90" aria-hidden="true">#</a> 2\u3001\u5408\u7406\u5904\u7406\u516C\u5171\u8D44\u6E90</h4><p>\u5982\u679C\u9879\u76EE\u652F\u6301 CDN\uFF0C\u53EF\u4EE5\u914D\u7F6E<code>externals</code>\uFF0C\u5C06<code>Vue\u3001Vue-router\u3001Vuex\u3001echarts</code>\u7B49\u516C\u5171\u8D44\u6E90\uFF0C\u901A\u8FC7 CDN \u7684\u65B9\u5F0F\u5F15\u5165\uFF0C\u4E0D\u6253\u5230\u9879\u76EE\u91CC\u8FB9</p><p>\u5982\u679C\u9879\u76EE\u4E0D\u652F\u6301 CDN\uFF0C\u53EF\u4EE5\u4F7F\u7528<code>DllPlugin</code>\u52A8\u6001\u94FE\u63A5\u5E93\uFF0C\u5C06\u4E1A\u52A1\u4EE3\u7801\u548C\u516C\u5171\u8D44\u6E90\u4EE3\u7801\u76F8\u5206\u79BB\uFF0C\u516C\u5171\u8D44\u6E90\u5355\u72EC\u6253\u5305\uFF0C\u7ED9\u8FD9\u4E9B\u516C\u5171\u8D44\u6E90\u8BBE\u7F6E\u5F3A\u7F13\u5B58\uFF08\u516C\u5171\u8D44\u6E90\u57FA\u672C\u4E0D\u4F1A\u53D8\uFF09\uFF0C\u8FD9\u6837\u4EE5\u540E\u53EF\u4EE5\u53EA\u6253\u5305\u4E1A\u52A1\u4EE3\u7801\uFF0C\u63D0\u5347\u6253\u5305\u901F\u5EA6</p><h4 id="_3\u3001\u9996\u5C4F\u5FC5\u8981\u8D44\u6E90-preload-\u9884\u52A0\u8F7D-\u548C-dns-\u9884\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#_3\u3001\u9996\u5C4F\u5FC5\u8981\u8D44\u6E90-preload-\u9884\u52A0\u8F7D-\u548C-dns-\u9884\u89E3\u6790" aria-hidden="true">#</a> 3\u3001\u9996\u5C4F\u5FC5\u8981\u8D44\u6E90 preload \u9884\u52A0\u8F7D \u548C DNS \u9884\u89E3\u6790</h4><p><strong>preload \u9884\u52A0\u8F7D</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;link rel=&quot;preload&quot; href=&quot;/path/style.css&quot; as=&quot;style&quot;&gt;\`
\`&lt;link rel=&quot;preload&quot; href=&quot;/path/home.js&quot; as=&quot;script&quot;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>preload \u9884\u52A0\u8F7D\u662F\u544A\u8BC9\u6D4F\u89C8\u5668\u9875\u9762\u5FC5\u5B9A\u9700\u8981\u7684\u8D44\u6E90\uFF0C\u6D4F\u89C8\u5668\u4F1A\u4F18\u5148\u52A0\u8F7D\u8FD9\u4E9B\u8D44\u6E90\uFF1B\u4F7F\u7528 link \u6807\u7B7E\u521B\u5EFA\uFF08vue \u9879\u76EE\u6253\u5305\u540E\uFF0C\u4F1A\u5C06\u9996\u9875\u6240\u7528\u5230\u7684\u8D44\u6E90\u90FD\u52A0\u4E0A preload\uFF09</p><p>\u6CE8\u610F\uFF1Apreload \u53EA\u662F\u9884\u52A0\u8F7D\u8D44\u6E90\uFF0C\u4F46\u4E0D\u4F1A\u6267\u884C\uFF0C\u8FD8\u9700\u8981\u5F15\u5165\u5177\u4F53\u7684\u6587\u4EF6\u540E\u624D\u4F1A\u6267\u884C <code>&lt;script src=&#39;/path/home.js&#39;&gt;</code></p><p><strong>DNS \u9884\u89E3\u6790</strong></p><p><code>DNS Prefetch</code> \u662F\u4E00\u79CD DNS \u9884\u89E3\u6790\u6280\u672F\uFF0C\u5F53\u4F60\u6D4F\u89C8\u7F51\u9875\u65F6\uFF0C\u6D4F\u89C8\u5668\u4F1A\u5728\u52A0\u8F7D\u7F51\u9875\u65F6\uFF0C\u5BF9\u7F51\u9875\u4E2D\u7684\u57DF\u540D\u8FDB\u884C\u89E3\u6790\u7F13\u5B58</p><p>\u8FD9\u6837\u5728\u4F60\u5355\u51FB\u5F53\u524D\u7F51\u9875\u4E2D\u7684\u8FDE\u63A5\u65F6\u5C31\u65E0\u9700\u8FDB\u884C<code>DNS</code> \u7684\u89E3\u6790\uFF0C\u51CF\u5C11\u7528\u6237\u7B49\u5F85\u65F6\u95F4\uFF0C\u63D0\u9AD8\u7528\u6237\u4F53\u9A8C</p><p>\u4F7F\u7528<code>dns-prefetch</code>\uFF0C\u5982<code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//img1.taobao.com&quot;&gt;</code></p><p>\u5F88\u591A\u5927\u578B\u7684\u7F51\u7AD9\uFF0C\u90FD\u4F1A\u7528<code>N</code> \u4E2A<code>CDN</code> \u57DF\u540D\u6765\u505A\u56FE\u7247\u3001\u9759\u6001\u6587\u4EF6\u7B49\u8D44\u6E90\u8BBF\u95EE\u3002\u89E3\u6790\u5355\u4E2A\u57DF\u540D\u540C\u6837\u7684\u5730\u70B9\u52A0\u4E0A\u9AD8\u5E76\u53D1\u96BE\u514D\u6709\u70B9\u5835\u585E\uFF0C\u901A\u8FC7\u591A\u4E2A CDN \u57DF\u540D\u6765\u5206\u62C5\u9AD8\u5E76\u53D1\u4E0B\u7684\u5835\u585E</p><h4 id="_4\u3001\u9996\u5C4F\u4E0D\u5FC5\u8981\u8D44\u6E90\u5EF6\u8FDF\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#_4\u3001\u9996\u5C4F\u4E0D\u5FC5\u8981\u8D44\u6E90\u5EF6\u8FDF\u52A0\u8F7D" aria-hidden="true">#</a> 4\u3001\u9996\u5C4F\u4E0D\u5FC5\u8981\u8D44\u6E90\u5EF6\u8FDF\u52A0\u8F7D</h4><p><strong>\u65B9\u5F0F\u4E00\uFF1A defer \u6216 async</strong></p><p>\u4F7F\u7528 script \u6807\u7B7E\u7684<code>defer\u6216async</code>\u5C5E\u6027\uFF0C\u8FD9\u4E24\u79CD\u65B9\u5F0F\u90FD\u662F\u5F02\u6B65\u52A0\u8F7D js\uFF0C\u4E0D\u4F1A\u963B\u585E DOM \u7684\u6E32\u67D3</p><p>async \u662F\u65E0\u987A\u5E8F\u7684\u52A0\u8F7D\uFF0C\u800C defer \u662F\u6709\u987A\u5E8F\u7684\u52A0\u8F7D</p><p>1\uFF09\u4F7F\u7528 defer \u53EF\u4EE5\u7528\u6765\u63A7\u5236 js \u6587\u4EF6\u7684\u52A0\u8F7D\u987A\u5E8F</p><p>\u6BD4\u5982 jq \u548C Bootstrap\uFF0C\u56E0\u4E3A Bootstrap \u4E2D\u7684 js \u63D2\u4EF6\u4F9D\u8D56\u4E8E jqery\uFF0C\u6240\u4EE5\u5FC5\u987B\u5148\u5F15\u5165 jQuery\uFF0C\u518D\u5F15\u5165 Bootstrap js \u6587\u4EF6</p><p>2\uFF09\u5982\u679C\u4F60\u7684\u811A\u672C\u5E76\u4E0D\u5173\u5FC3\u9875\u9762\u4E2D\u7684 DOM \u5143\u7D20\uFF08\u6587\u6863\u662F\u5426\u89E3\u6790\u5B8C\u6BD5\uFF09\uFF0C\u5E76\u4E14\u4E5F\u4E0D\u4F1A\u4EA7\u751F\u5176\u4ED6\u811A\u672C\u9700\u8981\u7684\u6570\u636E\uFF0C\u53EF\u4EE5\u4F7F\u7528 async\uFF0C\u5982\u6DFB\u52A0\u7EDF\u8BA1\u3001\u57CB\u70B9\u7B49\u8D44\u6E90</p><p><strong>\u65B9\u5F0F\u4E8C\uFF1A\u4F9D\u8D56\u52A8\u6001\u5F15\u5165</strong></p><p>\u9879\u76EE\u4F9D\u8D56\u7684\u8D44\u6E90\uFF0C\u63A8\u8350\u5728\u5404\u81EA\u7684\u9875\u9762\u4E2D\u52A8\u6001\u5F15\u5165\uFF0C\u4E0D\u8981\u5168\u90E8\u90FD\u653E\u5230 index.html \u4E2D</p><p>\u6BD4\u5982<code>echart.js</code>\uFF0C\u53EA\u6709 A \u9875\u9762\u4F7F\u7528\uFF0C\u53EF\u4EE5\u5728 A \u9875\u9762\u7684\u94A9\u5B50\u51FD\u6570\u4E2D\u52A8\u6001\u52A0\u8F7D\uFF0C\u5728<code>onload\u4E8B\u4EF6</code>\u4E2D\u8FDB\u884C echart \u521D\u59CB\u5316</p><p><strong>\u8D44\u6E90\u52A8\u6001\u52A0\u8F7D\u7684\u4EE3\u7801\u793A\u4F8B</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>// url \u8981\u52A0\u8F7D\u7684\u8D44\u6E90
// isMustLoad \u662F\u5426\u5F3A\u5236\u52A0\u8F7D
<span class="token key attr-name">cont asyncLoadJs</span> <span class="token punctuation">=</span> <span class="token value attr-value">(url, isMustLoad = false) =&gt; {</span>
  <span class="token key attr-name">return new Promise((resolve, reject)</span> <span class="token punctuation">=</span><span class="token value attr-value">&gt; {</span>
    if (!isMustLoad) {
      <span class="token key attr-name">let srcArr</span> <span class="token punctuation">=</span> <span class="token value attr-value">document.getElementsByTagName(&quot;script&quot;);</span>
      <span class="token key attr-name">let hasLoaded</span> <span class="token punctuation">=</span> <span class="token value attr-value">false;</span>
      <span class="token key attr-name">let aTemp</span> <span class="token punctuation">=</span> <span class="token value attr-value">[];</span>
      <span class="token key attr-name">for (let i</span> <span class="token punctuation">=</span> <span class="token value attr-value">0; i &lt; srcArr.length; i++) {</span>
        // \u5224\u65AD\u5F53\u524Djs\u662F\u5426\u52A0\u8F7D\u4E0A
        if (srcArr[i].src) {
          aTemp.push(srcArr[i].src);
        }
      }
      <span class="token key attr-name">hasLoaded</span> <span class="token punctuation">=</span> <span class="token value attr-value">aTemp.indexOf(url) &gt; -1;</span>
      if (hasLoaded) {
        resolve();
        return;
      }
    }

    <span class="token key attr-name">let script</span> <span class="token punctuation">=</span> <span class="token value attr-value">document.createElement(&quot;script&quot;);</span>
    <span class="token key attr-name">script.type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;text/javascript&quot;;</span>
    <span class="token key attr-name">script.src</span> <span class="token punctuation">=</span> <span class="token value attr-value">url;</span>
    document.body.appendChild(script);
    // \u8D44\u6E90\u52A0\u8F7D\u6210\u529F\u7684\u56DE\u8C03
    <span class="token key attr-name">script.onload</span> <span class="token punctuation">=</span> <span class="token value attr-value">() =&gt; {</span>
      resolve();
    };
    <span class="token key attr-name">script.onerror</span> <span class="token punctuation">=</span> <span class="token value attr-value">() =&gt; {</span>
      // reject();
    };
  });
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u65B9\u5F0F\u4E09\uFF1Aimport()</strong></p><p>\u4F7F\u7528<code>import() \u52A8\u6001\u52A0\u8F7D\u8DEF\u7531\u548C\u7EC4\u4EF6</code>\uFF0C\u5BF9\u8D44\u6E90\u8FDB\u884C\u62C6\u5206\uFF0C\u53EA\u6709\u4F7F\u7528\u7684\u65F6\u5019\u624D\u8FDB\u884C\u52A8\u6001\u52A0\u8F7D</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// \u8DEF\u7531\u61D2\u52A0\u8F7D</span>
<span class="token keyword">const</span> <span class="token class-name">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;home&quot; */</span> <span class="token string-literal"><span class="token string">&#39;../views/home/index.vue&#39;</span></span><span class="token punctuation">)</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&#39;/&#39;</span></span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&#39;home&#39;</span></span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token class-name">Home</span><span class="token punctuation">}</span> <span class="token punctuation">]</span>

<span class="token comment">// \u7EC4\u4EF6\u61D2\u52A0\u8F7D</span>
<span class="token comment">// \u5728visible\u5C5E\u6027\u4E3Atrue\u65F6\uFF0C\u52A8\u6001\u53BB\u52A0\u8F7DdemoComponent\u7EC4\u4EF6</span>
<span class="token operator">&lt;</span>demoComponent v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string-literal"><span class="token string">&quot;visible == true&quot;</span></span> <span class="token operator">/</span><span class="token operator">&gt;</span>

components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    demoComponent<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;demoComponent&quot; */</span> <span class="token string-literal"><span class="token string">&#39;./demoComponent.vue&#39;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5\u3001\u5408\u7406\u5229\u7528\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_5\u3001\u5408\u7406\u5229\u7528\u7F13\u5B58" aria-hidden="true">#</a> 5\u3001\u5408\u7406\u5229\u7528\u7F13\u5B58</h4><p>html \u8D44\u6E90\u8BBE\u7F6E\u534F\u5546\u7F13\u5B58\uFF0C\u5176\u4ED6 js\u3001css\u3001\u56FE\u7247\u7B49\u8D44\u6E90\u8BBE\u7F6E\u5F3A\u7F13\u5B58</p><p>\u5F53\u7528\u6237\u518D\u6B21\u6253\u5F00\u9875\u9762\u65F6\uFF0Chtml \u5148\u548C\u670D\u52A1\u5668\u6821\u9A8C\uFF0C\u5982\u679C\u8BE5\u8D44\u6E90\u672A\u53D8\u5316\uFF0C\u670D\u52A1\u5668\u8FD4\u56DE 304\uFF0C\u76F4\u63A5\u4F7F\u7528\u7F13\u5B58\u7684\u6587\u4EF6\uFF1B\u82E5\u8FD4\u56DE 200\uFF0C\u5219\u8FD4\u56DE\u6700\u65B0\u7684 html \u8D44\u6E90</p><h4 id="_6\u3001\u7F51\u7EDC\u65B9\u9762\u7684\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#_6\u3001\u7F51\u7EDC\u65B9\u9762\u7684\u4F18\u5316" aria-hidden="true">#</a> 6\u3001\u7F51\u7EDC\u65B9\u9762\u7684\u4F18\u5316</h4><p>1\uFF09\u5F00\u542F\u670D\u52A1\u5668 Gzip \u538B\u7F29\uFF0C\u51CF\u5C11\u8BF7\u6C42\u5185\u5BB9\u7684\u4F53\u79EF\uFF0C\u5BF9\u6587\u672C\u7C7B\u80FD\u538B\u7F29 60%\u4EE5\u4E0A</p><p>2\uFF09\u4F7F\u7528 HTTP2\uFF0C\u63A5\u53E3\u89E3\u6790\u901F\u5EA6\u5FEB\u3001\u591A\u8DEF\u590D\u7528\u3001\u9996\u90E8\u538B\u7F29\u7B49</p><p>3\uFF09\u51CF\u5C11 HTTP \u8BF7\u6C42\uFF0C\u4F7F\u7528 url-loader\uFF0Climit \u9650\u5236\u56FE\u7247\u5927\u5C0F\uFF0C\u5C0F\u56FE\u7247\u8F6C base64</p><h4 id="_7\u3001\u4EE3\u7801\u5C42\u9762\u7684\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#_7\u3001\u4EE3\u7801\u5C42\u9762\u7684\u4F18\u5316" aria-hidden="true">#</a> 7\u3001\u4EE3\u7801\u5C42\u9762\u7684\u4F18\u5316</h4><p>1\uFF09\u524D\u7AEF\u957F\u5217\u8868\u6E32\u67D3\u4F18\u5316\uFF0C\u5206\u9875 + \u865A\u62DF\u5217\u8868\uFF0C\u957F\u5217\u8868\u6E32\u67D3\u7684\u6027\u80FD\u6548\u7387\u4E0E\u7528\u6237\u4F53\u9A8C\u6210\u6B63\u6BD4</p><p>2\uFF09\u56FE\u7247\u7684\u61D2\u52A0\u8F7D\u3001<code>\u56FE\u7247\u7684\u52A8\u6001\u88C1\u526A</code></p><p>\u7279\u70B9\u662F\u624B\u673A\u7AEF\u9879\u76EE\uFF0C\u56FE\u7247\u51E0\u4E4E\u4E0D\u9700\u8981\u539F\u56FE\uFF0C\u4F7F\u7528\u4E03\u725B\u6216\u963F\u91CC\u4E91\u7684\u52A8\u6001\u88C1\u526A\u529F\u80FD\uFF0C\u53EF\u4EE5\u5C06\u539F\u672C<code>\u51E0M</code>\u7684\u5927\u5C0F\u88C1\u526A\u6210<code>\u51E0k</code></p><p>3\uFF09\u52A8\u753B\u7684\u4F18\u5316\uFF0C\u52A8\u753B\u53EF\u4EE5\u4F7F\u7528\u7EDD\u5BF9\u5B9A\u4F4D\uFF0C\u8BA9\u5176\u8131\u79BB\u6587\u6863\u6D41\uFF0C\u4FEE\u6539\u52A8\u753B\u4E0D\u9020\u6210\u4E3B\u754C\u9762\u7684\u5F71\u54CD</p><p>\u4F7F\u7528 GPU \u786C\u4EF6\u52A0\u901F\u5305\u62EC\uFF1A<code>transform \u4E0D\u4E3Anone\u3001opacity\u3001filter\u3001will-change</code></p><p>4\uFF09\u51FD\u6570\u7684\u8282\u6D41\u548C\u9632\u6296\uFF0C\u51CF\u5C11\u63A5\u53E3\u7684\u8BF7\u6C42\u6B21\u6570</p><p>5\uFF09\u4F7F\u7528\u9AA8\u67B6\u5C4F\u4F18\u5316\u7528\u6237\u7B49\u5F85\u4F53\u9A8C\uFF0C\u53EF\u4EE5\u6839\u636E\u4E0D\u540C\u8DEF\u7531\u914D\u7F6E\u4E0D\u540C\u7684\u9AA8\u67B6</p><p>vue \u9879\u76EE\u63A8\u8350\u4F7F\u7528<code>vue-skeleton-webpack-plugin</code>\uFF0C\u9AA8\u67B6\u5C4F\u539F\u7406\u5C06<code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt; </code>\u4E2D\u7684\u5185\u5BB9\u66FF\u6362\u6389</p><p>6\uFF09\u5927\u6570\u636E\u7684\u6E32\u67D3\uFF0C\u5982\u679C\u6570\u636E\u4E0D\u4F1A\u53D8\u5316\uFF0Cvue \u9879\u76EE\u53EF\u4EE5\u4F7F\u7528<code>Object.freeze()</code></p><p>Object.freeze()\u65B9\u6CD5\u53EF\u4EE5\u51BB\u7ED3\u4E00\u4E2A\u5BF9\u8C61\uFF0CVue \u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u4F1A\u5C06 data \u4E2D\u5B9A\u4E49\u7684\u662F\u5BF9\u8C61\u53D8\u6210\u54CD\u5E94\u5F0F\uFF0C\u4F46\u5982\u679C\u5224\u65AD\u5BF9\u8C61\u7684\u81EA\u8EAB\u5C5E\u6027\u4E0D\u53EF\u4FEE\u6539\uFF0C\u5C31\u76F4\u63A5\u8FD4\u56DE\u6539\u5BF9\u8C61\uFF0C\u7701\u53BB\u4E86\u9012\u5F52\u904D\u5386\u5BF9\u8C61\u7684\u65F6\u95F4\u4E0E\u5185\u5B58\u6D88\u8017</p><p>7\uFF09\u5B9A\u65F6\u5668\u548C\u7ED1\u5B9A\u7684\u4E8B\u4EF6\uFF0C\u5728\u9875\u9762\u9500\u6BC1\u65F6\u5378\u8F7D</p><h4 id="_8\u3001webpack-\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#_8\u3001webpack-\u4F18\u5316" aria-hidden="true">#</a> 8\u3001webpack \u4F18\u5316</h4><p>\u63D0\u5347\u6784\u5EFA\u901F\u5EA6\u6216\u4F18\u5316\u4EE3\u7801\u4F53\u79EF\uFF0C\u63A8\u8350\u4EE5\u4E0B\u4E24\u7BC7\u6587\u7AE0</p>`,52),kn={href:"https://juejin.cn/post/6844903924806189070",target:"_blank",rel:"noopener noreferrer"},vn={href:"https://juejin.cn/post/6844904093463347208",target:"_blank",rel:"noopener noreferrer"},mn=e(`<h3 id="\u6027\u80FD\u5206\u6790\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u6027\u80FD\u5206\u6790\u603B\u7ED3" aria-hidden="true">#</a> \u6027\u80FD\u5206\u6790\u603B\u7ED3</h3><p>1\uFF09\u5148\u7528 Lighthouse \u5F97\u5230\u5F53\u524D\u9875\u9762\u7684\u6027\u80FD\u5F97\u5206\uFF0C\u4E86\u89E3\u9875\u9762\u7684\u6574\u4F53\u60C5\u51B5\uFF0C\u91CD\u70B9\u5173\u6CE8 Opportunities \u4F18\u5316\u5EFA\u8BAE\u548C Diagnostics \u8BCA\u65AD\u95EE\u9898\u5217\u8868</p><p>2\uFF09\u901A\u8FC7 Performance \u5DE5\u5177\u4E86\u89E3\u9875\u9762\u52A0\u8F7D\u7684\u6574\u4E2A\u8FC7\u7A0B\uFF0C\u5206\u6790\u5230\u5E95\u662F\u8D44\u6E90\u52A0\u8F7D\u6162\u3001dom \u6E32\u67D3\u6162\u3001\u8FD8\u662F js \u6267\u884C\u6162\uFF0C\u627E\u5230\u5177\u4F53\u7684\u6027\u80FD\u74F6\u9888\u5728\u54EA\u91CC\uFF0C\u91CD\u70B9\u5173\u6CE8\u957F\u4EFB\u52A1\uFF08long task\uFF09</p><p>3\uFF09\u5229\u7528 Memory \u5DE5\u5177\uFF0C\u4E86\u89E3\u9875\u9762\u6574\u4F53\u7684\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\uFF0C\u901A\u8FC7 JS \u5806\u52A8\u6001\u5206\u914D\u65F6\u95F4\u7EBF\uFF0C\u627E\u5230\u5185\u5B58\u6700\u9AD8\u7684\u65F6\u523B\u3002\u7ED3\u5408\u5177\u4F53\u7684\u4EE3\u7801\uFF0C\u53BB\u89E3\u51B3\u6216\u4F18\u5316\u5185\u5B58\u53D8\u5927\u7684\u95EE\u9898</p><h3 id="\u524D\u7AEF\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#\u524D\u7AEF\u76D1\u63A7" aria-hidden="true">#</a> \u524D\u7AEF\u76D1\u63A7</h3><p>\u6CA1\u6709\u76D1\u63A7\u7684\u9879\u76EE\uFF0C\u5C31\u662F\u5728<code>\u201C\u88F8\u5954\u201D</code></p><p>\u9700\u8981\u901A\u8FC7\u76D1\u63A7\u624D\u80FD\u771F\u6B63\u4E86\u89E3\u9879\u76EE\u7684\u6574\u4F53\u60C5\u51B5\uFF0C\u5404\u9879\u6307\u6807\u8981\u901A\u8FC7\u5927\u91CF\u7684\u6570\u636E\u91C7\u96C6\u3001\u6570\u636E\u5206\u6790\uFF0C\u53D8\u5F97\u66F4\u6709\u610F\u4E49</p><p>\u76D1\u63A7\u7684\u597D\u5904\uFF1A\u4E8B\u524D\u9884\u8B66\u548C\u4E8B\u540E\u5206\u6790</p><p><strong>\u4E8B\u524D\u9884\u8B66</strong>\uFF1A\u8BBE\u7F6E\u4E00\u4E2A\u9608\u503C\uFF0C\u5F53\u76D1\u63A7\u7684\u6570\u636E\u8FBE\u5230\u9608\u503C\u65F6\uFF0C\u901A\u8FC7\u5404\u79CD\u6E20\u9053\u901A\u77E5\u7BA1\u7406\u5458\u548C\u5F00\u53D1\uFF0C\u63D0\u524D\u907F\u514D\u53EF\u80FD\u4F1A\u9020\u6210\u7684\u5B95\u673A\u6216\u5D29\u6E83</p><p><strong>\u4E8B\u540E\u5206\u6790</strong>\uFF1A\u901A\u8FC7\u76D1\u63A7\u65E5\u5FD7\u6587\u4EF6\uFF0C\u5206\u6790\u6545\u969C\u539F\u56E0\u548C\u6545\u969C\u53D1\u751F\u70B9\u3002\u4ECE\u800C\u505A\u51FA\u4FEE\u6539\uFF0C\u9632\u6B62\u8FD9\u79CD\u60C5\u51B5\u518D\u6B21\u53D1\u751F</p><p>\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u5E02\u9762\u4E0A\u73B0\u6709\u7684\u5DE5\u5177\uFF0C\u4E5F\u53EF\u4EE5\u81EA\u5EFA sentry \u76D1\u63A7\uFF0C\u5173\u952E\u5728\u4E8E\u901A\u8FC7\u8FD9\u4E9B\u6570\u636E\uFF0C\u80FD\u770B\u5230\u8FD9\u4E9B<code>\u51B0\u51B7\u6570\u636E\u80CC\u540E\u7684\u6545\u4E8B</code></p><h2 id="\u7EC4\u4EF6\u5E93" tabindex="-1"><a class="header-anchor" href="#\u7EC4\u4EF6\u5E93" aria-hidden="true">#</a> \u7EC4\u4EF6\u5E93</h2><p>\u7EC4\u4EF6\u5E93\u662F\u5F00\u53D1\u9879\u76EE\u65F6\u5FC5\u5907\u7684\u5DE5\u5177\uFF0C\u56E0\u4E3A\u73B0\u5728\u5404\u4E2A\u5927\u5382\u63D0\u4F9B\u7684\u7EC4\u4EF6\u5E93\u90FD\u592A\u597D\u7528\u4E86\uFF0C\u53CD\u800C\u8BA9\u5927\u5BB6\u8F7B\u89C6\u4E86\u7EC4\u4EF6\u5E93\u7684\u91CD\u8981\u6027</p><p>\u73B0\u5728\u5F00\u53D1\u4E00\u4E2A\u65B0\u9879\u76EE\uFF0C\u5982\u679C\u8981\u6C42\u4E0D\u80FD\u7528\u73B0\u6210\u7684\u7EC4\u4EF6\u5E93\uFF0C\u6211\u4F30\u8BA1\u8981\u77AC\u95F4\u61F5\u903C\uFF0C\u65E0\u4ECE\u4E0B\u624B\u4E86\uFF0C\u4E0D\u77E5\u4E0D\u89C9\u4E2D\uFF0C\u6211\u5DF2\u7ECF\u60A3\u4E0A\u4E25\u91CD\u7684<code>\u7EC4\u4EF6\u5E93\u4F9D\u8D56\u75C7</code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u5982\u679C\u8BA9\u6211\u53EA\u80FD\u8BF4\u51FA\u4E00\u79CD\uFF0C\u5FEB\u901F\u63D0\u5347\u7F16\u7A0B\u6280\u80FD\u7684\u65B9\u6CD5\uFF0C\u6211\u4E00\u5B9A\u4F1A\u63A8\u8350\u53BB\u770B\u770B\u7EC4\u4EF6\u5E93\u6E90\u7801
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u56E0\u4E3A\u7EC4\u4EF6\u5E93\u6E90\u7801\u4E2D\uFF0C\u90FD\u662F\u6700\u7ECF\u5178\u7684\u6848\u4F8B\uFF0C\u662F\u96C6\u5927\u6210\u7684\u6770\u4F5C</strong></p><p>\u76F8\u6BD4\u4E8E\u524D\u7AEF\u6846\u67B6\u6E90\u7801\u7684\u6666\u6DA9\uFF0C\u7EC4\u4EF6\u5E93\u6E90\u7801\u66F4\u5BB9\u6613\u4E0A\u624B\uFF0C\u91CC\u8FB9\u5F88\u591A\u7ECF\u5178\u573A\u666F\u7684\u5199\u6CD5\uFF0C\u6211\u4EEC\u90FD\u53EF\u4EE5\u501F\u9274\uFF0C\u7136\u540E\u8FD0\u7528\u5230\u5B9E\u9645\u7684\u9879\u76EE\u4E2D</p><p>\u6BD4\u5982\u6700\u5E38\u7528\u7684\u5F39\u6846\u7EC4\u4EF6\uFF0C\u91CC\u8FB9\u7684<code>\u6D41\u7A0B\u63A7\u5236\u3001\u5C42\u7EA7\u63A7\u5236\u3001\u7EC4\u4EF6\u95F4\u4E8B\u4EF6\u6D3E\u53D1\u4E0E\u5E7F\u64AD\u3001\u9012\u5F52\u67E5\u627E\u7EC4\u4EF6</code>\u7B49\u8BBE\u8BA1\uFF0C\u76F8\u5F53\u60CA\u8273\uFF0C\u771F\u6CA1\u60F3\u5230\u4E00\u4E2A\u5C0F\u5C0F\u7684\u5F39\u6846\u7EC4\u4EF6\uFF0C\u4E5F\u662F\u5185\u6709\u4E7E\u5764</p>`,18),bn={href:"https://juejin.cn/column/7095181360632971300",target:"_blank",rel:"noopener noreferrer"},gn=n("h2",{id:"\u603B\u7ED3",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u603B\u7ED3","aria-hidden":"true"},"#"),s(" \u603B\u7ED3")],-1),hn=n("p",null,[s("\u5DE5\u7A0B\u5316\uFF0C\u662F\u4E00\u4E2A\u975E\u5E38\u5BB9\u6613"),n("code",null,"\u51FA\u5F69"),s("\u7684\u65B9\u5411\uFF0C\u662F\u5C55\u73B0\u4E00\u4E2A\u4FA0\u8005\u5185\u529F\u662F\u5426\u6DF1\u539A\u7684\u7A97\u53E3")],-1),fn=n("p",null,[s("\u6587\u4E2D\u5927\u90E8\u5206\u77E5\u8BC6\u70B9\uFF0C\u53EA\u662F"),n("code",null,"\u5165\u95E8\u7EA7\u6559\u7A0B"),s("\uFF0C\u4E5F\u662F\u6211\u4EE5\u540E\u9700\u8981\u6301\u7EED\u52AA\u529B\u7684\u65B9\u5411")],-1),yn={href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fxy-sea%2Fblog%2Ftree%2Fdev%2F%E5%B7%A5%E7%A8%8B%E5%8C%96%E7%AF%87",target:"_blank",rel:"noopener noreferrer"};function qn(wn,jn){const a=i("ExternalLinkIcon");return o(),c("div",null,[n("p",null,[s("\u5F15\u7528\u4E8E"),n("a",u,[s("\u6398\u91D1-\u6D77\u9614_\u5929\u7A7A"),t(a)])]),r,n("p",null,[n("a",d,[s("mini-webpack \u7684 github \u6E90\u7801\u5730\u5740"),t(a)])]),k,n("p",null,[n("a",v,[s("\u8F7B\u677E\u7406\u89E3 webpack \u70ED\u66F4\u65B0\u539F\u7406"),t(a)]),n("a",m,[s("\u6DF1\u5165\u6D45\u51FA Webpack"),t(a)]),n("a",b,[s("\u5E26\u4F60\u6DF1\u5EA6\u89E3\u9501 Webpack \u7CFB\u5217(\u57FA\u7840\u7BC7)"),t(a)])]),g,n("p",null,[n("a",h,[s("\u63ED\u79D8 webpack-plugin"),t(a)])]),f,n("p",null,[n("a",y,[s("\u63ED\u79D8 webpack-loader"),t(a)])]),q,n("p",null,[n("a",w,[s("\u7CBE\u8BFB\u300AWebpack5 \u65B0\u7279\u6027 - \u6A21\u5757\u8054\u90A6\u300B"),t(a)]),n("a",j,[s("Webpack 5 \u6A21\u5757\u8054\u90A6\u5F15\u53D1\u5FAE\u524D\u7AEF\u7684\u9769\u547D\uFF1F"),t(a)]),n("a",x,[s("Webpack 5 \u5347\u7EA7\u5185\u5BB9\uFF08\u4E8C\uFF1A\u6A21\u5757\u8054\u90A6\uFF09"),t(a)])]),_,n("p",null,[n("a",F,[s("\u63A8\u8350\u73E0\u5CF0\u7684\u4ECE\u96F6\u624B\u5199 vite \u89C6\u9891"),t(a)])]),S,n("p",null,[n("a",P,[s("\u5C24\u96E8\u6EAA\u51E0\u5E74\u524D\u5F00\u53D1\u7684\u201C\u73A9\u5177 vite\u201D"),t(a)]),n("a",T,[s("Vite \u539F\u7406\u6D45\u6790"),t(a)])]),A,n("p",null,[s("AST \u62BD\u8C61\u8BED\u6CD5\u6811\u7684\u7ED3\u6784\uFF0C\u53EF\u4EE5\u901A\u8FC7"),n("a",C,[s("AST \u7F51\u7AD9"),t(a)]),s("\u5728\u7EBF\u8F93\u5165\u4EE3\u7801\u67E5\u770B")]),n("p",null,[n("a",L,[s("AST \u62BD\u8C61\u8BED\u6CD5\u6811\u2014\u2014\u6700\u57FA\u7840\u7684 javascript \u91CD\u70B9\u77E5\u8BC6\uFF0C99%\u7684\u4EBA\u6839\u672C\u4E0D\u4E86\u89E3"),t(a)])]),D,n("p",null,[n("a",E,[s("Babel \u5165\u95E8\u6559\u7A0B"),t(a)]),n("a",M,[s("Babel \u4E2D\u6587\u6587\u6863"),t(a)]),n("a",z,[s("\u4E0D\u5BB9\u9519\u8FC7\u7684 Babel \u77E5\u8BC6"),t(a)]),n("a",I,[s("\u5FEB\u901F\u5199\u4E00\u4E2A babel \u63D2\u4EF6"),t(a)])]),O,n("p",null,[s("\u4EE5"),B,s("\u4E3A\u4F8B\uFF0C\u4E0B\u8F7D"),n("a",H,[s("elementUI \u6E90\u7801"),t(a)])]),N,n("p",null,[n("a",R,[s("elementUI \u591A\u5957\u4E3B\u9898\u4E0B \u6309\u9700\u5F15\u5165\u548C\u5168\u5C40\u5F15\u5165 \u7684\u6362\u80A4\u65B9\u6848"),t(a)])]),W,n("p",null,[n("a",V,[s("\u81EA\u5B9A\u4E49\u811A\u624B\u67B6 github \u6E90\u7801\u5730\u5740"),t(a)]),n("a",J,[s("my-2022-cli"),t(a)])]),G,n("p",null,[s("\u8FD9\u91CC\u4EE5"),n("a",U,[s("juejin.cn"),t(a)]),s("\u7F51\u7AD9\u4E3A\u4F8B\uFF0C \u6253\u5F00 Chrome \u6D4F\u89C8\u5668\u63A7\u5236\u53F0\uFF0C\u9009\u62E9"),$,s("\u9009\u9879\uFF0C\u70B9\u51FB"),Y]),K,n("p",null,[n("a",Q,[s("\u6027\u80FD\u6D4B\u8BC4\u5DE5\u5177 lighthouse \u7684\u4F7F\u7528"),t(a)])]),X,n("p",null,[n("a",Z,[s("web-vitals"),t(a)]),s("\u662F Google \u7ED9\u51FA\u7684\u5B9A\u4E49\u662F \u4E00\u4E2A"),nn]),sn,n("p",null,[n("a",an,[s("\u5168\u65B0 Chrome Devtool Performance \u4F7F\u7528\u6307\u5357"),t(a)]),n("a",tn,[s("\u624B\u628A\u624B\u5E26\u4F60\u5165\u95E8\u524D\u7AEF\u5DE5\u7A0B\u5316\u2014\u2014\u8D85\u8BE6\u7EC6\u6559\u7A0B"),t(a)]),n("a",en,[s("Chrome Devtool \u2014 Performance"),t(a)])]),pn,n("p",null,[n("a",on,[s("chrome \u5185\u5B58\u6CC4\u9732\uFF08\u4E00\uFF09\u3001\u5185\u5B58\u6CC4\u6F0F\u5206\u6790\u5DE5\u5177"),t(a)]),n("a",cn,[s("chrome \u5185\u5B58\u6CC4\u9732\uFF08\u4E8C\uFF09\u3001\u5185\u5B58\u6CC4\u6F0F\u5B9E\u4F8B"),t(a)]),n("a",ln,[s("JavaScript \u8FDB\u9636-\u5E38\u89C1\u5185\u5B58\u6CC4\u9732\u53CA\u5982\u4F55\u907F\u514D"),t(a)])]),un,n("p",null,[s("\u53EF\u4EE5\u4F7F\u7528"),n("a",rn,[s("webpack-bundle-analyzer"),t(a)]),s("\u63D2\u4EF6(vue \u9879\u76EE\u53EF\u4EE5\u4F7F\u7528--report)\u751F\u6210\u8D44\u6E90\u5206\u6790\u56FE")]),dn,n("p",null,[n("a",kn,[s("Webpack \u4F18\u5316\u2014\u2014\u5C06\u4F60\u7684\u6784\u5EFA\u6548\u7387\u63D0\u901F\u7FFB\u500D"),t(a)]),n("a",vn,[s("\u5E26\u4F60\u6DF1\u5EA6\u89E3\u9501 Webpack \u7CFB\u5217(\u4F18\u5316\u7BC7)"),t(a)])]),mn,n("p",null,[s("\u63A8\u8350\u4E00\u4E0B\u6211\u6B63\u5728\u5199\u7684"),n("a",bn,[s("ElementUI \u6E90\u7801-\u6253\u9020\u81EA\u5DF1\u7684\u7EC4\u4EF6\u5E93"),t(a)]),s("\u6587\u7AE0\uFF0C\u7ECF\u5178\u7684\u4E1C\u897F\u6C38\u8FDC\u662F\u7ECF\u5178")]),gn,hn,fn,n("p",null,[n("a",yn,[s("\u5DE5\u7A0B\u5316\u7BC7 github \u6E90\u7801\u4ED3\u5E93"),t(a)])])])}const Fn=p(l,[["render",qn],["__file","index.html.vue"]]);export{Fn as default};
